*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="callerid.vcx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*

*
DEFINE CLASS callerid AS container 
 	*< CLASSDATA: Baseclass="container" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Olecontrol1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Timer1" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: *llamada
		*m: *llamadaentrante
		*p: fecha
		*p: telefono
	*</DefinedPropArrayMethod>

	BackStyle = 0
	fecha = 
	Height = 59
	Name = "callerid"
	telefono = 
	Width = 38

	ADD OBJECT 'Olecontrol1' AS olecontrol WITH ;
		Height = 100, ;
		Left = 0, ;
		Name = "Olecontrol1", ;
		Top = 0, ;
		Width = 100
		*< END OBJECT: BaseClass="olecontrol"  Nombre="callerid.Olecontrol1" Parent="callerid" ObjName="Olecontrol1" OLEObject="C:\WINDOWS\system32\mscomm32.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIBPo1EdWcgBAwAAAMABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABLAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAJEAAAAAAAAABAAAAAIAAAD+////BQAAAP7///8GAAAA/v////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8AVopkbiwbEIK2AAAAAAAUIUM0EggAAADtAwAA7QMAAAFWimQAAAYAAAADAAAEAAAAAgAAgCUAAAAACAAAAAAASwAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABMAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAABDb3B5cmlnaHQgKGMpIDE5OTQgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACACQAAAENvbW1Qb3J0AAkAAABJCgAAAAMAAAALAAAAUlRocmVzaG9sZAAJAAAASQoAAAAAAAAACgAAAFJUAAAAAD8AAAABAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFNFbmFibGUABQAAAEwAAAAACQAAAFNldHRpbmdzABMAAABIAAAAAAoAAAA5NjAwLG4sOCwxCwAAAFNUaHJlc2hvbGQACQAAAEkKAAAAAAAAAAAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAACALxoAyEkaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" />

	ADD OBJECT 'Timer1' AS timer WITH ;
		Enabled = .F., ;
		Height = 23, ;
		Interval = 500, ;
		Left = 0, ;
		Name = "Timer1", ;
		Top = 36, ;
		Width = 23
		*< END OBJECT: BaseClass="timer" />
	
	PROCEDURE Destroy
		this.olecontrol1.portopen = .f. 
	ENDPROC

	PROCEDURE Init
		Local cValor 
		With this
		*SET STEP ON
		cValor = "" 
		.olecontrol1.commport = 3
		.olecontrol1.settings = "9600,N,8,1" &&aunque la 'N', podria ser en minuscula ("n"). 
		.olecontrol1.inputlen = 0 
		.olecontrol1.portopen = .t. 
		.olecontrol1.Output = "ATV1Q0" + Chr(13) 
		
		cValor = cValor + .olecontrol1.input 
		
		*!*	DO WHILE NOT (("OK" + CHR(13)) $ cValor) 
		*!*	cValor = cValor + .olecontrol1.input 
		
		*!*	ENDDO 
		
		.olecontrol1.Output = "ATZ" + Chr(13) 
		
		cValor = cValor + .olecontrol1.input 
		
		DO WHILE NOT (("OK" + CHR(13)) $ cValor) 
		cValor = cValor + .olecontrol1.input 
		
		ENDDO 
		
		.olecontrol1.Output = "AT#CID=1" + Chr(13) 
		
		cValor = cValor + .olecontrol1.input 
		
		DO WHILE NOT (("OK" + CHR(13)) $ cValor) 
		cValor = cValor + .olecontrol1.input 
		ENDDO 
		
		*!*	cValor=""
		*!*	DO WHILE NOT (("RING" + CHR(13)) $ cValor) 
		*!*	cValor = cValor + .olecontrol1.input 
		*!*	ENDDO 
		this.timer1.Enabled= .T.
		
		
		
		
		
		
		Endwith 
		
	ENDPROC

	PROCEDURE llamada
		LPARAMETERS cadena
		***procesamos la llamada
		
		LOCAL llamada(4)
		cadena=STRTRAN(cadena,"DATE = ")
		cadena=STRTRAN(cadena,"TIME = ")
		cadena=STRTRAN(cadena,"NMBR = ")
		ALINES(llamada,cadena)
		LLAMADA(1)= DATETIME(YEAR(DATE()),VAL(SUBSTR(LLAMADA(2),1,2)),VAL(SUBSTR(LLAMADA(2),3,2)),VAL(SUBSTR(LLAMADA(3),1,2)),VAL(SUBSTR(LLAMADA(3),3,2)))
		*SET STEP ON
		*MESSAGEBOX(cadena)
		***luego activamos de nuevo el timer
		this.fecha=llamada(1)
		this.telefono=llamada(4)
		this.timer1.Enabled= .T.
		this.llamadaentrante
		
	ENDPROC

	PROCEDURE llamadaentrante
	ENDPROC

	PROCEDURE Olecontrol1.OnComm
		*** ActiveX Control Event ***
		
		
	ENDPROC

	PROCEDURE Timer1.Timer
		LOCAL lcInput
		lcInput = this.Parent.OLecontrol1.Input
		IF ("DATE"  $ lcInput)
			THIS.Enabled= .F.
			this.Parent.llamada(lcInput)
		*	MESSAGEBOX(lcInput)
		ENDIF
		
		
		*thisform.edit1.Value=thisform.edit1.Value+lcInput
	ENDPROC

ENDDEFINE
