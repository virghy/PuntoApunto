*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="vt_tpv_config.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	DataSource = .NULL.
	Height = 0
	Left = 0
	Name = "Dataenvironment"
	Top = 0
	Width = 0

ENDDEFINE

DEFINE CLASS tsbaseform12 AS tsbaseform OF "..\libs\tsbase.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Tslabel1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cboComprobante" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cliente" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdCancel" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdAceptar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="NombreVendedor" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Idvendedor" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cbosucursal" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cbodeposito" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cbocondicion" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cbolistaprecio" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cbomoneda" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Idcliente" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tscommandbutton1" UniqueID="" Timestamp="" />

	BorderStyle = 1
	Caption = "Configuracion de TPV"
	ctoolbar = 
	DataSession = 2
	DoCreate = .T.
	editmode = .T.
	Height = 249
	Name = "Tsbaseform12"
	ShowWindow = 1
	Width = 522
	lblRequerido.Name = "lblRequerido"
	lblRequerido.TabIndex = 11

	ADD OBJECT 'cboComprobante' AS tscombobox WITH ;
		BoundColumn = 2, ;
		cmdsql = select descripcion,idComprobante,cpbt_stk,tipo,Tipo_Iva as tipoiva from vt_cpbt where IdEmpresa=?oApp.Empresa order by descripcion , ;
		condicionvalidacion = , ;
		cursor = xVenta, ;
		Left = 192, ;
		Name = "cboComprobante", ;
		Style = 2, ;
		TabIndex = 3, ;
		Top = 60, ;
		Width = 204
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'Cbocondicion' AS cbocondventa WITH ;
		ControlSource = "", ;
		Left = 192, ;
		Name = "Cbocondicion", ;
		TabIndex = 4, ;
		Top = 84, ;
		Width = 204
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="combobox" />

	ADD OBJECT 'Cbodeposito' AS cbodeposito WITH ;
		cmdsql = Select Deposito,idDeposito from dbo.st_depositos  where IdEmpresa=?oApp.Empresa, ;
		ControlSource = "", ;
		Left = 192, ;
		Name = "Cbodeposito", ;
		TabIndex = 2, ;
		Top = 36, ;
		Width = 204
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="combobox" />

	ADD OBJECT 'Cbolistaprecio' AS cbolistaprecio WITH ;
		ControlSource = "", ;
		Left = 192, ;
		Name = "Cbolistaprecio", ;
		TabIndex = 5, ;
		Top = 108, ;
		Width = 204
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="combobox" />

	ADD OBJECT 'Cbomoneda' AS cbomoneda WITH ;
		Left = 192, ;
		Name = "Cbomoneda", ;
		TabIndex = 6, ;
		Top = 132, ;
		Width = 204
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="combobox" />

	ADD OBJECT 'Cbosucursal' AS cbosucursal WITH ;
		Height = 24, ;
		Left = 192, ;
		Name = "Cbosucursal", ;
		TabIndex = 1, ;
		Top = 12, ;
		Width = 204
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="combobox" />

	ADD OBJECT 'Cliente' AS tstextbox WITH ;
		BackStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		editable = .F., ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 258, ;
		Name = "Cliente", ;
		TabIndex = 21, ;
		Top = 180, ;
		Width = 240
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'cmdAceptar' AS tscommandbutton WITH ;
		Caption = "\<Aceptar", ;
		Left = 328, ;
		Name = "cmdAceptar", ;
		TabIndex = 9, ;
		Top = 216
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'cmdCancel' AS tscommandbutton WITH ;
		Cancel = .T., ;
		Caption = "\<Cancelar", ;
		Left = 416, ;
		Name = "cmdCancel", ;
		TabIndex = 10, ;
		Top = 216
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Idcliente' AS idcliente WITH ;
		ControlSource = "", ;
		Height = 22, ;
		Left = 192, ;
		Name = "Idcliente", ;
		TabIndex = 8, ;
		Top = 180, ;
		Width = 64
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="textbox" />

	ADD OBJECT 'Idvendedor' AS idvendedor WITH ;
		ControlSource = "", ;
		Height = 23, ;
		Left = 192, ;
		Name = "Idvendedor", ;
		objeto = this.parent.Nombrevendedor, ;
		TabIndex = 7, ;
		Top = 156, ;
		Width = 64
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="textbox" />

	ADD OBJECT 'NombreVendedor' AS tstextbox WITH ;
		BackStyle = 0, ;
		DisabledForeColor = 0,0,0, ;
		editable = .F., ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 258, ;
		Name = "NombreVendedor", ;
		TabIndex = 19, ;
		Top = 156, ;
		Width = 240
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Tscommandbutton1' AS tscommandbutton WITH ;
		Cancel = .T., ;
		Caption = "Generar Imagenes de productos para el TPV", ;
		Height = 26, ;
		Left = 11, ;
		Name = "Tscommandbutton1", ;
		TabIndex = 10, ;
		Top = 216, ;
		Width = 260
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Tslabel1' AS tslabel WITH ;
		Caption = "Sucursal:", ;
		Left = 96, ;
		Name = "Tslabel1", ;
		TabIndex = 12, ;
		Top = 12
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel2' AS tslabel WITH ;
		Caption = "Comprobante de Venta:", ;
		Height = 22, ;
		Left = 36, ;
		Name = "Tslabel2", ;
		TabIndex = 14, ;
		Top = 60, ;
		Width = 141
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel3' AS tslabel WITH ;
		Caption = "Lista de Precios:", ;
		Height = 22, ;
		Left = 72, ;
		Name = "Tslabel3", ;
		TabIndex = 16, ;
		Top = 108, ;
		Width = 101
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel4' AS tslabel WITH ;
		Caption = "Cliente:", ;
		Height = 22, ;
		Left = 108, ;
		Name = "Tslabel4", ;
		TabIndex = 20, ;
		Top = 180, ;
		Width = 61
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel5' AS tslabel WITH ;
		Caption = "Moneda:", ;
		Height = 22, ;
		Left = 120, ;
		Name = "Tslabel5", ;
		TabIndex = 17, ;
		Top = 132, ;
		Width = 53
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel6' AS tslabel WITH ;
		Caption = "Deposito:", ;
		Left = 96, ;
		Name = "Tslabel6", ;
		TabIndex = 13, ;
		Top = 36
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel7' AS tslabel WITH ;
		Caption = "Condicion de Venta:", ;
		Height = 22, ;
		Left = 36, ;
		Name = "Tslabel7", ;
		TabIndex = 15, ;
		Top = 84, ;
		Width = 141
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel8' AS tslabel WITH ;
		Caption = "Vendedor:", ;
		Height = 22, ;
		Left = 108, ;
		Name = "Tslabel8", ;
		TabIndex = 18, ;
		Top = 156, ;
		Width = 61
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />
	
	PROCEDURE Init
		PARAMETER LCESTADO
		
		IF PCOUNT()=1
			THIS.TAG = LCESTADO
		ENDIF
		
		DODEFAULT()
		THISFORM.CBOSUCURSAL.VALUE = LEERINI('Sucursal', 'TPV-'+OAPP.EMPRESA)
		THISFORM.CBODEPOSITO.VALUE = LEERINI('Deposito', 'TPV-'+OAPP.EMPRESA)
		THISFORM.CBOCOMPROBANTE.VALUE = LEERINI('Comprobante', 'TPV-'+OAPP.EMPRESA)
		THISFORM.CBOCONDICION.VALUE = LEERINI('Condicion', 'TPV-'+OAPP.EMPRESA)
		THISFORM.CBOLISTAPRECIO.VALUE = LEERINI('ListaPrecio', 'TPV-'+OAPP.EMPRESA)
		THISFORM.CBOMONEDA.VALUE = LEERINI('Moneda', 'TPV-'+OAPP.EMPRESA)
		THISFORM.IDCLIENTE.VALUE = LEERINI('IdCliente', 'TPV-'+OAPP.EMPRESA)
		THISFORM.IDVENDEDOR.VALUE = LEERINI('IdVendedor', 'TPV-'+OAPP.EMPRESA)
	ENDPROC

	PROCEDURE cmdAceptar.Click
		IF THISFORM.TAG='TPV'
		THISFORM.HIDE()
		RETURN
		ENDIF
		= ESCRIBIRINI(THISFORM.CBOSUCURSAL.VALUE, 'Sucursal', 'TPV-'+OAPP.EMPRESA)
		= ESCRIBIRINI(THISFORM.CBODEPOSITO.VALUE, 'Deposito', 'TPV-'+OAPP.EMPRESA)
		= ESCRIBIRINI(THISFORM.CBOCOMPROBANTE.VALUE, 'Comprobante', 'TPV-'+OAPP.EMPRESA)
		= ESCRIBIRINI(THISFORM.CBOCONDICION.VALUE, 'Condicion', 'TPV-'+OAPP.EMPRESA)
		= ESCRIBIRINI(THISFORM.CBOLISTAPRECIO.VALUE, 'ListaPrecio', 'TPV-'+OAPP.EMPRESA)
		= ESCRIBIRINI(THISFORM.CBOMONEDA.VALUE, 'Moneda', 'TPV-'+OAPP.EMPRESA)
		= ESCRIBIRINI(THISFORM.IDCLIENTE.VALUE, 'IdCliente', 'TPV-'+OAPP.EMPRESA)
		= ESCRIBIRINI(THISFORM.IDVENDEDOR.VALUE, 'IdVendedor', 'TPV-'+OAPP.EMPRESA)
		THISFORM.RELEASE
	ENDPROC

	PROCEDURE cmdCancel.Click
		IF THISFORM.TAG='TPV'
		THISFORM.HIDE()
		ELSE
		THISFORM.RELEASE()
		ENDIF
	ENDPROC

	PROCEDURE Tscommandbutton1.Click
		thisform.runsql("Select IdProducto,Imagen from st_Producto where IdEmpresa=?oApp.Empresa",'cProd')
		SELECT cProd
		SCAN
		IF NOT ISNULL(Imagen)
			cImagen="bitmaps\" + ALLTRIM(IdProducto) + ".jpg"
		*	STRTOFILE(Imagen,cImagen)
		*	COPY MEMO Imagen TO (cImagen)
			loForm = CREATEOBJECT("Form") 
			loForm.addobject("oleboundcontrol1", "oleboundcontrol") 
			loForm.oleboundcontrol1.autosize = .T. 
			* bind general field to oleboundcontrol 
			loForm.oleboundcontrol1.controlsource = "cProd.Imagen" 
		* save data from general field to .doc file 
			loForm.oleboundcontrol1.saveas(cImagen) 
			RELEASE loForm 
		ENDIF
		ENDSCAN
			
		
	ENDPROC

ENDDEFINE
