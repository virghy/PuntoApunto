*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="pr_hoja.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*


*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursoradapter1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursoradapter2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursoradapter3" UniqueID="" Timestamp="" />

	DataSource = (oApp.HndConn)
	DataSourceType = "ODBC"
	Height = 200
	InitialSelectedAlias = "pr_ProyectoDet"
	Left = 265
	Name = "Dataenvironment"
	Top = 241
	Width = 520

	ADD OBJECT 'Cursoradapter1' AS cursoradapter WITH ;
		Alias = "pr_ProyectoDet", ;
		BufferModeOverride = 5, ;
		CursorSchema = IDPD I, IDPROYECTO I, IDEMPRESA C(3), IDPRODUCTO C(20), PRODUCTO C(50), DESCRIPCION C(200), UM C(3), CANTIDAD Y, PRECIO Y, IMPORTE Y, CERTIFICACION Y, TIPO C(1), IDPADRE I, ;
		Flags = 0, ;
		Height = 90, ;
		KeyFieldList = IDPD, ;
		Left = 10, ;
		Name = "Cursoradapter1", ;
		NoData = .T., ;
		Prepared = .T., ;
		SelectCmd = select * from pr_ProyectoDet where IdPD=?thisform.key, ;
		Tables = pr_ProyectoDet, ;
		Top = 20, ;
		UpdatableFieldList = IDPROYECTO, IDEMPRESA, IDPRODUCTO, PRODUCTO, DESCRIPCION, UM, CANTIDAD, PRECIO, IMPORTE, CERTIFICACION, TIPO, IDPADRE, ;
		UpdateNameList = <fb2p_value>IDPD pr_ProyectoDet.IDPD, IDPROYECTO pr_ProyectoDet.IDPROYECTO, IDEMPRESA pr_ProyectoDet.IDEMPRESA, IDPRODUCTO pr_ProyectoDet.IDPRODUCTO, PRODUCTO pr_ProyectoDet.PRODUCTO, DESCRIPCION pr_ProyectoDet.DESCRIPCION, UM pr_ProyectoDet.UM, CANTIDAD pr_ProyectoDet.CANTIDAD, PRECIO pr_ProyectoDet.PRECIO, IMPORTE pr_ProyectoDet.IMPORTE, CERTIFICACION pr_ProyectoDet.CERTIFICACION, TIPO pr_ProyectoDet.TIPO, IDPADRE pr_ProyectoDet.IDPADRE</fb2p_value>, ;
		UseDeDataSource = .T., ;
		Width = 155
		*< END OBJECT: BaseClass="cursoradapter" />

	ADD OBJECT 'Cursoradapter2' AS cursoradapter WITH ;
		Alias = "pr_ProyectoDetList", ;
		CursorSchema = IDPD I, IDPROYECTO I, IDEMPRESA C(3), IDPRODUCTO C(20), PRODUCTO C(50), DESCRIPCION C(200), UM C(3), CANTIDAD Y, PRECIO Y, IMPORTE Y, CERTIFICACION Y, TIPO C(1), IDPADRE I, ;
		Flags = 0, ;
		Height = 90, ;
		KeyFieldList = IDPD, ;
		Left = 294, ;
		Name = "Cursoradapter2", ;
		NoData = .T., ;
		SelectCmd = select * from pr_ProyectoDet where IdPAdre=?m.idPadre, ;
		Tables = pr_ProyectoDet, ;
		Top = 13, ;
		UpdatableFieldList = CANTIDAD, ;
		UpdateNameList = IDPD pr_ProyectoDet.IDPD, CANTIDAD pr_ProyectoDet.CANTIDAD, ;
		UseDeDataSource = .T., ;
		Width = 138
		*< END OBJECT: BaseClass="cursoradapter" />

	ADD OBJECT 'Cursoradapter3' AS cursoradapter WITH ;
		Alias = "pr_ProyectoMed", ;
		BufferModeOverride = 5, ;
		CursorSchema = IDPM I, IDPD I, LINEA I, DESCRIPCION C(50), CANTIDAD Y, LONGITUD Y, ALTURA Y, ANCHURA Y, FORMULA C(50), TOTAL Y, ;
		Flags = 0, ;
		Height = 90, ;
		KeyFieldList = IDPM, ;
		Left = 136, ;
		Name = "Cursoradapter3", ;
		NoData = .T., ;
		SelectCmd = select * from pr_ProyectoMed where IdPD=?m.IdPD, ;
		Tables = pr_ProyectoMed, ;
		Top = 25, ;
		UpdatableFieldList = IDPD, LINEA, DESCRIPCION, CANTIDAD, LONGITUD, ALTURA, ANCHURA, FORMULA, TOTAL, ;
		UpdateNameList = <fb2p_value>IDPM pr_ProyectoMed.IDPM, IDPD pr_ProyectoMed.IDPD, LINEA pr_ProyectoMed.LINEA, DESCRIPCION pr_ProyectoMed.DESCRIPCION, CANTIDAD pr_ProyectoMed.CANTIDAD, LONGITUD pr_ProyectoMed.LONGITUD, ALTURA pr_ProyectoMed.ALTURA, ANCHURA pr_ProyectoMed.ANCHURA, FORMULA pr_ProyectoMed.FORMULA, TOTAL pr_ProyectoMed.TOTAL</fb2p_value>, ;
		UseDeDataSource = .T., ;
		Width = 130
		*< END OBJECT: BaseClass="cursoradapter" />
	
	PROCEDURE Cursoradapter1.AutoOpen
		*** Setup code: DO NOT REMOVE
		if not pemstatus(This, '__VFPSetup', 5)
			This.AddProperty('__VFPSetup', 1)
			This.Init()
		endif
		*** End of Setup code: DO NOT REMOVE
		
	ENDPROC

	PROCEDURE Cursoradapter1.Init
		*** Setup code: DO NOT REMOVE
		local llReturn
		do case
			case not pemstatus(This, '__VFPSetup', 5)
				This.AddProperty('__VFPSetup', 0)
			case This.__VFPSetup = 1
				This.__VFPSetup = 2
			case This.__VFPSetup = 2
				This.__VFPSetup = 0
				return
		endcase
		set multilocks on
		llReturn = dodefault()
		*** End of Setup code: DO NOT REMOVE
		
		*** Setup code: DO NOT REMOVE
		if This.__VFPSetup = 1
			This.__VFPSetup = 2
		endif
		return llReturn
		*** End of Setup code: DO NOT REMOVE
		
	ENDPROC

	PROCEDURE Cursoradapter2.AutoOpen
		*** Setup code: DO NOT REMOVE
		if not pemstatus(This, '__VFPSetup', 5)
			This.AddProperty('__VFPSetup', 1)
			This.Init()
		endif
		*** End of Setup code: DO NOT REMOVE
		
	ENDPROC

	PROCEDURE Cursoradapter2.Init
		*** Setup code: DO NOT REMOVE
		local llReturn
		do case
			case not pemstatus(This, '__VFPSetup', 5)
				This.AddProperty('__VFPSetup', 0)
			case This.__VFPSetup = 1
				This.__VFPSetup = 2
			case This.__VFPSetup = 2
				This.__VFPSetup = 0
				return
		endcase
		set multilocks on
		llReturn = dodefault()
		*** End of Setup code: DO NOT REMOVE
		
		*** Setup code: DO NOT REMOVE
		if This.__VFPSetup = 1
			This.__VFPSetup = 2
		endif
		return llReturn
		*** End of Setup code: DO NOT REMOVE
		
	ENDPROC

	PROCEDURE Cursoradapter3.AutoOpen
		*** Setup code: DO NOT REMOVE
		if not pemstatus(This, '__VFPSetup', 5)
			This.AddProperty('__VFPSetup', 1)
			This.Init()
		endif
		*** End of Setup code: DO NOT REMOVE
		
	ENDPROC

	PROCEDURE Cursoradapter3.Init
		*** Setup code: DO NOT REMOVE
		local llReturn
		do case
			case not pemstatus(This, '__VFPSetup', 5)
				This.AddProperty('__VFPSetup', 0)
			case This.__VFPSetup = 1
				This.__VFPSetup = 2
			case This.__VFPSetup = 2
				This.__VFPSetup = 0
				return
		endcase
		set multilocks on
		llReturn = dodefault()
		*** End of Setup code: DO NOT REMOVE
		
		*** Setup code: DO NOT REMOVE
		if This.__VFPSetup = 1
			This.__VFPSetup = 2
		endif
		return llReturn
		*** End of Setup code: DO NOT REMOVE
		
	ENDPROC

ENDDEFINE

DEFINE CLASS tsbaseform12 AS tsbaseform OF "..\libs\tsbase.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Pageframe1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.oleImagesList" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.OleTreeView" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.Unidad" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.Tslabel1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.Tstextbox1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.Tslabel2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.Tstextbox2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.Tslabel3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.Tslabel4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.txtDesc" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.Tslabel5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.Tstextbox3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.Tslabel6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.Tstextbox4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.Tslabel7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.Tstextbox5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.grdPr_proyectodetlist" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.grdPr_proyectodetlist.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.grdPr_proyectodetlist.Column4.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.grdPr_proyectodetlist.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.grdPr_proyectodetlist.Column5.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.grdPr_proyectodetlist.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.grdPr_proyectodetlist.Column7.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.grdPr_proyectodetlist.Column8.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.grdPr_proyectodetlist.Column8.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.grdPr_proyectodetlist.Column9.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.grdPr_proyectodetlist.Column9.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.grdPr_proyectodetlist.Column10.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Proyecto.grdPr_proyectodetlist.Column10.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Unidad" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tslabel3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tslabel4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtDesc" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tslabel5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tstextbox3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tslabel6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tstextbox4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tslabel7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tstextbox5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tslabel1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tstextbox1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tslabel2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Total" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.grdPr_proyectomed" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.grdPr_proyectomed.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.grdPr_proyectomed.Column3.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.grdPr_proyectomed.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.grdPr_proyectomed.Column4.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.grdPr_proyectomed.Column5.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.grdPr_proyectomed.Column5.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.grdPr_proyectomed.Column6.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.grdPr_proyectomed.Column6.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.grdPr_proyectomed.Column7.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.grdPr_proyectomed.Column7.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.grdPr_proyectomed.Column8.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.grdPr_proyectomed.Column8.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.grdPr_proyectomed.Column9.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.grdPr_proyectomed.Column9.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.grdPr_proyectomed.Column10.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.grdPr_proyectomed.Column10.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tslabel8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tstextbox6" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: filltree
		*m: medir
		*m: newkey
		*p: idproyecto
		*p: key
	*</DefinedPropArrayMethod>

	campos = IdProyecto,IdEmpresa,IdPadre
	Caption = "Carpeta de Proyecto"
	DataSession = 2
	DoCreate = .T.
	Height = 526
	idproyecto = 1
	key = .F.
	Name = "Tsbaseform12"
	tabla1 = pr_proyectoDet
	tabla2 = pr_proyectoMed
	tabla3 = pr_ProyectoDetList
	valores = thisform.IdProyecto,oApp.Empresa,thisform.key
	Width = 874
	lblRequerido.Name = "lblRequerido"
	lblRequerido.ZOrderSet = 1

	ADD OBJECT 'Pageframe1' AS pageframe WITH ;
		ErasePage = .T., ;
		Height = 526, ;
		Left = 0, ;
		Name = "Pageframe1", ;
		PageCount = 4, ;
		Top = 0, ;
		Width = 864, ;
		ZOrderSet = 0, ;
		Page1.Caption = "Proyecto", ;
		Page1.FontSize = 8, ;
		Page1.Name = "Proyecto", ;
		Page2.Caption = "Ficha", ;
		Page2.FontSize = 8, ;
		Page2.Name = "Page2", ;
		Page3.Caption = "Mediciones", ;
		Page3.FontSize = 8, ;
		Page3.Name = "Page1", ;
		Page4.Caption = "Descomposicion", ;
		Page4.FontSize = 8, ;
		Page4.Name = "Page3"
		*< END OBJECT: BaseClass="pageframe" />

	ADD OBJECT 'Pageframe1.Page1.grdPr_proyectomed' AS tsgrid WITH ;
		campo = IdPD, ;
		cfieldtosum = total, ;
		ColumnCount = 8, ;
		editable = .T., ;
		FontSize = 8, ;
		Height = 409, ;
		Left = 23, ;
		Name = "grdPr_proyectomed", ;
		Panel = 1, ;
		RecordSource = "pr_ProyectoMed", ;
		RecordSourceType = 1, ;
		RowHeight = 17, ;
		ScrollBars = 2, ;
		Top = 58, ;
		valor = pr_proyectoDetList.IdPD, ;
		valorvariable = pr_proyectoDetList.IdPD, ;
		variablevista = m.IdPD, ;
		Width = 756, ;
		Column1.ControlSource = "pr_ProyectoMed.linea", ;
		Column1.FontSize = 8, ;
		Column1.Name = "Column3", ;
		Column1.Width = 38, ;
		Column2.ControlSource = "pr_ProyectoMed.descripcion", ;
		Column2.FontSize = 8, ;
		Column2.Name = "Column4", ;
		Column2.Width = 197, ;
		Column3.ColumnOrder = 4, ;
		Column3.ControlSource = "pr_ProyectoMed.cantidad", ;
		Column3.FontSize = 8, ;
		Column3.Name = "Column5", ;
		Column3.Width = 58, ;
		Column4.ColumnOrder = 5, ;
		Column4.ControlSource = "pr_ProyectoMed.longitud", ;
		Column4.FontSize = 8, ;
		Column4.Name = "Column6", ;
		Column4.Width = 59, ;
		Column5.ColumnOrder = 6, ;
		Column5.ControlSource = "pr_ProyectoMed.altura", ;
		Column5.FontSize = 8, ;
		Column5.Name = "Column7", ;
		Column5.Width = 57, ;
		Column6.ColumnOrder = 7, ;
		Column6.ControlSource = "pr_ProyectoMed.anchura", ;
		Column6.FontSize = 8, ;
		Column6.Name = "Column8", ;
		Column6.Width = 62, ;
		Column7.ColumnOrder = 3, ;
		Column7.ControlSource = "pr_ProyectoMed.formula", ;
		Column7.FontSize = 8, ;
		Column7.Name = "Column9", ;
		Column7.Width = 183, ;
		Column8.ColumnOrder = 8, ;
		Column8.ControlSource = "pr_ProyectoMed.total", ;
		Column8.FontSize = 8, ;
		Column8.Name = "Column10", ;
		Column8.ReadOnly = .T., ;
		Column8.Width = 74
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="grid" />

	ADD OBJECT 'Pageframe1.Page1.grdPr_proyectomed.Column10.Header1' AS header WITH ;
		Caption = "total", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page1.grdPr_proyectomed.Column10.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.grdPr_proyectomed.Column3.Header1' AS header WITH ;
		Caption = "linea", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page1.grdPr_proyectomed.Column3.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.grdPr_proyectomed.Column4.Header1' AS header WITH ;
		Caption = "descripcion", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page1.grdPr_proyectomed.Column4.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.grdPr_proyectomed.Column5.Header1' AS header WITH ;
		Caption = "cantidad", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page1.grdPr_proyectomed.Column5.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.grdPr_proyectomed.Column6.Header1' AS header WITH ;
		Caption = "longitud", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page1.grdPr_proyectomed.Column6.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.grdPr_proyectomed.Column7.Header1' AS header WITH ;
		Caption = "altura", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page1.grdPr_proyectomed.Column7.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.grdPr_proyectomed.Column8.Header1' AS header WITH ;
		Caption = "anchura", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page1.grdPr_proyectomed.Column8.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.grdPr_proyectomed.Column9.Header1' AS header WITH ;
		Caption = "formula", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page1.grdPr_proyectomed.Column9.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.Total' AS tstextbox WITH ;
		ControlSource = "", ;
		editable = .F., ;
		Enabled = .F., ;
		Height = 21, ;
		Left = 683, ;
		Name = "Total", ;
		Top = 22, ;
		Width = 72
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.Tslabel1' AS tslabel WITH ;
		AutoSize = .F., ;
		Caption = "Alto", ;
		Height = 16, ;
		Left = 623, ;
		Name = "Tslabel1", ;
		Top = 8, ;
		Width = 26
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Tslabel2' AS tslabel WITH ;
		AutoSize = .F., ;
		Caption = "Total", ;
		Height = 16, ;
		Left = 683, ;
		Name = "Tslabel2", ;
		Top = 8, ;
		Width = 31
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Tslabel3' AS tslabel WITH ;
		AutoSize = .F., ;
		Caption = "U.M.", ;
		Height = 16, ;
		Left = 11, ;
		Name = "Tslabel3", ;
		Top = 8, ;
		Width = 27
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Tslabel4' AS tslabel WITH ;
		AutoSize = .F., ;
		Caption = "Descripcion", ;
		Height = 16, ;
		Left = 71, ;
		Name = "Tslabel4", ;
		Top = 8, ;
		Width = 69
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Tslabel5' AS tslabel WITH ;
		AutoSize = .F., ;
		Caption = "Cantidad", ;
		Height = 16, ;
		Left = 443, ;
		Name = "Tslabel5", ;
		Top = 8, ;
		Width = 52
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Tslabel6' AS tslabel WITH ;
		AutoSize = .F., ;
		Caption = "Largo", ;
		Height = 16, ;
		Left = 503, ;
		Name = "Tslabel6", ;
		Top = 8, ;
		Width = 36
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Tslabel7' AS tslabel WITH ;
		AutoSize = .F., ;
		Caption = "Ancho", ;
		Height = 16, ;
		Left = 563, ;
		Name = "Tslabel7", ;
		Top = 8, ;
		Width = 39
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Tslabel8' AS tslabel WITH ;
		AutoSize = .F., ;
		Caption = "Formula", ;
		Height = 16, ;
		Left = 251, ;
		Name = "Tslabel8", ;
		Top = 8, ;
		Width = 49
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Tstextbox1' AS tstextbox WITH ;
		ControlSource = "", ;
		Height = 21, ;
		Left = 623, ;
		Name = "Tstextbox1", ;
		Top = 22, ;
		Width = 60
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.Tstextbox3' AS tstextbox WITH ;
		ControlSource = "", ;
		Height = 21, ;
		Left = 443, ;
		Name = "Tstextbox3", ;
		Top = 22, ;
		Width = 60
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.Tstextbox4' AS tstextbox WITH ;
		ControlSource = "", ;
		Height = 21, ;
		Left = 503, ;
		Name = "Tstextbox4", ;
		Top = 22, ;
		Width = 60
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.Tstextbox5' AS tstextbox WITH ;
		ControlSource = "", ;
		Height = 21, ;
		Left = 563, ;
		Name = "Tstextbox5", ;
		Top = 22, ;
		Width = 60
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.Tstextbox6' AS tstextbox WITH ;
		ControlSource = "pr_ProyectoMed.formula", ;
		Height = 21, ;
		Left = 251, ;
		Name = "Tstextbox6", ;
		ReadOnly = .F., ;
		Top = 22, ;
		Width = 192
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtDesc' AS tstextbox WITH ;
		ControlSource = "pr_ProyectoDetList.producto", ;
		Height = 21, ;
		Left = 71, ;
		Name = "txtDesc", ;
		ReadOnly = .T., ;
		Top = 22, ;
		Width = 192
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.Unidad' AS tscombobox WITH ;
		BoundColumn = 1, ;
		cmdsql = Select Unidad from st_Unidad, ;
		ColumnCount = 1, ;
		ColumnWidths = "105,0", ;
		ControlSource = "pr_ProyectoDetList.um", ;
		cursor = cUnidad, ;
		editable = .F., ;
		Enabled = .F., ;
		FirstElement = 1, ;
		Height = 22, ;
		Left = 11, ;
		Name = "Unidad", ;
		NumberOfElements = 0, ;
		Style = 2, ;
		TabIndex = 5, ;
		Top = 22, ;
		Width = 52, ;
		ZOrderSet = 36
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'Pageframe1.Proyecto.grdPr_proyectodetlist' AS tsgrid WITH ;
		ColumnCount = 6, ;
		FontSize = 8, ;
		Height = 288, ;
		Left = 227, ;
		Name = "grdPr_proyectodetlist", ;
		Panel = 1, ;
		ReadOnly = .T., ;
		RecordSource = "pr_ProyectoDetList", ;
		RecordSourceType = 1, ;
		RowHeight = 17, ;
		Top = 20, ;
		valorvariable = thisform.key, ;
		variablevista = m.idPadre, ;
		Width = 612, ;
		Column1.ControlSource = "pr_ProyectoDetList.idproducto", ;
		Column1.FontSize = 8, ;
		Column1.Name = "Column4", ;
		Column1.ReadOnly = .T., ;
		Column1.Width = 70, ;
		Column2.ControlSource = "pr_ProyectoDetList.producto", ;
		Column2.FontSize = 8, ;
		Column2.Name = "Column5", ;
		Column2.ReadOnly = .T., ;
		Column2.Width = 150, ;
		Column3.ControlSource = "pr_ProyectoDetList.um", ;
		Column3.FontSize = 8, ;
		Column3.Name = "Column7", ;
		Column3.ReadOnly = .T., ;
		Column3.Width = 87, ;
		Column4.ControlSource = "pr_ProyectoDetList.cantidad", ;
		Column4.FontSize = 8, ;
		Column4.Name = "Column8", ;
		Column4.ReadOnly = .T., ;
		Column4.Width = 66, ;
		Column5.ControlSource = "pr_ProyectoDetList.precio", ;
		Column5.FontSize = 8, ;
		Column5.Name = "Column9", ;
		Column5.ReadOnly = .T., ;
		Column5.Width = 65, ;
		Column6.ControlSource = "pr_ProyectoDetList.importe", ;
		Column6.FontSize = 8, ;
		Column6.Name = "Column10", ;
		Column6.ReadOnly = .T., ;
		Column6.Width = 83
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="grid" />

	ADD OBJECT 'Pageframe1.Proyecto.grdPr_proyectodetlist.Column10.Header1' AS header WITH ;
		Caption = "importe", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Proyecto.grdPr_proyectodetlist.Column10.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Proyecto.grdPr_proyectodetlist.Column4.Header1' AS header WITH ;
		Caption = "idproducto", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Proyecto.grdPr_proyectodetlist.Column4.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Proyecto.grdPr_proyectodetlist.Column5.Header1' AS header WITH ;
		Caption = "producto", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Proyecto.grdPr_proyectodetlist.Column5.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Proyecto.grdPr_proyectodetlist.Column7.Header1' AS header WITH ;
		Caption = "um", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Proyecto.grdPr_proyectodetlist.Column7.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Proyecto.grdPr_proyectodetlist.Column8.Header1' AS header WITH ;
		Caption = "cantidad", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Proyecto.grdPr_proyectodetlist.Column8.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Proyecto.grdPr_proyectodetlist.Column9.Header1' AS header WITH ;
		Caption = "precio", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Proyecto.grdPr_proyectodetlist.Column9.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Proyecto.oleImagesList' AS olecontrol WITH ;
		Height = 37, ;
		Left = 179, ;
		Name = "oleImagesList", ;
		Top = 10, ;
		Width = 49
		*< END OBJECT: BaseClass="olecontrol"  Nombre="Tsbaseform12.Pageframe1.Proyecto.oleImagesList" Parent="Tsbaseform12.Pageframe1.Proyecto" ObjName="oleImagesList" OLEObject="C:\WINDOWS\system32\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAABQAAAAYAAAAHAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACOkTaUyccBAwAAAAAKAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAA4ggAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAHIAAAAAAAAAAQAAAP7///8DAAAA/v///wUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAACAAAAAhAAAAIgAAACMAAAAkAAAAJQAAACYAAAAnAAAA/v////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9cAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAJAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADkzNjgyNjVFLTg1RkUtMTFkMS04QkUzLTAwMDBGODc1NERBMQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAIAMAAAASW1hZ2VIZWlnaHQACQAAAEkKAAAAEAAAAAsAAABJbWFnZVdpZHRoAAkAAABJCgAAABAAAAANAAAAVXNlTWFza0NvbG9yAAUAAABMAQAAAAoAAABCYWNrQ29sb3IACQAAAEkKAAAADAAAgAAAAAAAAAAAAAAAAAAAI38kLJGF0RGxagDA8Cg2KCFDNBIIAAAA7QMAAO0DAACAfuHmAAAGACIAAAAQABAAwMDAAP//AAAB782rAAAFABhGHwAGAAAA/////wwAAIAAAAAAAgAAAAAAAgAAAAEAAABsdAAANgQAAAAAAQACACAgEAAAAAAA6AIAACYAAAAQEBAAAAAAACgBAAAOAwAAKAAAACAAAABAAAAAAQAEAAAAAACAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIAAAACAgACAAAAAgACAAICAAACAgIAAwMDAAAAA/wAA/wAAAP//AP8AAAD/AP8A//8AAP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAd3d3d3d3d3d3d3d3d3cwAH+4uLi4uLi4uLi4uLi4MAB/i4uLi4uLi4uLi4uLizAAf7i4uLi4uLi4uLi4uLgwAH+Li4uLi4uLi4uLi4uLMAB/uLi4uLi4uLi4uLi4uDAAf4uLi4uLi4uLi4uLi4swAH+4uLi4uLi4uLi4uLi4MAB/i4uLi4uLi4uLi4uLizAAf7i4uLi4uLi4uLi4uLgwAH+Li4uLi4uLi4uLi4uLMAB/uLi4uLi4uLi4uLi4uDAAf4uLi4uLi4uLi4uLi4swAH+4uLi4uLi4uLi4uLi4MAB/i4uLi4uLi4uLi4uLizAAf7i4uLi4uLi4uLi4uLgwAH+Li4uLi4uLi4uLi4uLMAB/uLi4uLi4uLi4uLi4uDAAf/////////////////8AAHiIiIiIiIiId3d3d3d3AAAH+4uLi4uLhwAAAAAAAAAAAH+4uLi4uHAAAAAAAAAAAAAH//////cAAAAAAAAAAAAAAHd3d3dwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP/////////////////////AAAADgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAA4AAAAfAAH//4AD///AB///4A///////////////////KAAAABAAAAAgAAAAAQAEAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIAAAACAgACAAAAAgACAAICAAACAgIAAwMDAAAAA/wAA/wAAAP//AP8AAAD/AP8A//8AAP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB3d3d3d3d3AH+4uLi4uLcAf4uLi4uLhwB/uLi4uLi3AH+Li4uLi4cAf7i4uLi4twB/i4uLi4uHAH+4uLi4uLcAf///////9wB4uLi4d3d3AAeLi4cAAAAAAHd3cAAAAAAAAAAAAAAAAP//AAD//wAAgAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAADAACA/wAAwf8AAP//AAACAAAAbHQAADYEAAAAAAEAAgAgIBAAAAAAAOgCAAAmAAAAEBAQAAAAAAAoAQAADgMAACgAAAAgAAAAQAAAAAEABAAAAAAAgAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAgICAAMDAwAAAAP8AAP8AAAD//wD/AAAA/wD/AP//AAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHMzMzMzMzMzMzMzMzMzAAB7i4uLi4uLi4uLi4uLgwAAeLi4uLi4uLi4uLi4uLMAB4uLi4uLi4uLi4uLi4uAAAe4uLi4uLi4uLi4uLi4gAAHi4uLi4uLi4uLi4uLi3AAB7i4uLi4uLi4uLi4uLhwAHuLi4uLi4uLi4uLi4uLAwB4uLi4uLi4uLi4uLi4uAMAe4uLi4uLi4uLi4uLi4cDAHi4uLi4uLi4uLi4uLi3AweLi4uLi4uLi4uLi4uLgHMHuLi4uLi4uLi4uLi4uLBzB4uLi4uLi4uLi4uLi4twswe4uLi4uLi4uLi4uLi4cIMH/////////////////wezAHeIiIiIiIiIiIiIiIiLgwAAf7i4uLi4uLi4uLi4uLMAAH+Li4uLi4uLi4uLi4uDAAB/uLi4uLi4uLi4uLi4swAAf4uLi4uLi4v///////AAAH+4uLi4uLi4d3d3d3dwAAAH+4uLi4uLhwAAAAAAAAAAAH+4uLi4uHAAAAAAAAAAAAAH//////cAAAAAAAAAAAAAAHd3d3dwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD////////////////wAAAB4AAAAOAAAADgAAAAwAAAAMAAAADAAAAAwAAAAIAAAACAAAAAgAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAADgAAAA4AAAAOAAAADgAAAB4AAAA/AAH//4AD///AB///4A/////////////ygAAAAQAAAAIAAAAAEABAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAgICAAMDAwAAAAP8AAP8AAAD//wD/AAAA/wD/AP//AAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHd3d3d3dwAAf7i4uLi3AAf7i4uLi4BwB/i4uLi4cHB/i4uLi4sHcH//////9whwd3d3d3d3e3AH+Li4uLi4cAf7i4uP//9wB/i4uPd3d3AAf///cAAAAAAHd3cAAAAAAAAAAAAAAAD//wAA//8AAOAAAADAAAAAwAAAAIAAAACAAAAAAAAAAAAAAAAAAAAAgAAAAIAAAACAAQAAwH8AAOD/AAD//wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA" />

	ADD OBJECT 'Pageframe1.Proyecto.OleTreeView' AS olecontrol WITH ;
		Enabled = .T., ;
		Height = 420, ;
		Left = 11, ;
		Name = "OleTreeView", ;
		TabIndex = 17, ;
		Top = 20, ;
		Width = 204
		*< END OBJECT: BaseClass="olecontrol"  Nombre="Tsbaseform12.Pageframe1.Proyecto.OleTreeView" Parent="Tsbaseform12.Pageframe1.Proyecto" ObjName="OleTreeView" OLEObject="C:\WINDOWS\system32\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAUkzaUyccBAwAAAAADAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAigAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAJsBAAAAAAAACAAAAAIAAAD+////BAAAAAUAAAAGAAAABwAAAAkAAAAKAAAACwAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+2kEHHiYXREbFqAMDwKDYoIUM0EggAAAAWFQAAaSsAALE8wWoBAAYAIgAAAB0BAAARAgAACgAAAEE9HQAB782rXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACADgAAAEhpZGVTZWxlY3Rpb24ABQAAAEwAAAAADAAAAEluZGVudGF0aW9uABEAAABODQAAAAcAAAAAAAAAAAA0QAoAAABMaW5lU3R5bGUACQAAAEkKAAAAAQAAAA0AAABNb3VzZVBvaW50ZXIACQAAAEkKAAAAAAAAAA4AAABQYXRoU2VwYXJhdG9yAAoAAABIAAAAAAEAAABcBwAAAFNvcnRlZAAFAAAATAEAAAAMAAAAT0xFRHJhZ01vZGUACQAAAEkKAAAAAAAAAAwAAABPTEVEcm9wTW9kZQAJAAAASQoAAAAAAAAACwAAAEFwcGVhcmFuY2UACQAAAEkKAAAAAQAAAAwAAABCb3JkZXJTdHlsZQAJAAAASQoAAAABAAAACwAAAENoZWNrYm94ZXMABQAAAEwAAAAADgAAAAAABQAQPx0ABwAAAAAAAAAFAACAzNcSAAEAAABcAB/e7L0BAAUAEdgSAANS4wuRj84RneMAqgBLuFEBAAAAkAFGdWxsUm93U2VsZWN0AAUAAABMAQAAAAwAAABIb3RUcmFja2luZwAFAAAATAAAAAAHAAAAU2Nyb2xsAAUAAABMREIBAAVBcmlhbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAKAAAAU2luZ2xlU2VsAAUAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAoAQAADgMAACgAAAAgAAAAQAAAAAEABAAAAAAAgAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAgICAAMDAwAAAAP8AAP8AAAD//wD/AAAA/wD/AP//AAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADu7u7oiIAAAAAAAAAAAAAA7u7u6IiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////iAAAAAAAAAAAAAAA//////iAAAAAAAAAAAAAAP/////4gAAAAAAA" />

	ADD OBJECT 'Pageframe1.Proyecto.Tslabel1' AS tslabel WITH ;
		Caption = "Codigo", ;
		Left = 11, ;
		Name = "Tslabel1", ;
		Top = 452
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Proyecto.Tslabel2' AS tslabel WITH ;
		Caption = "Codigo", ;
		Left = 119, ;
		Name = "Tslabel2", ;
		Top = 452
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Proyecto.Tslabel3' AS tslabel WITH ;
		Caption = "U.M.", ;
		Left = 227, ;
		Name = "Tslabel3", ;
		Top = 452
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Proyecto.Tslabel4' AS tslabel WITH ;
		Caption = "Descripcion", ;
		Left = 323, ;
		Name = "Tslabel4", ;
		Top = 452
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Proyecto.Tslabel5' AS tslabel WITH ;
		Caption = "Codigo", ;
		Left = 515, ;
		Name = "Tslabel5", ;
		Top = 452
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Proyecto.Tslabel6' AS tslabel WITH ;
		Caption = "Codigo", ;
		Left = 611, ;
		Name = "Tslabel6", ;
		Top = 452
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Proyecto.Tslabel7' AS tslabel WITH ;
		Caption = "Codigo", ;
		Left = 719, ;
		Name = "Tslabel7", ;
		Top = 452
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Proyecto.Tstextbox1' AS tstextbox WITH ;
		ControlSource = "pr_ProyectoDet.idproducto", ;
		Left = 11, ;
		Name = "Tstextbox1", ;
		Top = 464
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Proyecto.Tstextbox2' AS tstextbox WITH ;
		ControlSource = "", ;
		Left = 119, ;
		Name = "Tstextbox2", ;
		Top = 464
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Proyecto.Tstextbox3' AS tstextbox WITH ;
		ControlSource = "", ;
		Left = 515, ;
		Name = "Tstextbox3", ;
		Top = 464
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Proyecto.Tstextbox4' AS tstextbox WITH ;
		ControlSource = "", ;
		Left = 611, ;
		Name = "Tstextbox4", ;
		Top = 464
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Proyecto.Tstextbox5' AS tstextbox WITH ;
		ControlSource = "", ;
		Left = 719, ;
		Name = "Tstextbox5", ;
		Top = 464
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Proyecto.txtDesc' AS tstextbox WITH ;
		ControlSource = "pr_ProyectoDet.producto", ;
		Height = 21, ;
		Left = 323, ;
		Name = "txtDesc", ;
		Top = 464, ;
		Width = 192
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Proyecto.Unidad' AS tscombobox WITH ;
		BoundColumn = 1, ;
		cmdsql = Select Unidad from st_Unidad, ;
		ColumnCount = 1, ;
		ColumnWidths = "105,0", ;
		ControlSource = "pr_ProyectoDet.um", ;
		cursor = cUnidad, ;
		editable = .T., ;
		FirstElement = 1, ;
		Height = 22, ;
		Left = 263, ;
		Name = "Unidad", ;
		NumberOfElements = 0, ;
		Style = 2, ;
		TabIndex = 5, ;
		Top = 464, ;
		Width = 52, ;
		ZOrderSet = 36
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />
	
	PROCEDURE filltree
		cmdsql="Select IdPD,Producto=RTRIM(IdProducto) + ' - '+ Producto,Tipo,IdPadre from pr_proyectoDET where IdProyecto=?this.idproyecto"
		this.runsql(cmdsql,"pr")
		SELECT pr
		
		
		THISFORM.Pageframe1.Proyecto.OLETREEVIEW.DOVERB(-1)
		THIS.Pageframe1.Proyecto.OLETREEVIEW.IMAGELIST = THIS.Pageframe1.Proyecto.OLEIMAGESLIST
		O = THISFORM.Pageframe1.Proyecto.OLETREEVIEW.NODES
		O.CLEAR
		
		SCAN 
			
			
				IF ISNULL(IdPadre)
					O.ADD( , 1, this.newkey(IdPD), ALLTRIM(Producto), 1, 2)
				ELSE
					
						O.ADD(this.newkey(IdPadre), 4, this.newkey(IdPD), ALLTRIM(Producto), 1, 2)
		
				ENDIF
		ENDSCAN
		THISFORM.Pageframe1.Proyecto.OLETREEVIEW.FONT.SIZE = 8
		THISFORM.Pageframe1.Proyecto.OLETREEVIEW.LABELEDIT = 1
		THISFORM.Pageframe1.Proyecto.OLETREEVIEW.LINESTYLE = 1
		THISFORM.Pageframe1.Proyecto.OLETREEVIEW.indentation=4
		THISFORM.Pageframe1.Proyecto.OLETREEVIEW.SORTED = .F.
		
		
		
	ENDPROC

	PROCEDURE Init
		SET CLASSLIB TO proyecto ADDITIVE 
		DODEFAULT()
		this.filltree()
		
	ENDPROC

	PROCEDURE medir
		LOCAL mTotal
		IF !EMPTY(NVL(pr_ProyectoMed.Formula,''))
			mTotal = EVALUATE(pr_ProyectoMed.Formula)
		ELSE
			mTotal = pr_ProyectoMed.Cantidad * pr_ProyectoMed.Longitud * pr_ProyectoMed.Altura *pr_ProyectoMed.Anchura
		ENDIF
		replace Total WITH mTotal IN pr_ProyectoMed		
		
		ThisForm.Pageframe1.Page1.Total.Refresh()
		
		replace cantidad WITH ThisForm.Pageframe1.Page1.Total.Value IN pr_ProyectoDetList
		
	ENDPROC

	PROCEDURE newkey
		LPARAMETERS IdNodo
		RETURN ALLTRIM(STR(IdNodo))+"_"
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.Activate
		this.Refresh()
		
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.Deactivate
		*thisform.save()
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.grdPr_proyectomed.Column5.Text1.GotFocus
		this.Tag=STR(this.Value,10,4)
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.grdPr_proyectomed.Column5.Text1.LostFocus
		IF this.Tag<>STR(this.Value,10,4)
			thisform.medir()
		ENDIF
			
	ENDPROC

	PROCEDURE Pageframe1.Page1.grdPr_proyectomed.Column6.Text1.GotFocus
		this.Tag=STR(this.Value,10,4)
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.grdPr_proyectomed.Column6.Text1.LostFocus
		IF this.Tag<>STR(this.Value,10,4)
			thisform.medir()
		ENDIF
			
	ENDPROC

	PROCEDURE Pageframe1.Page1.grdPr_proyectomed.Column7.Text1.GotFocus
		this.Tag=STR(this.Value,10,4)
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.grdPr_proyectomed.Column7.Text1.LostFocus
		IF this.Tag<>STR(this.Value,10,4)
			thisform.medir()
		ENDIF
			
	ENDPROC

	PROCEDURE Pageframe1.Page1.grdPr_proyectomed.Column8.Text1.GotFocus
		this.Tag=STR(this.Value,10,4)
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.grdPr_proyectomed.Column8.Text1.LostFocus
		IF this.Tag<>STR(this.Value,10,4)
			thisform.medir()
		ENDIF
			
	ENDPROC

	PROCEDURE Pageframe1.Page1.grdPr_proyectomed.Column9.Text1.GotFocus
		this.Tag=this.Value
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.grdPr_proyectomed.Column9.Text1.LostFocus
		IF this.Tag<>this.Value
			thisform.medir()
		ENDIF
			
	ENDPROC

	PROCEDURE Pageframe1.Page1.grdPr_proyectomed.Refresh
		DODEFAULT()
		
		This.parent.Total.Refresh()
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.Total.Refresh
		This.parent.grdPr_proyectomed.sumcolumn()
		this.Value=This.parent.grdPr_proyectomed.totales(1)
		
	ENDPROC

	PROCEDURE Pageframe1.Proyecto.OleTreeView.NodeClick
		LPARAMETERS NODE
		thisform.key=VAL(SUBSTR(node.key,1,LEN(node.key)-1))
		*This.parent.grdPr_proyectodetlist.Refresh()
		REQUERY('pr_ProyectoDet')
		this.Parent.Refresh()
		RETURN
		
		SELECT INFORMES
		= SEEK(NODE.KEY, 'informes', 'key')
		IF INFORMES.DISPONIBLE
		THISFORM.DESCRIP.CAPTION = INFORMES.DESCRIP
		M.CDOSNAME = INFORMES.REPOFILE
		THISFORM.LIMPIAR()
		THISFORM.FILTRAR()
		IF  .NOT. EMPTY(INFORMES.REPOFILE)
		THISFORM.EJECUTAR.ENABLED = .T.
		ELSE
		THISFORM.EJECUTAR.ENABLED = .F.
		ENDIF
		ELSE
		THISFORM.EJECUTAR.ENABLED = .F.
		THISFORM.DESCRIP.CAPTION = 'No está autorizado a acceder a este informe. Consulte con el Administrador de Sistemas'
		ENDIF
	ENDPROC

ENDDEFINE
