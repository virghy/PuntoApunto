*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="sys_exportar.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*


*
#INCLUDE "..\include\tastrade.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	DataSource = .NULL.
	Height = 200
	InitialSelectedAlias = "exportar"
	Left = 7
	Name = "Dataenvironment"
	Top = 263
	Width = 535
	
	PROCEDURE BeforeOpenTables
		DO SETEO
	ENDPROC

ENDDEFINE

DEFINE CLASS imprimir AS tsbaseform OF "..\libs\tsbase.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Container1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Ts3dshape3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="descrip" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ejecutar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Caja1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tipo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Caja2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Caja3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Caja4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Caja5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="caja6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="oleImagesList" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Container2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Agrupar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Destino" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="OleTreeView" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: exportarpivot
		*m: exportarxls
		*m: filtrar
		*m: generardbf
		*m: hechauka
		*m: hechaukacompra
		*m: hechaukaventa
	*</DefinedPropArrayMethod>

	AlwaysOnTop = .F.
	AutoCenter = .T.
	BorderStyle = 2
	Caption = "Exportar"
	ctoolbar = 
	DataSession = 2
	DoCreate = .T.
	editmode = .T.
	FontSize = 8
	Height = 450
	HelpContextID = 106
	Icon = ..\
	KeyPreview = .T.
	LockScreen = .F.
	MaxButton = .F.
	MinButton = .F.
	Name = "imprimir"
	Picture = ..\
	ShowTips = .T.
	ShowWindow = 0
	WhatsThisButton = .T.
	WhatsThisHelp = .T.
	Width = 590
	WindowState = 0
	WindowType = 0
	lblRequerido.Name = "lblRequerido"

	ADD OBJECT 'Agrupar' AS optiongroup WITH ;
		AutoSize = .F., ;
		BackStyle = 0, ;
		ButtonCount = 2, ;
		Height = 24, ;
		Left = 14, ;
		Name = "Agrupar", ;
		SpecialEffect = 0, ;
		TabIndex = 23, ;
		Top = 76, ;
		Value = 1, ;
		Width = 286, ;
		ZOrderSet = 22, ;
		Option1.Alignment = 0, ;
		Option1.AutoSize = .F., ;
		Option1.BackStyle = 0, ;
		Option1.Caption = "Por Categoría", ;
		Option1.FontBold = .F., ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 20, ;
		Option1.Name = "Option1", ;
		Option1.Top = 4, ;
		Option1.Value = 1, ;
		Option1.Width = 112, ;
		Option2.AutoSize = .F., ;
		Option2.BackStyle = 0, ;
		Option2.Caption = "Por Orden Alfabetico", ;
		Option2.FontBold = .F., ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 149, ;
		Option2.Name = "Option2", ;
		Option2.Top = 4, ;
		Option2.Width = 139
		*< END OBJECT: BaseClass="optiongroup" />

	ADD OBJECT 'Caja1' AS caja WITH ;
		Left = 314, ;
		Name = "Caja1", ;
		SpecialEffect = 0, ;
		TabIndex = 1, ;
		Top = 77, ;
		ZOrderSet = 11, ;
		Cmdcal1.Name = "Cmdcal1", ;
		ETIQ.Name = "ETIQ", ;
		LISTA.Name = "LISTA", ;
		TEXTO.Name = "TEXTO", ;
		texto2.Name = "texto2"
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="container" />

	ADD OBJECT 'Caja2' AS caja WITH ;
		Left = 314, ;
		Name = "Caja2", ;
		SpecialEffect = 0, ;
		TabIndex = 2, ;
		Top = 117, ;
		ZOrderSet = 12, ;
		Cmdcal1.Name = "Cmdcal1", ;
		ETIQ.Name = "ETIQ", ;
		LISTA.Name = "LISTA", ;
		TEXTO.Name = "TEXTO", ;
		texto2.Name = "texto2"
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="container" />

	ADD OBJECT 'Caja3' AS caja WITH ;
		Left = 314, ;
		Name = "Caja3", ;
		TabIndex = 3, ;
		Top = 157, ;
		ZOrderSet = 13, ;
		Cmdcal1.Name = "Cmdcal1", ;
		ETIQ.Name = "ETIQ", ;
		LISTA.Name = "LISTA", ;
		TEXTO.Name = "TEXTO", ;
		texto2.Name = "texto2"
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="container" />

	ADD OBJECT 'Caja4' AS caja WITH ;
		Left = 314, ;
		Name = "Caja4", ;
		TabIndex = 4, ;
		Top = 197, ;
		ZOrderSet = 14, ;
		Cmdcal1.Name = "Cmdcal1", ;
		ETIQ.Name = "ETIQ", ;
		LISTA.Name = "LISTA", ;
		TEXTO.Name = "TEXTO", ;
		texto2.Name = "texto2"
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="container" />

	ADD OBJECT 'Caja5' AS caja WITH ;
		Left = 314, ;
		Name = "Caja5", ;
		TabIndex = 5, ;
		Top = 237, ;
		ZOrderSet = 15, ;
		Cmdcal1.Name = "Cmdcal1", ;
		ETIQ.Name = "ETIQ", ;
		LISTA.Name = "LISTA", ;
		TEXTO.Name = "TEXTO", ;
		texto2.Name = "texto2"
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="container" />

	ADD OBJECT 'caja6' AS caja WITH ;
		Left = 314, ;
		Name = "caja6", ;
		TabIndex = 6, ;
		Top = 277, ;
		Width = 269, ;
		ZOrderSet = 16, ;
		Cmdcal1.Name = "Cmdcal1", ;
		ETIQ.Name = "ETIQ", ;
		LISTA.Name = "LISTA", ;
		TEXTO.Name = "TEXTO", ;
		texto2.Name = "texto2"
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="container" />

	ADD OBJECT 'Command1' AS commandbutton WITH ;
		Caption = "\<Cerrar", ;
		ColorScheme = 1, ;
		ColorSource = 4, ;
		Enabled = .T., ;
		FontSize = 8, ;
		Height = 53, ;
		Left = 452, ;
		MousePointer = 0, ;
		Name = "Command1", ;
		Picture = ..\bitmaps\close.bmp, ;
		Style = 0, ;
		TabIndex = 10, ;
		Top = 388, ;
		Width = 122, ;
		ZOrderSet = 19
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Command2' AS commandbutton WITH ;
		Caption = "...", ;
		Height = 24, ;
		Left = 558, ;
		Name = "Command2", ;
		TabIndex = 12, ;
		Top = 345, ;
		Width = 24, ;
		ZOrderSet = 11
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Container1' AS container WITH ;
		BackColor = 0,0,128, ;
		BackStyle = 0, ;
		Height = 268, ;
		Left = 308, ;
		Name = "Container1", ;
		SpecialEffect = 1, ;
		TabIndex = 18, ;
		Top = 58, ;
		Width = 280, ;
		ZOrderSet = 0
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'Container2' AS container WITH ;
		BackColor = 0,128,192, ;
		BackStyle = 0, ;
		Height = 268, ;
		Left = 7, ;
		Name = "Container2", ;
		SpecialEffect = 1, ;
		TabIndex = 19, ;
		Top = 58, ;
		Width = 299, ;
		ZOrderSet = 20
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'descrip' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Descripción del informe", ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 41, ;
		Left = 19, ;
		Name = "descrip", ;
		TabIndex = 21, ;
		Top = 398, ;
		Width = 282, ;
		WordWrap = .T., ;
		ZOrderSet = 6
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Destino' AS tstextbox WITH ;
		editable = .F., ;
		Enabled = .T., ;
		Height = 24, ;
		InputMask = "", ;
		Left = 259, ;
		Name = "Destino", ;
		ReadOnly = .T., ;
		TabIndex = 11, ;
		Top = 345, ;
		Width = 294, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'ejecutar' AS commandbutton WITH ;
		Caption = "\<Exportar", ;
		ColorScheme = 1, ;
		ColorSource = 4, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 52, ;
		Left = 320, ;
		MousePointer = 0, ;
		Name = "ejecutar", ;
		Picture = ..\bitmaps\exportar.bmp, ;
		Style = 0, ;
		TabIndex = 9, ;
		Top = 389, ;
		Width = 133, ;
		ZOrderSet = 8
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Label1' AS label WITH ;
		Alignment = 2, ;
		AutoSize = .T., ;
		BackStyle = 1, ;
		Caption = "\<Destino de la Exportación", ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 15, ;
		Left = 258, ;
		Name = "Label1", ;
		TabIndex = 11, ;
		Top = 326, ;
		Width = 121, ;
		WordWrap = .T., ;
		ZOrderSet = 9
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label2' AS label WITH ;
		AutoSize = .T., ;
		Caption = "Descripción", ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 15, ;
		Left = 14, ;
		Name = "Label2", ;
		TabIndex = 20, ;
		Top = 381, ;
		Width = 58, ;
		ZOrderSet = 7
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label3' AS label WITH ;
		Alignment = 2, ;
		AutoSize = .F., ;
		BackColor = 0,0,128, ;
		BackStyle = 1, ;
		Caption = "\<Parámetros", ;
		FontBold = .T., ;
		FontName = "Arial", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Height = 15, ;
		Left = 315, ;
		Name = "Label3", ;
		TabIndex = 16, ;
		Top = 62, ;
		Width = 268, ;
		WordWrap = .T., ;
		ZOrderSet = 17
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label4' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Haga click en un informe de la lista y complete los parámetros. Luego haga un click en 'Exportar.", ;
		FontName = "MS Sans Serif", ;
		FontSize = 7, ;
		Height = 33, ;
		Left = 14, ;
		Name = "Label4", ;
		TabIndex = 13, ;
		Top = 19, ;
		Width = 297, ;
		WordWrap = .T., ;
		ZOrderSet = 3
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label5' AS label WITH ;
		AutoSize = .T., ;
		Caption = "\<Instrucciones ", ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 15, ;
		Left = 18, ;
		Name = "Label5", ;
		TabIndex = 12, ;
		Top = 2, ;
		Width = 68, ;
		ZOrderSet = 4
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label6' AS label WITH ;
		Alignment = 2, ;
		AutoSize = .F., ;
		BackColor = 0,0,128, ;
		BackStyle = 1, ;
		Caption = "\<Orígenes", ;
		FontBold = .T., ;
		FontName = "Arial", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Height = 15, ;
		Left = 14, ;
		Name = "Label6", ;
		TabIndex = 15, ;
		Top = 61, ;
		Width = 286, ;
		WordWrap = .T., ;
		ZOrderSet = 21
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label7' AS label WITH ;
		Alignment = 2, ;
		AutoSize = .T., ;
		BackStyle = 1, ;
		Caption = "\<Tipo", ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 15, ;
		Left = 17, ;
		Name = "Label7", ;
		TabIndex = 11, ;
		Top = 326, ;
		Width = 21, ;
		WordWrap = .T., ;
		ZOrderSet = 9
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'oleImagesList' AS olecontrol WITH ;
		Height = 37, ;
		Left = 276, ;
		Name = "oleImagesList", ;
		Top = 0, ;
		Width = 49, ;
		ZOrderSet = 18
		*< END OBJECT: BaseClass="olecontrol"  Nombre="imprimir.oleImagesList" Parent="imprimir" ObjName="oleImagesList" OLEObject="C:\Windows\system32\MSCOMCTL.OCX" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////v///////////////////wkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAAAQAAAD//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAu+bX/G84BAwAAAAABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAJhoAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAHIAAAAAAAAAAQAAAP7///8DAAAA/v////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9cAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAJAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADkzNjgyNjVFLTg1RkUtMTFkMS04QkUzLTAwMDBGODc1NERBMQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAIAMAAAASW1hZ2VIZWlnaHQACQAAAEkKAAAAEAAAAAsAAABJbWFnZVdpZHRoAAkAAABJCgAAABAAAAANAAAAVXNlTWFza0NvbG9yAAUAAABMAQAAAAoAAABCYWNrQ29sb3IACQAAAEkKAAAADAAAgAAAAAAAAAAAAAAAAAAAI38kLJGF0RGxagDA8Cg2KCFDNBIIAAAA7QMAAO0DAACAfuHmAAAGAAgAAAAQABAAwMDAAP//AAAB782rAAAFAAAAAAAGAAAA/////wwAAIAAAAAABAAAAAAAAAAAAAAAAQAAAGx0AAA4BAAAAAABAAIAICAQAAAAAADoAgAAJgAAABAQEAAAAAAAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAIhIiIiIiIhIiEiIiIiIiIREiIiIiIiIiIiIiIiIiIiIiIiIiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB3d3d3d3d3d3d3d3d3dzAAf7i4uLi4uLi4uLi4uLgwAH+Li4uLi4uLi4uLi4uLMAB/uLi4uLi4uLi4uLi4uDAAf4uLi4uLi4uLi4uLi4swAH+4uLi4uLi4uLi4uLi4MAB/i4uLi4uLi4uLi4uLizAAf7i4uLi4uLi4uLi4uLgwAH+Li4uLi4uLi4uLi4uLMAB/uLi4uLi4uLi4uLi4uDAAf4uLi4uLi4uLi4uLi4swAH+4uLi4uLi4uLi4uLi4MAB/i4uLi4uLi4uLi4uLizAAf7i4uLi4uLi4uLi4uLgwAH+Li4uLi4uLi4uLi4uLMAB/uLi4uLi4uLi4uLi4uDAAf4uLi4uLi4uLi4uLi4swAH+4uLi4uLi4uLi4uLi4MAB//////////////////wAAeIiIiIiIiIh3d3d3d3cAAAf7i4uLi4uHAAAAAAAAAAAAf7i4uLi4cAAAAAAAAAAAAAf/////9wAAAAAAAAAAAAAAd3d3d3AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////8AAAAOAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAADgAAAB8AAf//gAP//8AH///gD//////////////////8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHd3d3d3d3cAf7i4uLi4twB/i4uLi4uHAH+4uLi4uLcAf4uLi4uLhwB/uLi4uLi3AH+Li4uLi4cAf7i4uLi4twB////////3AHi4uLh3d3cAB4uLhwAAAAAAd3dwAAAAAAAAAAAAAAAA//8AAP//AACAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAMAAID/AADB/wAA//8AAABxAgAAAGx0AAA4BAAAAAABAAIAICAQAAAAAADoAgAAJgAAABAQEAAAAAAAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOzs7Ozs7Ozs7Ozs7OwAAA7Ozs7Ozs7Ozs7Ozs7AAAAs7Ozs7Ozs7Ozs7OzswAACzs7Ozs7Ozs7Ozs7OzCwAAOzs7Ozs7Ozs7Ozs7Ow8AA7Ozs7Ozs7Ozs7Ozs7ALAAs7Ozs7Ozs7Ozs7OzswDwCzs7Ozs7Ozs7Ozs7OzDwsAAAAAAAAAAAAAAAAAAA8PAAAAsP//AP//////////CwAAAPD//wD//////////w8AAACw//8A//////////8LAAAA8P//AP8AAAAAAAD/DwAAALD//wD//////////wsAAADw//8A//////////8PAAAAsP//8P//////////CwAAAPD///D/AAAAAAAA/w8AAACwAAAA//////////8LAAAA/7//sP//////////DwAAAA//v/D//////////wAAAAAAv/+w/wAAAAAAAP8AAAAAAAAAAP//////////AAAAAAAAAAD//////////wAAAAAAAAAA//////////8AAAAAAAAAAP//////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////////8AAAAPAAAADgAAAA4AAAAMAAAADAAAAAgAAAAIAAAAAAAAAAAAAAAPAAAADwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA/AAAA/4AAAP/8AAD//AAA//wAAP/8AAD//////////8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAs7Ozs7OzsAA7Ozs7OzsAA7Ozs7OzswALOzs7OzswAAAAAAAAAADwALDw////8LAA8PDwAADw8ACw8P////CwAPAA8AAA8PAAv7D////wsAAAAPAAAPAAAAAA////8AAAAAAAAAAAAAAAAAAAAAAA//8AAMAAAACAAAAAgAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAgAAAAIAAAACAAAAAwAAAAPgDAAD4AwAA//8AAGwgAwAAAGx0AAA2EAAAAAAAAAAAAAAAAAAAI38kLJGF0RGxagDA8Cg2KCFDNBIIAAAA7QMAAO0DAACAfuHmAAAGACQAAAAQABAAwMDAAP//AAAB782rAAAFAAAAAAAGAAAA/////wwAAIAAAAAABAAAAAAAAAAEAAAAAQAAAGx0AAA4BAAAAAABAAIAICAQAAAAAADoAgAAJgAAABAQEAAAAAAAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB3d3d3d3d3d3d3d3d3dzAAf7i4uLi4uLi4uLi4uLgwAH+Li4uLi4uLi4uLi4uLMAB/uLi4uLi4uLi4uLi4uDAAf4uLi4uLi4uLi4uLi4swAH+4uLi4uLi4uLi4uLi4MAB/i4uLi4uLi4uLi4uLizAAf7i4uLi4uLi4uLi4uLgwAH+Li4uLi4uLi4uLi4uLMAB/uLi4uLi4uLi4uLi4uDAAf4uLi4uLi4uLi4uLi4swAH+4uLi4uLi4uLi4uLi4MAB/i4uLi4uLi4uLi4uLizAAf7i4uLi4uLi4uLi4uLgwAH+Li4uLi4uLi4uLi4uLMAB/uLi4uLi4uLi4uLi4uDAAf4uLi4uLi4uLi4uLi4swAH+4uLi4uLi4uLi4uLi4MAB//////////////////wAAeIiIiIiIiIh3d3d3d3cAAAf7i4uLi4uHAAAAAAAAAAAAf7i4uLi4cAAAAAAAAAAAAAf/////9wAAAAAAAAAAAAAAd3d3d3AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////8AAAAOAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAADgAAAB8AAf//gAP//8AH///gD//////////////////8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHd3d3d3d3cAf7i4uLi4twB/i4uLi4uHAH+4uLi4uLcAf4uLi4uLhwB/uLi4uLi3AH+Li4uLi4cAf7i4uLi4twB////////3AHi4uLh3d3cAB4uLhwAAAAAAd3dwAAAAAAAAAAAAAAAA//8AAP//AACAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAMAAID/AADB/wAA//8AAABxAgAAAGx0AAA4BAAAAAABAAIAICAQAAAAAADoAgAAJgAAABAQEAAAAAAAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOzs7Ozs7Ozs7Ozs7OwAAA7Ozs7Ozs7Ozs7Ozs7AAAAs7Ozs7Ozs7Ozs7OzswAACzs7Ozs7Ozs7Ozs7OzCwAAOzs7Ozs7Ozs7Ozs7Ow8AA7Ozs7Ozs7Ozs7Ozs7ALAAs7Ozs7Ozs7Ozs7OzswDwCzs7Ozs7Ozs7Ozs7OzDwsAAAAAAAAAAAAAAAAAAA8PAAAAsP//AP//////////CwAAAPD//wD//////////w8AAACw//8A//////////8LAAAA8P//AP8AAAAAAAD/DwAAALD//wD//////////wsAAADw//8A//////////8PAAAAsP//8P//////////CwAAAPD///D/AAAAAAAA/w8AAACwAAAA//////////8LAAAA/7//sP//////////DwAAAA//v/D//////////wAAAAAAv/+w/wAAAAAAAP8AAAAAAAAAAP//////////AAAAAAAAAAD//////////wAAAAAAAAAA//////////8AAAAAAAAAAP//////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////////8AAAAPAAAADgAAAA4AAAAMAAAADAAAAAgAAAAIAAAAAAAAAAAAAAAPAAAADwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA/AAAA/4AAAP/8AAD//AAA//wAAP/8AAD//////////8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAs7Ozs7OzsAA7Ozs7OzsAA7Ozs7OzswALOzs7OzswAAAAAAAAAADwALDw////8LAA8PDwAADw8ACw8P////CwAPAA8AAA8PAAv7D////wsAAAAPAAAPAAAAAA////8AAAAAAAAAAAAAAAAAAAAAAA//8AAMAAAACAAAAAgAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAgAAAAIAAAACAAAAAwAAAAPgDAAD4AwAA//8AAGwgAwAAAGx0AAA2EAAAAAABAAIAEBAAAAAAAABoAwAAJgAAACAgAAAAAAAAqAwAAI4DAAAoAAAAEAAAACAAAAABABgAAAAAAEADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAAAAAAAAAAAAAAP//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwMDAAAAAAAAAAAAAAAAAAAAAgICAwMDAgIAAwMDA//8AwMDAgIAAwMDA//8AAAAAwMDAAAAAAAAAAAAAAP//AAAAgICA//8AwMDA//8AgICA//8AwMDAgIAAwMDAAAAAwMDAAAAAAAAAAAAAAAAAAAAAgICAwMDAgIAAwMDAgIAAwMDA//8AwMDA//8AAAAAwMDAAAAAAAAAAAAAAP//AAAAgICAgIAAwMDA//8AwMDAgIAAwMDAgIAAwMDAAAAAwMDAAAAAAAAAAAAAAAAAAAAAgICAwMDA//8AwMDAgIAA//////8AwMDAgIAAAAAAwMDAAAAAAAAAAAAAAP//AAAAgICA//8AgICA//8AwMDAgIAAwMDA//8AwMDAAAAAwMDAAAAAAAAAAAAAAAAAAAAAgICAwMDAAAAAAAAAAAAAAAAAAAAAAAAAgIAAAAAAwMDAAAAAAAAAAAAAAP//AAAAgICAgIAAAAAA////////////////AAAAwMDAAAAAwMDAAAAAAAAAAAAAAAAAAAAAgICAwMDAAAAAAAAAAAAAAAAAAAAAAAAA//8AAAAAwMDAAAAAAAAAAAAAAP//AAAAgICA//8AwMDAgIAAwMDA//8AwMDAgIAAwMDAAAAAwMDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////+AB//+AAf//wAH//4AB///AAf//gAH//8AB//+AAf//wAH//4AB///AAf//gAH//8AD/////////////ygAAAAgAAAAQAAAAAEAGAAAAAAAgAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAgIDAwMCAgADAwMD//wDAwMCAgADAwMD//wAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAACAgID//wDAwMD//wCAgID//wDAwMCAgADAwMAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAgIDAwMCAgADAwMCAgADAwMD//wDAwMD//wAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAACAgICAgADAwMD//wDAwMCAgADAwMCAgADAwMAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAgIDAwMD//wDAwMCAgAD//////wDAwMCAgAAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAACAgID//wCAgID//wDAwMCAgADAwMD//wDAwMAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAgIDAwMAAAAAAAAAAAAAAAAAAAAAAAACAgAAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAACAgICAgAAAAAD///////////////8AAADAwMAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAgIDAwMAAAAAAAAAAAAAAAAAAAAAAAAD//wAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAACAgID//wDAwMCAgADAwMD//wDAwMCAgADAwMAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD////////////////////////////////////////////////////////////gAf//gAH//8AB//+AAf//wAH//4AB///AAf//gAH//8AB//+AAf//wAH//4AB///AA////////////////////////////////////////////wQAAABsdAAA8AAAAEJN7gAAAAAAAAB2AAAAKAAAABAAAAAPAAAAAQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIAAAACAgACAAAAAgACAAICAAACAgIAAwMDAAAAA/wAA/wAAAP//AP8AAAD/AP8A//8AAP///wCIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIRERESIiIiIhERERIiIiIiEREREiIiIiIRE9ESIiIiIhET0RIiIiIiEREREiIiIiIhIiEiIiIiIiEg=" />

	ADD OBJECT 'OleTreeView' AS olecontrol WITH ;
		Enabled = .T., ;
		Height = 213, ;
		Left = 14, ;
		Name = "OleTreeView", ;
		TabIndex = 17, ;
		Top = 107, ;
		Width = 286, ;
		ZOrderSet = 26
		*< END OBJECT: BaseClass="olecontrol"  Nombre="imprimir.OleTreeView" Parent="imprimir" ObjName="OleTreeView" OLEObject="C:\Windows\system32\MSCOMCTL.OCX" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMB8+bX/G84BAwAAAAADAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAigAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAJsBAAAAAAAACAAAAAIAAAD+////BAAAAAUAAAAGAAAABwAAAAkAAAAKAAAACwAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+2kEHHiYXREbFqAMDwKDYoIUM0EggAAACPHQAABBYAALE8wWoBAAYAIgAAAB0BAADtAwAACgAAAAEAAAAB782rXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACADgAAAEhpZGVTZWxlY3Rpb24ABQAAAEwAAAAADAAAAEluZGVudGF0aW9uABEAAABODQAAAAcAAAAAAAAAAABDQAoAAABMaW5lU3R5bGUACQAAAEkKAAAAAQAAAA0AAABNb3VzZVBvaW50ZXIACQAAAEkKAAAAAAAAAA4AAABQYXRoU2VwYXJhdG9yAAoAAABIAAAAAAEAAABcBwAAAFNvcnRlZAAFAAAATAEAAAAMAAAAT0xFRHJhZ01vZGUACQAAAEkKAAAAAAAAAAwAAABPTEVEcm9wTW9kZQAJAAAASQoAAAAAAAAACwAAAEFwcGVhcmFuY2UACQAAAEkKAAAAAQAAAAwAAABCb3JkZXJTdHlsZQAJAAAASQoAAAABAAAACwAAAENoZWNrYm94ZXMABQAAAEwAAAAADgAAAAAABQCgtS4ABwAAAAAAAAAFAACAzL8SAAEAAABcAB/e7L0BAAUAFcASAANS4wuRj84RneMAqgBLuFEBAAAAkAFGdWxsUm93U2VsZWN0AAUAAABMAQAAAAwAAABIb3RUcmFja2luZwAFAAAATAAAAAAHAAAAU2Nyb2xsAAUAAABMkF8BAAVBcmlhbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAKAAAAU2luZ2xlU2VsAAUAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAoAQAADgMAACgAAAAgAAAAQAAAAAEABAAAAAAAgAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAgICAAMDAwAAAAP8AAP8AAAD//wD/AAAA/wD/AP//AAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADu7u7oiIAAAAAAAAAAAAAA7u7u6IiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////iAAAAAAAAAAAAAAA//////iAAAAAAAAAAAAAAP/////4gAAAAAAA" />

	ADD OBJECT 'Shape1' AS shape WITH ;
		BackStyle = 0, ;
		Height = 59, ;
		Left = 12, ;
		Name = "Shape1", ;
		SpecialEffect = 0, ;
		Top = 387, ;
		Width = 294, ;
		ZOrderSet = 5
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape2' AS shape WITH ;
		BackStyle = 0, ;
		Height = 47, ;
		Left = 7, ;
		Name = "Shape2", ;
		SpecialEffect = 0, ;
		Top = 9, ;
		Width = 301, ;
		ZOrderSet = 2
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Tipo' AS tscombobox WITH ;
		BoundColumn = 2, ;
		ColumnCount = 2, ;
		ColumnWidths = "250,20", ;
		editable = .F., ;
		FirstElement = 1, ;
		Height = 24, ;
		Left = 15, ;
		Name = "Tipo", ;
		NumberOfElements = 0, ;
		RowSource = "Tablas de Visual FoxPro (DBF),DBF,Planilla electronica de Microsoft Excel (XLS),XLS,Tabla Dinamica de Microsoft Excel (XLS),TLS,Archivo de texto,SDF,Hechauka,XXX", ;
		RowSourceType = 1, ;
		Style = 2, ;
		TabIndex = 9, ;
		Top = 344, ;
		Value = ('XLS'), ;
		Width = 234, ;
		ZOrderSet = 12
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'Ts3dshape3' AS ts3dshape WITH ;
		Height = 44, ;
		Left = 7, ;
		Name = "Ts3dshape3", ;
		Top = 334, ;
		Width = 582, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="shape" />
	
	PROCEDURE exportarpivot
		PARAMETER LCSQL
		LCCONEXION = "ODBC;"+LEERINI("DEFAULT", "ODBC")
		AA = CREATEOBJECT("excel.application")
		AA.WORKBOOKS.ADD()
		PT = AA.ACTIVEWORKBOOK.PIVOTCACHES.ADD(2)
		PT.CONNECTION = LCCONEXION
		PT.COMMANDTYPE = 2
		PT.COMMANDTEXT = LCSQL
		PT.CREATEPIVOTTABLE(AA.ACTIVECELL, "Tabla Dinamica1",  , 1)
		AA.VISIBLE = .T.
	ENDPROC

	PROCEDURE exportarxls
		PARAMETER LCSQL
		LCCONEXION = "ODBC;"+LEERINI("DEFAULT", "ODBC")
		AA = CREATEOBJECT("excel.application")
		AA.WORKBOOKS.ADD()
		QT = AA.ACTIVESHEET.QUERYTABLES.ADD(LCCONEXION, AA.ACTIVECELL)
		QT.COMMANDTEXT = LCSQL
		QT.NAME = "Consulta desde Futura Software"
		QT.FIELDNAMES = .T.
		QT.REFRESH()
		AA.VISIBLE = .T.
	ENDPROC

	PROCEDURE filtrar
		SELECT CONTROL
		SET FILTER TO UPPER(ALLTRIM(exportar.PARAM1))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(exportar.PARAM2))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(exportar.PARAM3))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(exportar.PARAM4))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(exportar.PARAM5))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(exportar.PARAM6))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(exportar.PARAM7))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(exportar.PARAM8))==UPPER(ALLTRIM(CONTROL.VARIABLE)) 
		SELECT exportar
		GOTO TOP IN CONTROL
		*SET STEP ON
		FOR X = 1 TO 6
			OBJETO = 'caja'+ALLTRIM(STR(X))
			IF  .NOT. EOF('control')
		
				THIS.&OBJETO..VISIBLE=.T.
				THIS.&OBJETO..ETIQ.CAPTION=ALLTRIM(CONTROL.ETIQUETA)
				VALOR = CONTROL.VALUE
				VARIABLE = CONTROL.VARIABLE
				THIS.&OBJETO..REQUERY=CONTROL.REQUERY
		
				IF CONTROL.TIPO="L"
		
					VRSOURCE = CONTROL.RSOURCE
					IF CONTROL.ORIGEN='R'
						THIS.&OBJETO..LISTA.CMDSQL=VRSOURCE
						THIS.&OBJETO..LISTA.CURSOR=THIS.&OBJETO..NAME
						THIS.&OBJETO..LISTA.INIT()
					ELSE
						THIS.&OBJETO..LISTA.ROWSOURCE=""
						THIS.&OBJETO..LISTA.ROWSOURCETYPE=CONTROL.RSOURCETYP
						THIS.&OBJETO..LISTA.ROWSOURCE=VRSOURCE
						IF  .NOT. EMPTY(CONTROL.BOUNDCOL)
							THIS.&OBJETO..LISTA.BOUNDCOLUMN=CONTROL.BOUNDCOL
						ELSE
							THIS.&OBJETO..LISTA.BOUNDCOLUMN=1
						ENDIF
					ENDIF
					THIS.&OBJETO..LISTA.STYLE=CONTROL.STYLE
					THIS.&OBJETO..LISTA.VISIBLE=.T.
					THIS.&OBJETO..TEXTO.VISIBLE=.F.
					IF TYPE(VARIABLE)<>"U"
						THIS.&OBJETO..LISTA.VALUE = &VARIABLE
					ELSE
						THIS.&OBJETO..LISTA.VALUE=&VALOR
					ENDIF
				ELSE
					THIS.&OBJETO..TEXTO.INPUTMASK=ALLTRIM(CONTROL.INPUTMASK)
					THIS.&OBJETO..TEXTO.MAXLENGTH=CONTROL.MAXLENGTH
					IF TYPE(VARIABLE)<>"U"
						THIS.&OBJETO..TEXTO.VALUE = &VARIABLE
					ELSE
						THIS.&OBJETO..TEXTO.VALUE=&VALOR
					ENDIF
					THIS.&OBJETO..LISTA.VISIBLE=.F.
					THIS.&OBJETO..TEXTO.VISIBLE=.T.
				ENDIF
				THIS.&OBJETO..TEXTO.STATUSBARTEXT = ''
				IF  .NOT. EMPTY(CONTROL.DATOAYUDA)
					THIS.&OBJETO..TEXTO.DATOAYUDA = CONTROL.DATOAYUDA
					THIS.&OBJETO..TEXTO.INIT()
				ELSE
					THIS.&OBJETO..TEXTO.DATOAYUDA = ''
					THIS.&OBJETO..TEXTO.STATUSBARTEXT = THIS.&OBJETO..ETIQ.CAPTION
					THIS.&OBJETO..TEXTO.INIT()
				ENDIF
				THIS.&OBJETO..NOMBVAR=VARIABLE
				IF TYPE(VARIABLE)="U"
					PUBLIC &VARIABLE
					&VARIABLE = &VALOR
				ENDIF
				SKIP IN CONTROL
			ELSE
				THIS.&OBJETO..VISIBLE=.F.
			ENDIF
		ENDFOR
		
	ENDPROC

	PROCEDURE generardbf
		Local DESTINO, PROCEDIMIENTO, EXP_DEST
		PROCEDIMIENTO = EXPORTAR.ORIGEN
		CMDSQL = Execscript(PROCEDIMIENTO)
		EXP_DEST = EXPORTAR.DESTINO
		If  .Not. Empty(used(EXP_DEST))
			Select (EXP_DEST)
		ENDIF
	ENDPROC

	PROCEDURE hechauka
		*SET STEP ON
		PROCEDIMIENTO = EXPORTAR.ORIGEN
		m.CMDSQL = Execscript(PROCEDIMIENTO)
		
		DO case 
		
		CASE exportar.key="13_" OR exportar.key="18_" 	&&Compras Hechauka
			this.hechaukacompra()
		CASE exportar.key="12_"	OR exportar.key="19_"	&&Ventas Hechauka
			this.hechaukaventa()	
		OTHERWISE
		
			=Messagebox('Formato no implementado.',64,"Futura Software")
		
		ENDCASE
		
		RETURN
	ENDPROC

	PROCEDURE hechaukacompra
		CREATE CURSOR dd(Tipo n(1),RUC c(15), DV n(1),Proveedor c(80),Timbrado c(20),TipoDoc n(2),Numero C(20),Fecha c(10),G10 n(20),I10 n(20),G5 n(20),I5 n(20),E n(20),Operacion n(2))
		EXP_DEST = EXPORTAR.DESTINO
		SET STEP ON
		SELECT (EXP_DEST)
		m.Total=0
		SCAN
		
			m.Total = m.Total + ABS(ROUND(NVL(cResultado.Gravadas10,0),0)+ROUND(NVL(cResultado.Gravadas5,0),0)+ROUND(NVL(cResultado.Exentas,0),0))
							
			IF RAT('-',NVL(cResultado.Ruc,''))>0
				m.Ruc=SUBSTR(NVL(cResultado.Ruc,''),1,RAT('-',NVL(cResultado.Ruc,''))-1)
				m.DV=VAL(SUBSTR(NVL(cResultado.Ruc,''),RAT('-',NVL(cResultado.Ruc,''))+1))
			ELSE
				m.Ruc=NVL(cResultado.Ruc,'')
				m.DV=0
			ENDIF
		*!*		DO CASE 
		*!*		CASE INLIST(IdComprobante,'CO','CR')
		*!*			m.Tipo=1
		*!*		CASE INLIST(IdComprobante,'NC')
		*!*			m.Tipo=2
		*!*		CASE INLIST(IdComprobante,'ND')
		*!*			m.Tipo=3
		*!*		CASE INLIST(IdComprobante,'DE')
		*!*			m.Tipo=4
		*!*		CASE INLIST(IdComprobante,'FC')
		*!*			m.Tipo=5
		*!*		OTHERWISE
		*!*			m.Tipo=0
		*!*		ENDCASE
		m.Tipo=TipoDocHK
			
			*Verificamos proveedores del exterior
			IF m.Ruc='99999901'
				m.Proveedor='Proveedores del Exterior'
			ELSE
				m.Proveedor=NVL(cResultado.Proveedor,'')	
			ENDIF
			
			*Verificamos la operacion
			DO CASE 
			CASE Tipo='D'
				m.Operacion=2
			CASE Tipo='I'
				m.Operacion=4
			CASE Tipo='E'
				m.Operacion=1
			OTHERWISE 
				m.Operacion=0
			ENDCASE 	
		
			m.Operacion=0
		
			*Si es nota de credito se debe cambiar la operacion
			IF INLIST(IdComprobante,'NC','ND')
				m.operacion =3
			ENDIF
		
			
			INSERT INTO dd(Tipo,RUC,DV,Proveedor,Timbrado,TipoDoc,numero,Fecha,G10,i10,g5,i5,E,Operacion) ;
					VALUES (2,m.Ruc,m.DV,m.Proveedor,NVL(cResultado.Timbrado,'0'),m.Tipo,cResultado.FacturaProveedor,;
							cResultado.Fecha,ABS(NVL(cResultado.Gravadas10,0)),ABS(NVL(cResultado.Iva10,0)),ABS(NVL(cResultado.Gravadas5,0)),;
							ABS(NVL(cResultado.Iva5,0)),ABS(NVL(cResultado.Exentas,0)),m.Operacion)
			SELECT (EXP_DEST)					
		ENDSCAN
		
		CREATE CURSOR cc(Tipo n(1),Periodo c(6),TipoReporte n(2),TipoInfo n(3),CodigoForm n(3),RUCAgente c(15),;
							DVAgente n(1),NombreAgente c(80),RUCRep c(15), DVRep n(1),NombreRep c(80),Cantidad n(5),Total n(20),Exportador c(2))
		
		this.runsql("Select * from empresa where IdEmpresa=?oApp.Empresa",'cEmpresa')
		
			m.RucAgente=SUBSTR(NVL(cEmpresa.Ruc,''),1,RAT('-',NVL(cEmpresa.Ruc,''))-1)
			m.DVAgente=VAL(SUBSTR(NVL(cEmpresa.Ruc,''),RAT('-',NVL(cEmpresa.Ruc,''))+1))
		
			m.RucRep=SUBSTR(NVL(cEmpresa.RucRepresLegal,''),1,RAT('-',NVL(cEmpresa.RucRepresLegal,''))-1)
			m.DVrep=VAL(SUBSTR(NVL(cEmpresa.RucRepresLegal,''),RAT('-',NVL(cEmpresa.RucRepresLegal,''))+1))
			m.periodo=ALLTRIM(STR(YEAR(dfecha))) + RIGHT('0'+ALLTRIM(STR(month(dfecha))),2)
				
		INSERT INTO cc(Tipo, Periodo, TipoReporte, TipoInfo, CodigoForm, RUCAgente,;
							DVAgente, NombreAgente, RUCRep, DVRep, NombreRep, Cantidad, Total,Exportador);
			Values(1,m.periodo,1,911,211,m.RucAgente,m.DVAgente,cEmpresa.razón, m.RucRep,m.DVRep,cEmpresa.RepresLegal,RECCOUNT('cResultado'),m.Total,'NO')				
		*SET STEP ON
		SELECT cc
		tmpcc=SYS(2023)+'\Cab.txt'
		
		Copy To tmpcc.txt DELIMITED WITH "" WITH CHARACTER |
		
		
		SELECT dd 
		*BROWSE
		tmpDet=SYS(2023)+'\Det.txt'
		
		Copy To tmpDet.txt DELIMITED WITH "" WITH CHARACTER |
		
		CREATE CURSOR tt(Final m)
		SELECT tt
		APPEND BLANK 
		APPEND MEMO final FROM tmpcc.txt OVERWRITE  
		APPEND MEMO final FROM tmpdet.txt  
		DELETE FILE tmpcc.txt
		DELETE FILE tmpDet.txt
		replace final WITH STRTRAN(final,"|",CHR(9))
		
		DESTINO = '"'+Thisform.DESTINO.Value+'"'
		Copy MEMO final To  &DESTINO Type Sdf
		=Messagebox('El archivo TXT fue creado en &destino',64,"Futura Software")
	ENDPROC

	PROCEDURE hechaukaventa
		CREATE CURSOR dd(Tipo n(1),RUC c(15), DV n(1),Proveedor c(80),TipoDoc n(2),Numero C(20),Fecha c(10),G10 n(20),I10 n(20),G5 n(20),I5 n(20),E n(20),Total n(20))
		EXP_DEST = EXPORTAR.DESTINO
		
		SELECT (EXP_DEST)
		*BROW
		m.Total=0
		
		m.G1088=0
		m.i1088=0
		m.g588=0
		m.i588=0
		m.E88=0
		m.Total88=0
		
		m.G1077=0
		m.i1077=0
		m.g577=0
		m.i577=0
		m.E77=0
		m.Total77=0
		
		m.G1044=0
		m.i1044=0
		m.g544=0
		m.i544=0
		m.E44=0
		m.Total44=0
		SCAN
		
			m.Total = m.Total + ABS(ROUND(NVL(cResultado.Gravadas10,0),0)+ROUND(NVL(cResultado.Iva10,0),0)+ROUND(NVL(cResultado.Gravadas5,0),0)+ROUND(NVL(cResultado.Iva5,0),0)+ROUND(NVL(cResultado.Exentas,0),0))
			m.TotalLinea= ABS(ROUND(NVL(cResultado.Gravadas10,0),0)+ROUND(NVL(cResultado.Iva10,0),0)+ROUND(NVL(cResultado.Gravadas5,0),0)+ROUND(NVL(cResultado.Iva5,0),0)+ROUND(NVL(cResultado.Exentas,0),0))			
			IF RAT('-',NVL(cResultado.Ruc,''))>0
				m.Ruc=SUBSTR(NVL(cResultado.Ruc,''),1,RAT('-',NVL(cResultado.Ruc,''))-1)
				m.DV=VAL(SUBSTR(NVL(cResultado.Ruc,''),RAT('-',NVL(cResultado.Ruc,''))+1))
			ELSE
				m.Ruc=NVL(cResultado.Ruc,'')
				m.DV=0
			ENDIF
			
		m.Tipo=TipoDocHK	
		*!*		DO CASE 
		*!*		CASE INLIST(IdComprobante,'CO','CR')
		*!*			m.Tipo=1
		*!*		CASE INLIST(IdComprobante,'NC')
		*!*			m.Tipo=2
		*!*		CASE INLIST(IdComprobante,'ND')
		*!*			m.Tipo=3
		*!*		CASE INLIST(IdComprobante,'BV')
		*!*			m.Tipo=6
		*!*		OTHERWISE
		*!*			m.Tipo=0
		*!*		ENDCASE
			
			*Verificamos proveedores del exterior
			DO case
			CASE m.Ruc='88888801'
				m.Proveedor='Clientes del Exterior'
			CASE m.Ruc='44444401'
				m.Proveedor='Importes Consolidados'
			CASE m.Ruc='77777701'
				m.Proveedor='Ventas a Agentes Diplomáticos'
			OTHERWISE 
				m.proveedor = cResultado.RazSocial
			ENDCASE 
				
		*	m.Numero = NVL(NroSucursal,'')+'-'+NVL(NroCondicion,'') + '-' + ALLTRIM(STR(cResultado.Numero))
			m.Numero = cResultado.Numero	
			*Acumulamos el ruc 88
			IF m.Ruc='88888801'
				m.Proveedor88=m.Proveedor
				m.TipoDoc88=m.Tipo
				m.numero88=m.numero
				m.Fecha88=cResultado.Fecha
				m.G1088=m.G1088+ABS(NVL(cResultado.Gravadas10,0))
				m.i1088=m.i1088+ABS(NVL(cResultado.Iva10,0))
				m.g588=m.g588+ABS(NVL(cResultado.Gravadas5,0))
				m.i588=m.i588+ABS(NVL(cResultado.Iva5,0))
				m.E88=m.E88+ABS(NVL(cResultado.Exentas,0))
				m.Total88=m.Total88+m.TotalLinea
			ENDIF
			
		*Acumulamos el ruc 77
			IF m.Ruc='77777701'
				m.Proveedor77=m.Proveedor
				m.TipoDoc77=m.Tipo
				m.numero77=m.numero
				m.Fecha77=cResultado.Fecha
				m.G1077=m.G1077+ABS(NVL(cResultado.Gravadas10,0))
				m.i1077=m.i1077+ABS(NVL(cResultado.Iva10,0))
				m.g577=m.g577+ABS(NVL(cResultado.Gravadas5,0))
				m.i577=m.i577+ABS(NVL(cResultado.Iva5,0))
				m.E77=m.E77+ABS(NVL(cResultado.Exentas,0))
				m.Total77=m.Total77+m.TotalLinea
			ENDIF
		*Acumulamos el ruc 44
			IF m.Ruc='44444401'
				m.Proveedor44=m.Proveedor
				m.TipoDoc44=m.Tipo
				m.numero44=m.numero
				m.Fecha44=cResultado.Fecha
				m.G1044=m.G1044+ABS(NVL(cResultado.Gravadas10,0))
				m.i1044=m.i1044+ABS(NVL(cResultado.Iva10,0))
				m.g544=m.g544+ABS(NVL(cResultado.Gravadas5,0))
				m.i544=m.i544+ABS(NVL(cResultado.Iva5,0))
				m.E44=m.E44+ABS(NVL(cResultado.Exentas,0))
				m.Total44=m.Total44+m.TotalLinea
			ENDIF		
			
				
			IF NOT INLIST(m.ruc,'44444401',	'77777701', '88888801')
				INSERT INTO dd(Tipo,RUC,DV,Proveedor,TipoDoc,numero,Fecha,G10,i10,g5,i5,E,Total) ;
					VALUES (2,m.Ruc,m.DV,m.Proveedor,m.Tipo,m.numero,;
							cResultado.Fecha,ABS(NVL(cResultado.Gravadas10,0)),ABS(NVL(cResultado.Iva10,0)),ABS(NVL(cResultado.Gravadas5,0)),;
							ABS(NVL(cResultado.Iva5,0)),ABS(NVL(cResultado.Exentas,0)),m.TotalLinea)
			ENDIF
							
		ENDSCAN
		
		IF m.total44>0
				INSERT INTO dd(Tipo,RUC,DV,Proveedor,TipoDoc,numero,Fecha,G10,i10,g5,i5,E,Total) ;
					VALUES (2,'44444401',7,m.Proveedor44,m.Tipodoc44,m.numero44,;
							m.Fecha44,m.G1044,m.i1044,m.g544,m.i544,m.E44,m.Total44)
		ENDIF
		
		IF m.total77>0
				INSERT INTO dd(Tipo,RUC,DV,Proveedor,TipoDoc,numero,Fecha,G10,i10,g5,i5,E,Total) ;
					VALUES (2,'77777701',0,m.Proveedor77,m.Tipodoc77,m.numero77,;
							m.Fecha77,m.G1077,m.i1077,m.g577,m.i577,m.E77,m.Total77)
		ENDIF
		
		IF m.total88>0
				INSERT INTO dd(Tipo,RUC,DV,Proveedor,TipoDoc,numero,Fecha,G10,i10,g5,i5,E,Total) ;
					VALUES (2,'88888801',5,m.Proveedor88,m.Tipodoc88,m.numero88,;
							m.Fecha88,m.G1088,m.i1088,m.g588,m.i588,m.E88,m.Total88)
		ENDIF
		
		
		
		CREATE CURSOR cc(Tipo n(1),Periodo c(6),TipoReporte n(2),TipoInfo n(3),CodigoForm n(3),RUCAgente c(15),;
							DVAgente n(1),NombreAgente c(80),RUCRep c(15), DVRep n(1),NombreRep c(80),Cantidad n(5),Total n(20))
		
		this.runsql("Select * from empresa where IdEmpresa=?oApp.Empresa",'cEmpresa')
		
			m.RucAgente=SUBSTR(NVL(cEmpresa.Ruc,''),1,RAT('-',NVL(cEmpresa.Ruc,''))-1)
			m.DVAgente=VAL(SUBSTR(NVL(cEmpresa.Ruc,''),RAT('-',NVL(cEmpresa.Ruc,''))+1))
		
			m.RucRep=SUBSTR(NVL(cEmpresa.RucRepresLegal,''),1,RAT('-',NVL(cEmpresa.RucRepresLegal,''))-1)
			m.DVrep=VAL(SUBSTR(NVL(cEmpresa.RucRepresLegal,''),RAT('-',NVL(cEmpresa.RucRepresLegal,''))+1))
			m.periodo=ALLTRIM(STR(YEAR(dfecha))) + RIGHT('0'+ALLTRIM(STR(month(dfecha))),2)
				
		INSERT INTO cc(Tipo, Periodo, TipoReporte, TipoInfo, CodigoForm, RUCAgente,;
							DVAgente, NombreAgente, RUCRep, DVRep, NombreRep, Cantidad, Total);
			Values(1,m.periodo,1,921,221,m.RucAgente,m.DVAgente,cEmpresa.razón, m.RucRep,m.DVRep,cEmpresa.RepresLegal,RECCOUNT('dd'),m.Total)				
		*SET STEP ON
		SELECT cc
		tmpcc=SYS(2023)+'\Cab.txt'
		
		Copy To tmpcc.txt DELIMITED WITH "" WITH CHARACTER |
		
		
		SELECT dd 
		*BROWSE
		tmpDet=SYS(2023)+'\Det.txt'
		
		Copy To tmpDet1.txt DELIMITED WITH "" WITH CHARACTER |
		
		CREATE CURSOR tt(Final m)
		SELECT tt
		APPEND BLANK 
		APPEND MEMO final FROM tmpcc.txt OVERWRITE  
		APPEND MEMO final FROM tmpdet1.txt  
		DELETE FILE tmpcc.txt
		DELETE FILE tmpDet1.txt
		replace final WITH STRTRAN(final,"|",CHR(9))
		
		DESTINO = '"'+Thisform.DESTINO.Value+'"'
		Copy MEMO final To  &DESTINO Type Sdf
		=Messagebox('El archivo TXT fue creado en &destino',64,"Futura Software")
		RETURN 
		
		
		TEXT TO cmdSQL1 noshow
		SELECT     c.Numero, convert(varchar(10),c.Fecha,103) Fecha, c.Exenta* c.cotizacion as Exentas, c.Gravada, c.Iva, total = c.TotalFactura, p.RazSocial, p.Ruc, 
		                      SUM(CASE WHEN d.iva = 5 THEN ISNULL(d.precio * cantidad* c.cotizacion, 0) ELSE 0 END) AS gravadas5, 
		                      SUM(CASE WHEN d.Iva = 10 THEN ISNULL(d.precio * cantidad* c.cotizacion, 0) ELSE 0 END) AS gravadas10, 
		                      SUM(CASE WHEN TIPOAplica = 'M' THEN ISNULL(c.gravada* c.cotizacion, 0) ELSE 0 END) AS imponible, 
		                      SUM(CASE WHEN d.iva = 5 THEN ISNULL(d.Valoriva* c.cotizacion, 0) ELSE 0 END) AS iva5, 
		                      SUM(CASE WHEN d.Iva = 10 THEN ISNULL(d.Valoriva* c.cotizacion, 0) ELSE 0 END) AS iva10,
		                      c.Sucursal + s.Descripción AS Sucursal,
		                      c.IdComprobante +'-' + vt_cpbt.Descripcion as Comprobante
		FROM         vt_factura AS c INNER JOIN
		                      st_movimiento_Det AS d ON c.IdFactura = d.IdFactura INNER JOIN
		                      vt_clientes AS p ON c.IdEmpresa = p.IdEmpresa AND c.IdCliente = p.IdCliente INNER JOIN
		                      sucursal AS s ON c.IdEmpresa = s.IdEmpresa AND c.Sucursal = s.Sucursal INNER JOIN
		                      vt_cpbt ON c.IdEmpresa = vt_cpbt.IdEmpresa AND c.IdComprobante = vt_cpbt.IdComprobante
		WHERE c.idempresa = ?oApp.Empresa  
		        and   c.fecha between ?m.dFecha and ?m.hFecha
			  GROUP BY c.Numero, c.Fecha, c.Exenta, c.Gravada, c.Iva, c.TotalFactura, p.RazSocial, p.Ruc, c.Sucursal + s.Descripción, c.Cotizacion,
			  c.IdComprobante, vt_cpbt.Descripcion
		 ORDER BY c.Sucursal + s.Descripción,c.IdComprobante, <<m.orden>>
		
		ENDTEXT
	ENDPROC

	PROCEDURE Init
		PARAMETER MGRUPO
		LOCAL FILTRO
		THISFORM.TIPO.VALUE = 'XLS'
		IF PARAMETERS()>0
		FILTRO = "FOR UPPER(GRUPO)=UPPER(mGrupo)"
		ELSE
		FILTRO = " "
		ENDIF
		DO SETEO
		IF TYPE("THIS.oleTreeview")<>"O" .OR. ISNULL(THIS.OLETREEVIEW)
		RETURN .F.
		ENDIF
		IF TYPE("THIS.oleImagesList")<>"O" .OR. ISNULL(THIS.OLEIMAGESLIST)
		RETURN .F.
		ENDIF
		THISFORM.OLETREEVIEW.DOVERB(-1)
		THIS.OLETREEVIEW.IMAGELIST = THIS.OLEIMAGESLIST
		O = THISFORM.OLETREEVIEW.NODES
		O.CLEAR
		SCAN &FILTRO
		IF IDOBJETO<>0
		REPLACE DISPONIBLE WITH OAPP.PERMISOS(IDOBJETO)
		ENDIF
		IF LCAGRUPACION='C'
		IF ALLTRIM(PARENT)='0_'
		O.ADD( , 1, ALLTRIM(KEY), ALLTRIM(TEXT), 1, 2)
		ELSE
		IF DISPONIBLE
		IF EMPTY(ORIGEN)
		O.ADD(ALLTRIM(PARENT), 4, ALLTRIM(KEY), ALLTRIM(TEXT), 1, 2)
		ELSE
		O.ADD(ALLTRIM(PARENT), 4, ALLTRIM(KEY), ALLTRIM(TEXT), 3, 3)
		ENDIF
		ELSE
		O.ADD(ALLTRIM(PARENT), 4, ALLTRIM(KEY), ALLTRIM(TEXT), 4, 4)
		ENDIF
		ENDIF
		ELSE
		IF DISPONIBLE
		O.ADD( , 1, ALLTRIM(KEY), ALLTRIM(TEXT), 3, 3)
		ELSE
		O.ADD( , 1, ALLTRIM(KEY), ALLTRIM(TEXT), 4, 4)
		ENDIF
		ENDIF
		ENDSCAN
		THISFORM.OLETREEVIEW.FONT.SIZE = 8
		THISFORM.OLETREEVIEW.LABELEDIT = 1
		THISFORM.OLETREEVIEW.LINESTYLE = 1
		THISFORM.OLETREEVIEW.SORTED = .T.
		PUBLIC CDOSNAME
		M.CDOSNAME = ' '
		THISFORM.REFRESH()
		THIS.FILTRAR()
		DEFINE WINDOW RESULTADO FROM 2, 1 TO 13, 75 GROW FLOAT CLOSE ZOOM TITLE 'Resultado'
	ENDPROC

	PROCEDURE Load
		DO SETEO
		USE SHARED datos!exportar ORDER key IN 0
		USE SHARED datos!control IN 0
		SELECT EXPORTAR
		CURSORSETPROP("Buffering", 5)
	ENDPROC

	PROCEDURE Release
		FOR X = 1 TO 6
		OBJETO = 'caja'+ALLTRIM(STR(X))
		IF THISFORM.&OBJETO..VISIBLE
		VARIABLE=THISFORM.&OBJETO..NOMBVAR
		RELEASE &VARIABLE
		ENDIF
		ENDFOR
		SELECT EXPORTAR
		= TABLEREVERT(.T.)
		RELEASE CDOSNAME
	ENDPROC

	PROCEDURE Agrupar.Init
		PUBLIC LCAGRUPACION
		LCAGRUPACION = 'C'
	ENDPROC

	PROCEDURE Agrupar.InteractiveChange
		SELECT EXPORTAR
		DO CASE
		CASE THIS.VALUE=1
		LCAGRUPACION = 'C'
		SET FILTER TO
		CASE THIS.VALUE=2
		LCAGRUPACION = 'A'
		SET FILTER TO PARENT<>'0_'
		ENDCASE
		THISFORM.INIT()
	ENDPROC

	PROCEDURE Command1.Click
		THISFORM.RELEASE()
	ENDPROC

	PROCEDURE Command1.DragDrop
		LPARAMETERS OSOURCE, NXCOORD, NYCOORD
		THIS.SHOWWHATSTHIS
	ENDPROC

	PROCEDURE Command2.Click
		IF EMPTY(EXPORTAR.NOMBRE)
		CARCHIVO = ALLTRIM(THISFORM.TAG)+'\'+'exporta'+'_'+EXPORTAR.TEXT
		ELSE
		CARCHIVO = ALLTRIM(THISFORM.TAG)+'\'+EVALUATE(EXPORTAR.NOMBRE)
		ENDIF
		DO CASE
		CASE THISFORM.TIPO.VALUE='DBF'
		M.ARCHIVO = PUTFILE('Exportar:', CARCHIVO, 'DBF')
		CASE THISFORM.TIPO.VALUE='XLS'
		M.ARCHIVO = PUTFILE('Exportar:', CARCHIVO, 'XLS')
		CASE THISFORM.TIPO.VALUE='SDF'
		M.ARCHIVO = PUTFILE('Exportar:', CARCHIVO, 'SDF')
		ENDCASE
		IF  .NOT. EMPTY(M.ARCHIVO)
		THISFORM.DESTINO.VALUE = M.ARCHIVO
		ENDIF
	ENDPROC

	PROCEDURE descrip.Init
		THIS.CAPTION = ''
	ENDPROC

	PROCEDURE ejecutar.Click
		Thisform.CAJA1.LostFocus()
		Thisform.CAJA2.LostFocus()
		Thisform.CAJA3.LostFocus()
		Thisform.CAJA4.LostFocus()
		Thisform.CAJA5.LostFocus()
		Thisform.CAJA6.LostFocus()
		Local DESTINO, PROCEDIMIENTO, EXP_DEST
		*PROCEDIMIENTO = EXPORTAR.ORIGEN
		*CMDSQL = Execscript(PROCEDIMIENTO)
		*EXP_DEST = EXPORTAR.DESTINO
		*If  .Not. Empty(used(EXP_DEST))
		*	Select (EXP_DEST)
		*	If Reccount(EXP_DEST)>0
				*DESTINO = '"'+Thisform.DESTINO.Value+'"'
			    DESTINO = Thisform.DESTINO.Value
				Do Case
				Case Thisform.TIPO.Value='DBF'
					thisform.generardbf()
					Copy To  &DESTINO
					=Messagebox('El archivo dbf fue creado en &destino',64,"Futura Software")
				Case Thisform.TIPO.Value='XLS'
					Thisform.EXPORTARXLS(TEXTMERGE(EXPORTAR.CMDSQL))
				Case Thisform.TIPO.Value='TLS'
					Thisform.EXPORTARPIVOT(TEXTMERGE(EXPORTAR.CMDSQL))
				Case Thisform.TIPO.Value='SDF'
					thisform.generardbf()
					Destino=Destino+".CSV"
					Copy To  (DESTINO) DELIMITED WITH " WITH CHARACTER ';'
					=Messagebox('El archivo CSV fue creado en &destino',64,"Futura Software")
				Case Thisform.TIPO.Value='TAB'
					Copy To  &DESTINO  Delimited With Chr(9)
					=Messagebox('El archivo TXT fue creado en &destino',64,"Futura Software")
				Case Thisform.TIPO.Value='XXX'
					Thisform.Hechauka()			
				Endcase
		*	Else
		*		= Messagebox('No se ha encontrado ningún resultado para exportar.', 64, "Futura Software")
		*	Endif
		*Endif
		Thisform.CAJA1.LostFocus()
		Thisform.CAJA2.LostFocus()
		Thisform.CAJA3.LostFocus()
		Thisform.CAJA4.LostFocus()
		Thisform.CAJA5.LostFocus()
		Thisform.CAJA6.LostFocus()
		EMPRESA = OAPP.NOMBREEMPRESA
	ENDPROC

	PROCEDURE OleTreeView.NodeClick
		Lparameters Node
		Select EXPORTAR
		= Seek(Node.Key)
		If EXPORTAR.DISPONIBLE
			Thisform.Descrip.Caption = EXPORTAR.Descrip
			Thisform.FILTRAR()
			If  .Not. Empty(EXPORTAR.ORIGEN)
				Thisform.EJECUTAR.Enabled = .T.
				Declare Integer SHGetFolderPath In "shfolder.dll" As _FFC_SHGetFolderPath Integer, Integer, Integer, Integer, String
				LCFOLDER = Space(256)
				LNFOLDER = 5
				NRETVAL = _FFC_SHGetFolderPath(0, LNFOLDER, 0, 1, @LCFOLDER)
				LCFOLDER = Chrtran(LCFOLDER, Chr(0), "")
				Thisform.Tag = LCFOLDER
				Clear Dlls  '_FFC_SHGETFOLDERPATH'
				If Empty(EXPORTAR.NOMBRE)
					Thisform.DESTINO.Value = Alltrim(LCFOLDER)+'\'+'exporta'+'_'+EXPORTAR.Text
				Else
					Thisform.DESTINO.Value = Alltrim(LCFOLDER)+'\'+Evaluate(EXPORTAR.NOMBRE)
				Endif
			Else
				Thisform.EJECUTAR.Enabled = .F.
			Endif
		Else
			Thisform.EJECUTAR.Enabled = .F.
			Thisform.Descrip.Caption = 'No está autorizado a acceder a este informe. Consulte con el Administrador de Sistemas'
		Endif
	ENDPROC

ENDDEFINE
