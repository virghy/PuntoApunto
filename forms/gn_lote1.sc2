*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="gn_lote1.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor4" UniqueID="" Timestamp="" />

	DataSource = .NULL.
	Height = 234
	InitialSelectedAlias = "gn_lote"
	Left = 211
	Name = "Dataenvironment"
	Top = 293
	Width = 532

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "gn_animal", ;
		CursorSource = "gn_animal", ;
		Database = \\tierra2\sistemas\futura9\data\datos.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		Top = 20, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "gn_lote", ;
		CursorSource = "gn_lote", ;
		Database = \\tierra2\sistemas\futura9\data\datos.dbc, ;
		Height = 90, ;
		Left = 150, ;
		Name = "Cursor2", ;
		Top = 20, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "gn_lote_detalle", ;
		BufferModeOverride = 5, ;
		CursorSource = "gn_lote_detalle", ;
		Database = \\tierra2\sistemas\futura9\data\datos.dbc, ;
		Height = 90, ;
		Left = 290, ;
		Name = "Cursor3", ;
		NoDataOnLoad = .T., ;
		Top = 20, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor4' AS cursor WITH ;
		Alias = "gn_potrero", ;
		CursorSource = "gn_potrero", ;
		Database = \\tierra2\sistemas\futura9\data\datos.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor4", ;
		Top = 140, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />
	
	PROCEDURE BeforeOpenTables
		DO SETEO
		oApp.SetDatabase(this)
	ENDPROC

ENDDEFINE

DEFINE CLASS lotes AS tsmaintform OF "..\libs\tsbase.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtIdLote" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblIdmovil" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtNombre" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.lblDescripcion" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.txtFecha" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tslabel1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tslabel2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tslabel3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.TxtCantidad" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tslabel7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.CboHacienda" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.CboTipoProduccion" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tsgrid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tsgrid1.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tsgrid1.Column1.CboAnimal" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tsgrid1.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tsgrid1.Column2.CboPotrero" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tsgrid1.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tsgrid1.Column3.TxtFecha" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tsgrid1.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tsgrid1.Column4.TxtCantidad_Potrero" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.TxtObservacion" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tslabel8" UniqueID="" Timestamp="" />

	camponro = 
	campos = idempresa
	campotam = 
	Caption = "LOTES"
	Comment = "idempresa = ?oApp.Empresa"
	detalle = .T.
	DoCreate = .T.
	Height = 381
	idobjeto = 0
	Name = "LOTES"
	tabla1 = gn_lote
	tabla2 = gn_lote_detalle
	tabla3 = gn_animal
	tabla4 = gn_potrero
	valores = oapp.empresa
	Width = 648
	lblRequerido.Name = "lblRequerido"
	Pageframe1.ErasePage = .T.
	Pageframe1.Height = 387
	Pageframe1.Left = 0
	Pageframe1.Name = "Pageframe1"
	Pageframe1.Page1.Name = "Page1"
	Pageframe1.Page2.grdList.Name = "grdList"
	Pageframe1.Page2.Name = "Page2"
	Pageframe1.Top = -3
	Pageframe1.Width = 648

	ADD OBJECT 'Pageframe1.Page1.CboHacienda' AS tscombobox WITH ;
		BoundColumn = 2, ;
		cmdsql = select a.Nombre,a.idhacienda from gn_hacienda a where a.idempresa=?oapp.empresa, ;
		ColumnCount = 2, ;
		ColumnWidths = "100,50", ;
		ControlSource = "gn_lote.idhacienda", ;
		cursor = cHacienda, ;
		Height = 22, ;
		Left = 112, ;
		Name = "CboHacienda", ;
		TabIndex = 3, ;
		Top = 53, ;
		Width = 211
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'Pageframe1.Page1.CboTipoProduccion' AS tscombobox WITH ;
		BoundColumn = 2, ;
		cmdsql = select a.TipoProduccion,a.idTipoProduccion from gn_tipo_produccion a where a.idempresa=?oapp.empresa, ;
		ColumnCount = 2, ;
		ColumnWidths = "100,50", ;
		ControlSource = "gn_lote.idtipoproduccion", ;
		cursor = cTipoProduccion, ;
		Height = 22, ;
		Left = 402, ;
		Name = "CboTipoProduccion", ;
		TabIndex = 4, ;
		Top = 53, ;
		Width = 211
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'Pageframe1.Page1.lblDescripcion' AS tslabel WITH ;
		Caption = "Nombre", ;
		Height = 16, ;
		Left = 333, ;
		Name = "lblDescripcion", ;
		TabIndex = 11, ;
		Top = 30, ;
		Width = 67
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.lblIdmovil' AS tslabel WITH ;
		Caption = "Codigo", ;
		Height = 16, ;
		Left = 68, ;
		Name = "lblIdmovil", ;
		TabIndex = 9, ;
		Top = 30, ;
		Width = 42
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Tsgrid1' AS tsgrid WITH ;
		campo = idempresa,idlote, ;
		ColumnCount = 4, ;
		Comment = "", ;
		editable = .T., ;
		GridLines = 2, ;
		Height = 156, ;
		Left = 79, ;
		Name = "Tsgrid1", ;
		Panel = 1, ;
		RecordSource = "gn_lote_detalle", ;
		RowHeight = 20, ;
		TabIndex = 8, ;
		Top = 142, ;
		valor = oApp.Empresa,gn_lote.idlote, ;
		valorvariable = gn_lote.idlote, ;
		variablevista = m.idlote, ;
		Visible = .T., ;
		Width = 511, ;
		Column1.ControlSource = "gn_lote_detalle.idanimal", ;
		Column1.FontSize = 8, ;
		Column1.Name = "Column1", ;
		Column1.Sparse = .F., ;
		Column1.Visible = .T., ;
		Column1.Width = 159, ;
		Column2.ControlSource = "gn_lote_detalle.idpotrero", ;
		Column2.FontSize = 8, ;
		Column2.InputMask = "", ;
		Column2.Name = "Column2", ;
		Column2.Visible = .T., ;
		Column2.Width = 120, ;
		Column3.Alignment = 3, ;
		Column3.ControlSource = "gn_lote_detalle.fecha_ingreso", ;
		Column3.FontSize = 8, ;
		Column3.Name = "Column3", ;
		Column3.Sparse = .F., ;
		Column3.Visible = .T., ;
		Column3.Width = 110, ;
		Column4.ControlSource = "gn_lote_detalle.cantidad_potrero", ;
		Column4.Name = "Column4", ;
		Column4.Visible = .T., ;
		Column4.Width = 100
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="grid" />

	ADD OBJECT 'Pageframe1.Page1.Tsgrid1.Column1.CboAnimal' AS tscombobox WITH ;
		BoundColumn = 2, ;
		cmdsql = select nombre, idanimal from gn_animal where IdEmpresa=?oApp.Empresa, ;
		ControlSource = "gn_lote_detalle.idanimal", ;
		cursor = cAnimal, ;
		editable = .T., ;
		FirstElement = 1, ;
		Height = 22, ;
		Left = 216, ;
		Name = "CboAnimal", ;
		TabIndex = 9, ;
		Top = 36, ;
		Visible = .T., ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'Pageframe1.Page1.Tsgrid1.Column1.Header1' AS header WITH ;
		Caption = "Animal", ;
		FontBold = .T., ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page1.Tsgrid1.Column2.CboPotrero' AS tscombobox WITH ;
		BoundColumn = 2, ;
		cmdsql = select potrero, IdPotrero from gn_potrero where IdEmpresa=?oApp.Empresa, ;
		ColumnCount = 2, ;
		ControlSource = "gn_lote_detalle.idpotrero", ;
		cursor = cPotrero, ;
		FirstElement = 1, ;
		Left = 278, ;
		Name = "CboPotrero", ;
		TabIndex = 10, ;
		Top = 72
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'Pageframe1.Page1.Tsgrid1.Column2.Header1' AS header WITH ;
		Caption = "Potrero", ;
		FontBold = .T., ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page1.Tsgrid1.Column3.Header1' AS header WITH ;
		Caption = "Fecha Ingreso", ;
		FontBold = .T., ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page1.Tsgrid1.Column3.TxtFecha' AS tstextbox WITH ;
		ControlSource = "gn_lote_detalle.fecha_ingreso", ;
		Left = 285, ;
		Name = "TxtFecha", ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128, ;
		TabIndex = 11, ;
		Top = 37
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.Tsgrid1.Column4.Header1' AS header WITH ;
		Caption = "Cantidad Potrero", ;
		FontBold = .T., ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page1.Tsgrid1.Column4.TxtCantidad_Potrero' AS tstextbox WITH ;
		ControlSource = "gn_lote_detalle.cantidad_potrero", ;
		editable = .F., ;
		Left = 293, ;
		Name = "TxtCantidad_Potrero", ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128, ;
		TabIndex = 12, ;
		Top = 93
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.Tslabel1' AS tslabel WITH ;
		Caption = "Fecha Creación", ;
		Height = 16, ;
		Left = 22, ;
		Name = "Tslabel1", ;
		TabIndex = 13, ;
		Top = 76, ;
		Width = 88
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Tslabel2' AS tslabel WITH ;
		Caption = "Producción", ;
		Height = 16, ;
		Left = 334, ;
		Name = "Tslabel2", ;
		TabIndex = 14, ;
		Top = 53, ;
		Width = 67
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Tslabel3' AS tslabel WITH ;
		Caption = "Hacienda", ;
		Height = 16, ;
		Left = 43, ;
		Name = "Tslabel3", ;
		TabIndex = 12, ;
		Top = 53, ;
		Width = 67
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Tslabel7' AS tslabel WITH ;
		Caption = "Cantidad", ;
		Height = 16, ;
		Left = 312, ;
		Name = "Tslabel7", ;
		TabIndex = 10, ;
		Top = 76, ;
		Width = 88
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Tslabel8' AS tslabel WITH ;
		Caption = "Observación", ;
		Height = 16, ;
		Left = 31, ;
		Name = "Tslabel8", ;
		TabIndex = 15, ;
		Top = 99, ;
		Width = 78
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.TxtCantidad' AS tstextbox WITH ;
		Comment = "", ;
		ControlSource = "gn_lote.cantidad", ;
		editable = .F., ;
		Height = 22, ;
		Left = 402, ;
		MaxLength = 25, ;
		Name = "TxtCantidad", ;
		requerido = .F., ;
		TabIndex = 6, ;
		Top = 76, ;
		Width = 92
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtFecha' AS tstextbox WITH ;
		Comment = "", ;
		ControlSource = "gn_lote.fecha_creacion", ;
		Height = 22, ;
		Left = 112, ;
		MaxLength = 25, ;
		Name = "txtFecha", ;
		requerido = .T., ;
		TabIndex = 5, ;
		Top = 76, ;
		Width = 92
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtIdLote' AS tstextbox WITH ;
		Comment = "", ;
		ControlSource = "gn_lote.idlote", ;
		Height = 22, ;
		Left = 112, ;
		MaxLength = 4, ;
		Name = "txtIdLote", ;
		requerido = .T., ;
		TabIndex = 1, ;
		Top = 30, ;
		Width = 47
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.txtNombre' AS tstextbox WITH ;
		Comment = "", ;
		ControlSource = "gn_lote.lote", ;
		Height = 22, ;
		Left = 402, ;
		MaxLength = 25, ;
		Name = "txtNombre", ;
		requerido = .T., ;
		TabIndex = 2, ;
		Top = 30, ;
		Width = 191
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.TxtObservacion' AS tstextbox WITH ;
		Comment = "", ;
		ControlSource = "gn_potrero.observacion", ;
		Height = 31, ;
		Left = 112, ;
		MaxLength = 25, ;
		Name = "TxtObservacion", ;
		requerido = .F., ;
		TabIndex = 7, ;
		Top = 99, ;
		Width = 508
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />
	
	PROCEDURE validar
		SELECT gn_lote_detalle
			m.linea=0
		SCAN 
		*!*	IF RECCOUNT('gn_potrero_detalle')> 0 AND thisform.pageframe1.page1.TxtCantidad.value > 0
		*!*		m.linea=gn_potrero.cantidad
		*!*		thisform.pageframe1.page1.TxtCantidad.value = 0
		*!*	ENDIF
		*!*	IF RECCOUNT('gn_potrero_detalle')> 0 AND thisform.pageframe1.page1.TxtCantidad.value = 0
				m.linea=m.linea + 1
		*!*	ENDIF
		ENDSCAN
		
		*!*	SELECT gn_potrero
		replace gn_lote.cantidad WITH m.linea IN gn_lote
		thisform.pageframe1.page1.TxtCantidad.value = m.linea
		*!*	replace gn_potrero.cantidad WITH thisform.pageframe1.page1.TxtCantidad.value IN gn_potrero
		thisform.Refresh
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.CboHacienda.LostFocus
		
		
		
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.CboTipoProduccion.LostFocus
		
		
		
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.Tsgrid1.Column2.CboPotrero.LostFocus
		SELECT gn_potrero
		
		LOCATE FOR  gn_potrero.idpotrero = thisform.pageframe1.page1.tsgrid1.column2.CboPotrero.Value
		thisform.pageframe1.page1.tsgrid1.Column4.TxtCantidad_Potrero.Value = gn_potrero.cantidad
		
		SELECT gn_lote_detalle
		replace gn_lote_detalle.cantidad_potrero WITH thisform.pageframe1.page1.tsgrid1.Column4.TxtCantidad_Potrero.Value IN gn_lote_detalle
		
		thisform.pageframe1.page1.tsgrid1.Refresh()
		thisform.Refresh()
		
	ENDPROC

	PROCEDURE Pageframe1.Page1.Tsgrid1.Refresh
		DODEFAULT()
	ENDPROC

ENDDEFINE
