*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="sas_facturarservicio.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*

*
#INCLUDE "..\include\tastrade.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />

	DataSource = .NULL.
	Height = 200
	Left = 542
	Name = "Dataenvironment"
	Top = 136
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "sas_ccontratos", ;
		CursorSource = "sas_ccontratos", ;
		Database = ..\data\datos.dbc, ;
		Height = 90, ;
		Left = 10, ;
		Name = "Cursor1", ;
		NoDataOnLoad = .T., ;
		Top = 20, ;
		Width = 136
		*< END OBJECT: BaseClass="cursor" />

ENDDEFINE

DEFINE CLASS tsbaseform12 AS tsbaseform OF "..\libs\tsbase.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Tslabel1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tstextbox1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tscommandbutton1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Idproducto1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtPaciente" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Contrato" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Producto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tscommandbutton2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column1.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column1.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column2.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column2.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column4.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column4.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column3.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="grdSas_ctiposeguro.Column3.Tscheckbox1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cbocobrador1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cboTipo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cboCiclo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cbovendedor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="dFecha" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="hFecha" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tipo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtNroContrato" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Olecontrol1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtNroServicio" UniqueID="" Timestamp="" />

	Caption = "Factura Servicio"
	DataSession = 2
	detalle = .T.
	DoCreate = .T.
	editmode = .T.
	Height = 553
	idobjeto = 1184
	Name = "Tsbaseform12"
	Width = 633
	lblRequerido.Name = "lblRequerido"
	lblRequerido.TabIndex = 15

	ADD OBJECT 'cboCiclo' AS cbocondventa WITH ;
		cmdsql = Select Ciclo,IdCiclo from sas_CicloFacturacion where idempresa = ?oApp.Empresa union Select '(Todos)' as Ciclo,'-1' as IdCiclo order by 1 , ;
		ControlSource = "", ;
		cursor = cCiclo, ;
		Height = 22, ;
		Left = 144, ;
		Name = "cboCiclo", ;
		TabIndex = 6, ;
		Top = 109, ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="combobox" />

	ADD OBJECT 'Cbocobrador1' AS cbocobrador WITH ;
		BoundTo = .F., ;
		cmdsql = Select rtrim(b.nombre)+' '+rtrim(b.apellido) as Nombre, rtrim(a.idCobrador) as Codigo from vt_cobradores a, bs_personas b where idempresa = ?oApp.Empresa and a.idpersona=b.idpersona union Select '(Todos)' as Nombre,'-1' as Codigo order by 1, ;
		ColumnCount = 2, ;
		ColumnWidths = "150,0", ;
		ControlSource = "", ;
		Height = 22, ;
		Left = 144, ;
		Name = "Cbocobrador1", ;
		TabIndex = 4, ;
		Top = 85, ;
		Value = , ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="combobox" />

	ADD OBJECT 'cboTipo' AS cbocondventa WITH ;
		cmdsql = Select TipoCobertura, IdTipoCobertura from sas_TipoCobertura where IdEmpresa=?oApp.Empresa union Select '(Todos)' as TipoCobertura,'-1' as IdtipoCobertura order by 1, ;
		ControlSource = "", ;
		cursor = xcTc, ;
		Left = 396, ;
		Name = "cboTipo", ;
		TabIndex = 7, ;
		Top = 109, ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="combobox" />

	ADD OBJECT 'Cbovendedor1' AS cbovendedor WITH ;
		cmdsql = Select rtrim(b.nombre)+' '+rtrim(b.apellido) nombre, rtrim(a.idvendedor)  Codigo from vt_vendedores a, bs_personas b where a.idempresa = ?oApp.Empresa and a.idpersona=b.idpersona union Select '(Todos)' as Nombre,'-1' as Codigo order by 1 , ;
		ColumnCount = 2, ;
		ColumnWidths = "150,50", ;
		ControlSource = "", ;
		Left = 396, ;
		Name = "Cbovendedor1", ;
		RowSourceType = 3, ;
		TabIndex = 5, ;
		Top = 85, ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="combobox" />

	ADD OBJECT 'Contrato' AS tstextbox WITH ;
		Comment = "", ;
		editable = .F., ;
		Enabled = .F., ;
		Height = 22, ;
		Left = 218, ;
		MaxLength = 50, ;
		Name = "Contrato", ;
		requerido = .T., ;
		TabIndex = 25, ;
		Top = 157, ;
		Width = 334, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'dFecha' AS tstextbox WITH ;
		Alignment = 3, ;
		Height = 21, ;
		Left = 144, ;
		Name = "dFecha", ;
		TabIndex = 8, ;
		Top = 133, ;
		Value = ({  /  /  }), ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'grdSas_ctiposeguro' AS tsgrid WITH ;
		ColumnCount = 4, ;
		FontSize = 8, ;
		Height = 228, ;
		Left = 72, ;
		Name = "grdSas_ctiposeguro", ;
		Panel = 1, ;
		ReadOnly = .F., ;
		RecordSource = "sas_ccontratos", ;
		RecordSourceType = 1, ;
		RowHeight = 17, ;
		TabIndex = 13, ;
		titulo = Lista de Clientes, ;
		Top = 276, ;
		Width = 465, ;
		Column1.ControlSource = "sas_ccontratos.nrocontrato", ;
		Column1.FontSize = 8, ;
		Column1.Name = "Column1", ;
		Column1.ReadOnly = .T., ;
		Column1.Visible = .T., ;
		Column1.Width = 57, ;
		Column2.ControlSource = "sas_ccontratos.razsocial", ;
		Column2.FontSize = 8, ;
		Column2.Name = "Column2", ;
		Column2.ReadOnly = .T., ;
		Column2.Visible = .T., ;
		Column2.Width = 232, ;
		Column3.ColumnOrder = 4, ;
		Column3.ControlSource = "sas_ccontratos.importe", ;
		Column3.FontSize = 8, ;
		Column3.InputMask = "999,999,999", ;
		Column3.Name = "Column4", ;
		Column3.ReadOnly = .T., ;
		Column3.Visible = .T., ;
		Column3.Width = 102, ;
		Column4.ColumnOrder = 3, ;
		Column4.FontSize = 8, ;
		Column4.Name = "Column3", ;
		Column4.ReadOnly = .F., ;
		Column4.Sparse = .F., ;
		Column4.Visible = .T., ;
		Column4.Width = 47
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="grid" />

	ADD OBJECT 'grdSas_ctiposeguro.Column1.Header1' AS header WITH ;
		Caption = "Codigo", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grdSas_ctiposeguro.Column1.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128, ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grdSas_ctiposeguro.Column2.Header1' AS header WITH ;
		Caption = "Nombre", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grdSas_ctiposeguro.Column2.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128, ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'grdSas_ctiposeguro.Column3.Header1' AS header WITH ;
		Caption = "Generar", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grdSas_ctiposeguro.Column3.Tscheckbox1' AS tscheckbox WITH ;
		Alignment = 0, ;
		Caption = "", ;
		Left = 32, ;
		Name = "Tscheckbox1", ;
		ReadOnly = .F., ;
		Top = 23
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="checkbox" />

	ADD OBJECT 'grdSas_ctiposeguro.Column4.Header1' AS header WITH ;
		Caption = "Monto", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'grdSas_ctiposeguro.Column4.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		InputMask = "999,999,999", ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128, ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'hFecha' AS tstextbox WITH ;
		Alignment = 3, ;
		Left = 396, ;
		Name = "hFecha", ;
		TabIndex = 9, ;
		Top = 133, ;
		Value = ({  /  /  }), ;
		Width = 156
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Idproducto1' AS idproducto WITH ;
		Left = 144, ;
		Name = "Idproducto1", ;
		objeto = this.parent.Producto, ;
		TabIndex = 2, ;
		Top = 37
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="textbox" />

	ADD OBJECT 'Olecontrol1' AS olecontrol WITH ;
		Height = 24, ;
		Left = 228, ;
		Name = "Olecontrol1", ;
		Top = 241, ;
		Width = 324
		*< END OBJECT: BaseClass="olecontrol"  Nombre="Tsbaseform12.Olecontrol1" Parent="Tsbaseform12" ObjName="Olecontrol1" OLEObject="C:\Windows\system32\MSCOMCTL.OCX" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJA62lroyc4BAwAAAEABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAYAAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAQAAAAAAAAABAAAAAIAAAD+/////v////7///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////8iOgU1iYXREbFqAMDwKDYoIUM0EggAAAB9IQAAewIAAAGKq5cAAAYAHAAAAAAAAAAAAMhCAAAAAAHvzasAAAUAXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAeHczAAYAAAD//////////wzAEgAf3uy9AQAFAAzAEgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" />

	ADD OBJECT 'Producto' AS tstextbox WITH ;
		Height = 21, ;
		Left = 144, ;
		MaxLength = 200, ;
		Name = "Producto", ;
		TabIndex = 3, ;
		Top = 62, ;
		Width = 408
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Tipo' AS tsoptiongroup WITH ;
		Height = 24, ;
		Left = 144, ;
		Name = "Tipo", ;
		TabIndex = 11, ;
		Top = 214, ;
		Width = 156, ;
		Option1.Caption = "Fijos", ;
		Option1.Left = 5, ;
		Option1.Name = "Option1", ;
		Option1.Top = 5, ;
		Option2.Caption = "Variables", ;
		Option2.Left = 73, ;
		Option2.Name = "Option2", ;
		Option2.Top = 6
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="optiongroup" />

	ADD OBJECT 'Tscommandbutton1' AS tscommandbutton WITH ;
		Caption = "Buscar", ;
		Left = 144, ;
		Name = "Tscommandbutton1", ;
		TabIndex = 12, ;
		Top = 241
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Tscommandbutton2' AS tscommandbutton WITH ;
		Caption = "Generar Factura", ;
		Height = 26, ;
		Left = 144, ;
		Name = "Tscommandbutton2", ;
		TabIndex = 14, ;
		Top = 516, ;
		Width = 120
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Tslabel1' AS tslabel WITH ;
		AutoSize = .T., ;
		Caption = "Fecha", ;
		Left = 109, ;
		Name = "Tslabel1", ;
		TabIndex = 16, ;
		Top = 13
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel10' AS tslabel WITH ;
		Caption = "Tipo de Servicio", ;
		Height = 22, ;
		Left = 27, ;
		Name = "Tslabel10", ;
		TabIndex = 21, ;
		Top = 216, ;
		Width = 113
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel11' AS tslabel WITH ;
		AutoSize = .T., ;
		Caption = "Fecha", ;
		Height = 16, ;
		Left = 106, ;
		Name = "Tslabel11", ;
		TabIndex = 17, ;
		Top = 13, ;
		Width = 34
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel12' AS tslabel WITH ;
		Caption = "Nro Contrato", ;
		Height = 16, ;
		Left = 60, ;
		Name = "Tslabel12", ;
		TabIndex = 26, ;
		Top = 158, ;
		Width = 77, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel13' AS tslabel WITH ;
		Caption = "Nro Servicio", ;
		Height = 16, ;
		Left = 60, ;
		Name = "Tslabel13", ;
		TabIndex = 26, ;
		Top = 183, ;
		Width = 77, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel2' AS tslabel WITH ;
		AutoSize = .T., ;
		Caption = "Producto o Servicio", ;
		Height = 16, ;
		Left = 31, ;
		Name = "Tslabel2", ;
		TabIndex = 19, ;
		Top = 37, ;
		Width = 109
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel3' AS tslabel WITH ;
		AutoSize = .T., ;
		Caption = "Descripcion", ;
		Height = 16, ;
		Left = 73, ;
		Name = "Tslabel3", ;
		TabIndex = 18, ;
		Top = 61, ;
		Width = 67
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel4' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Ciclo Facturacion", ;
		Height = 16, ;
		Left = 45, ;
		Name = "Tslabel4", ;
		TabIndex = 24, ;
		Top = 109, ;
		Width = 95, ;
		ZOrderSet = 32
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel5' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Cobrador", ;
		Height = 16, ;
		Left = 86, ;
		Name = "Tslabel5", ;
		TabIndex = 28, ;
		Top = 85, ;
		Width = 54, ;
		ZOrderSet = 32
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel6' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Vendedor", ;
		Height = 16, ;
		Left = 338, ;
		Name = "Tslabel6", ;
		TabIndex = 27, ;
		Top = 85, ;
		Width = 57, ;
		ZOrderSet = 32
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel7' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Tipo Cobertura", ;
		Height = 16, ;
		Left = 310, ;
		Name = "Tslabel7", ;
		TabIndex = 23, ;
		Top = 109, ;
		Width = 85, ;
		ZOrderSet = 32
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel8' AS tslabel WITH ;
		Caption = "Periodo del Servicio", ;
		Height = 22, ;
		Left = 27, ;
		Name = "Tslabel8", ;
		TabIndex = 22, ;
		Top = 133, ;
		Width = 113
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel9' AS tslabel WITH ;
		Caption = "Hasta", ;
		Height = 22, ;
		Left = 282, ;
		Name = "Tslabel9", ;
		TabIndex = 20, ;
		Top = 133, ;
		Width = 113
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tstextbox1' AS tstextbox WITH ;
		Alignment = 3, ;
		Left = 144, ;
		Name = "Tstextbox1", ;
		TabIndex = 1, ;
		Top = 13, ;
		Value = ({  /  /  })
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtNroContrato' AS campo_clave WITH ;
		actualizar = .T., ;
		condicionextra = c.IdEmpresa=?oApp.Empresa, ;
		condicion_en_edicion = IdEstado = 'A', ;
		ControlSource = "", ;
		copiarcampos = DireccionServicio as DireccionRef, ;
		datoayuda = Contratos  Activos, ;
		Height = 23, ;
		indice = NroContrato, ;
		Left = 144, ;
		Name = "txtNroContrato", ;
		objeto = this.parent.Contrato, ;
		objeto2 = , ;
		origen = R, ;
		pegarcampos = DireccionRef, ;
		requerido = .T., ;
		retorna = c.Nombre, ;
		retorna2 = , ;
		TabIndex = 10, ;
		tabla = sas_Contrato c, ;
		Top = 156, ;
		Width = 72
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtNroServicio' AS campo_clave WITH ;
		actualizar = .T., ;
		condicionextra = c.IdEmpresa=?oApp.Empresa, ;
		condicion_en_edicion = Estado = 'D', ;
		ControlSource = "", ;
		copiarcampos = , ;
		datoayuda = , ;
		Height = 23, ;
		indice = NroSolicitud, ;
		InputMask = "99999999", ;
		Left = 144, ;
		Name = "txtNroServicio", ;
		objeto = this.parent.txtPaciente, ;
		objeto2 = , ;
		origen = R, ;
		pegarcampos = , ;
		requerido = .T., ;
		retorna = c.Paciente, ;
		retorna2 = , ;
		TabIndex = 10, ;
		tabla = sas_servicios c, ;
		Top = 181, ;
		Width = 72
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtPaciente' AS tstextbox WITH ;
		Comment = "", ;
		editable = .F., ;
		Enabled = .F., ;
		Height = 22, ;
		Left = 218, ;
		MaxLength = 50, ;
		Name = "txtPaciente", ;
		requerido = .T., ;
		TabIndex = 25, ;
		Top = 182, ;
		Width = 334, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />
	
	PROCEDURE imprimir
		LPARAMETERS lcIdFactura
		M.IDFACTURA = lcIdFactura 
		
		
		*Verificamos la forma de imprimir la factura
		*Si tiene nombre formato, se usa el report
		*Si no tiene, se usa ASCII
		=THIS.RUNSQL("Select convert(CHAR(50),dbo.LeerConstante(?oApp.Empresa,'VT_NOMBREFORMATO_FACT')) as NombreFormato", 'cTipo')
		IF RECCOUNT('cTipo')=0
		 MESSAGEBOX("No se encuentra la constante VT_NOMBREFORMATO_FACT")
			RETURN
		ENDIF
		
		IF !EMPTY(NVL(cTipo.NombreFormato,''))
			cTipoImpresion='R'		&&Report
		ELSE
			cTipoImpresion='A'		&&Ascii
		ENDIF
		
		
			IF cTipoImpresion='A'
				=THIS.RUNSQL("Select convert(int,dbo.LeerConstante(?oApp.Empresa,'VT_IDFORMATOTPV')) as IdFormato", 'cConfig')
				IF RECCOUNT('cConfig')=0
				 MESSAGEBOX("No se encuentra la constante VT_IDFORMATOTPV")
					RETURN
				ENDIF
					=ImpresionFactura(cConfig.Idformato)
			ELSE
				LCDESTINO = LEERINI('Destino Impresion', 'OPCIONES')
				If Empty(LCDESTINO)
					LCDESTINO = 'PREVIEW NOCONSOLE'
					= ESCRIBIRINI(LCDESTINO, 'Destino Impresion', 'OPCIONES')
				Endif
		
				REPORT FORM (cTipo.NombreFormato)  &LCDESTINO 
			ENDIF
							
	ENDPROC

	PROCEDURE Init
		DODEFAULT()
		ThisForm.cbocobrador1.Value='-1'
		thisform.cboCiclo.Value='-1'
		thisform.cboTipo.Value='-1'
		thisform.cbovendedor1.Value='-1'
	ENDPROC

	PROCEDURE grdSas_ctiposeguro.Column3.Header1.Click
		IF EMPTY(THIS.TAG)
			THIS.TAG = 'OK'
			REPLACE generar WITH .T. ALL IN sas_cContratos
		ELSE
			THIS.TAG = ''
			REPLACE generar WITH .F. ALL IN sas_cContratos
		ENDIF
	ENDPROC

	PROCEDURE Tscommandbutton1.Click
		m.Cobrador = ThisForm.cbocobrador1.Value
		m.Ciclo  = thisform.cboCiclo.Value
		m.IdTipoCobertura = thisform.cboTipo.Value
		m.IdVendedor = thisform.cbovendedor1.Value
		
		IF EMPTY(ThisForm.txtNroContrato.Value)
			m.NroContrato='.'
		ELSE
			m.NroContrato=ThisForm.txtNroContrato.Value
		ENDIF 
		
		IF EMPTY(ThisForm.txtNroServicio.Value)
			m.NroServicio='.'
		ELSE
			m.NroServicio=ThisForm.txtNroServicio.Value
		ENDIF 
		
		
		
		*=REQUERY('sas_cContratos')
		IF ThisForm.Tipo.Value=1
			TEXT TO cmdSQL noshow
				SELECT Sas_contrato.NroContrato, Sas_contrato.IdCliente, Sas_contrato.Importe, Vt_clientes.RazSocial, Sas_contrato.IdCiclo, Convert(bit,1) as Generar 
				FROM  dbo.sas_Contrato Sas_contrato  
				INNER JOIN dbo.vt_clientes Vt_clientes  
				ON  Sas_contrato.IdEmpresa = Vt_clientes.IdEmpresa AND  Sas_contrato.IdCliente = Vt_clientes.IdCliente 
				WHERE (  Sas_contrato.IdEmpresa =  ?oApp.Empresa 
				AND  Sas_contrato.IdEstado = 'A'   
				and  (Sas_contrato.IdCobrador =  ?m.Cobrador  or ?m.Cobrador='-1')
				and  (Sas_contrato.IdCiclo =  ?m.Ciclo or ?m.Ciclo='-1') 
				and  (Sas_contrato.IdVendedor =  ?m.IdVendedor or ?m.IdVendedor='-1') 
				and  (Sas_contrato.IdTipoCobertura =  ?m.IdTipoCobertura or ?m.IdTipoCobertura='-1') 
				and  (Sas_contrato.NroContrato=  ?m.NroContrato or ?m.NroContrato='.') 
				AND  Sas_contrato.Importe >  0  ) 
				ORDER BY Sas_contrato.NroContrato
		
			ENDTEXT
		ELSE
			TEXT TO cmdSQL noshow  
				SELECT Sas_contrato.NroContrato, Sas_contrato.IdCliente, Sas_contrato.Importe, Vt_clientes.RazSocial, Sas_contrato.IdCiclo, Convert(bit,1) as Generar 
				FROM  dbo.sas_Contrato Sas_contrato  
				INNER JOIN dbo.vt_clientes Vt_clientes  
				ON  Sas_contrato.IdEmpresa = Vt_clientes.IdEmpresa AND  Sas_contrato.IdCliente = Vt_clientes.IdCliente 
				WHERE   Sas_contrato.IdEmpresa =  ?oApp.Empresa 
				AND  Sas_contrato.IdEstado = 'A'   
				and  (Sas_contrato.IdCobrador =  ?m.Cobrador  or ?m.Cobrador='-1')
				and  (Sas_contrato.IdCiclo =  ?m.Ciclo or ?m.Ciclo='-1') 
				and  (Sas_contrato.IdVendedor =  ?m.IdVendedor or ?m.IdVendedor='-1') 
				and  (Sas_contrato.IdTipoCobertura =  ?m.IdTipoCobertura or ?m.IdTipoCobertura='-1')
				and  (Sas_contrato.NroContrato=  ?m.NroContrato or ?m.NroContrato='.') 
				ORDER BY Sas_contrato.NroContrato		
			ENDTEXT
		ENDIF
			
		
		
		thisform.grdSas_ctiposeguro.Recordsource=''
		
		thisform.runsql(cmdSQL,'sas_cContratos')
		
		**VG 25/05/2011
		**Si es variable calcular el Importe Final
		thisform.olecontrol1.value = 0
		IF ThisForm.Tipo.Value=2
				thisform.olecontrol1.max=RECCOUNT('sas_cContratos')
				
				SELECT sas_cContratos
				SCAN
					thisform.olecontrol1.value = thisform.olecontrol1.value + 1 
					TEXT TO cmdSQL NOSHOW 
					SELECT     s.NroContrato, sd.IdProducto, SUM(sd.Cantidad) AS Total, cb.Cantidad, cb.Precio
						FROM         sas_Cobertura AS cb INNER JOIN
		                      sas_Contrato AS c ON cb.IdContrato = c.IdContrato RIGHT OUTER JOIN
		                      sas_Servicios AS s INNER JOIN
		                      st_movimiento_Det AS sd ON s.IdRemision = sd.IdRemision ON cb.IdProducto = sd.IdProducto AND c.NroContrato = s.NroContrato
		                WHERE c.IdEmpresa =  ?oApp.Empresa 
		                AND convert(datetime,CONVERT(VARCHAR (10),S.fechaAgenda,105)) between ?ThisForm.dFecha.Value and ?ThisForm.hFecha.value
		                AND c.NroContrato = ?sas_cContratos.NroContrato
		                and (s.NroSolicitud = ?m.NroServicio or ?m.NroServicio='.')       
						GROUP BY s.NroContrato, sd.IdProducto, cb.Cantidad, cb.Precio
					ENDTEXT
					thisform.runsql(cmdSQL,'cDet')
					SELECT cDet
					m.Total = 0
					SCAN
						IF cDet.Total>NVL(cDet.Cantidad,0)
							m.Total = m.Total + (cDet.Total-NVL(cDet.Cantidad,0))*cDet.Precio
						ENDIF 
					ENDSCAN
					SELECT sas_cContratos
					replace Importe WITH m.Total
					 
				ENDSCAN
				SELECT sas_cContratos
				DELETE FOR Importe=0
		
		ENDIF
		
		
		thisform.grdSas_ctiposeguro.Recordsource='sas_cContratos'
		ThisForm.grdSas_ctiposeguro.Column1.ControlSource='sas_cContratos.NroContrato'
		ThisForm.grdSas_ctiposeguro.Column2.ControlSource='sas_cContratos.RazSocial'
		ThisForm.grdSas_ctiposeguro.Column3.ControlSource='sas_cContratos.Generar'
		ThisForm.grdSas_ctiposeguro.Column4.ControlSource='sas_cContratos.Importe'
		
	ENDPROC

	PROCEDURE Tscommandbutton2.Click
		SELECT sas_cContratos
		IF EMPTY(ThisForm.Tstextbox1.Value)
			MESSAGEBOX("Indique la fecha de la factura",64,TASTRADE_LOC)
			RETURN 
		ENDIF
		IF EMPTY(ThisForm.IDproducto1.Value)
			MESSAGEBOX("Indique el producto a facturar",64,TASTRADE_LOC)
			RETURN 
		ENDIF
		
			
		
		SCAN FOR !EMPTY(NVL(Importe,0)) AND generar=.t.
			thisform.runsql("exec [sas_FacturaServicio] ?oApp.Empresa, ?IdCliente,?ThisForm.Tstextbox1.value, '0001',?Importe,?ThisForm.Idproducto1.Value, ?ThisForm.Producto.value,?NroContrato,?IdCiclo","cResult")
			thisform.imprimir(cResult.IdFactura)
		ENDSCAN
		
		
		*!*	Create  Proc [dbo].[sas_FacturaServicio]
		*!*	(@IdEmpresa char(3), @IdCliente char(10),@Fecha datetime, @Usuario char(10), @Importe money, 
		*!*	@IdProducto char(20))
		
		
	ENDPROC

	PROCEDURE txtNroContrato.LostFocus
		
		
	ENDPROC

	PROCEDURE txtNroServicio.LostFocus
		
		
	ENDPROC

ENDDEFINE
