*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="sys_getproducto.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*


*
#INCLUDE "..\include\tastrade.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	DataSource = .NULL.
	Height = 200
	InitialSelectedAlias = "exportar"
	Left = 7
	Name = "Dataenvironment"
	Top = 263
	Width = 535
	
	PROCEDURE BeforeOpenTables
		DO SETEO
	ENDPROC

ENDDEFINE

DEFINE CLASS imprimir AS tsbaseform OF "..\libs\tsbase.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Shape2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="descrip" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ejecutar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="oleImagesList" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Agrupar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="OleTreeView" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: *exportarpivot
		*m: *exportarxls
		*m: *filtrar
		*m: *generardbf
	*</DefinedPropArrayMethod>

	AlwaysOnTop = .F.
	AutoCenter = .T.
	BorderStyle = 2
	Caption = "Seleccione el Servicio"
	ctoolbar = 
	DataSession = 2
	DoCreate = .T.
	editmode = .T.
	FontSize = 8
	Height = 450
	HelpContextID = 106
	Icon = ..\
	KeyPreview = .T.
	LockScreen = .F.
	MaxButton = .F.
	MinButton = .F.
	Name = "Imprimir"
	Picture = ..\
	ShowTips = .T.
	ShowWindow = 0
	WhatsThisButton = .T.
	WhatsThisHelp = .T.
	Width = 590
	WindowState = 0
	WindowType = 1
	lblRequerido.Name = "lblRequerido"

	ADD OBJECT 'Agrupar' AS optiongroup WITH ;
		AutoSize = .F., ;
		BackStyle = 0, ;
		ButtonCount = 2, ;
		Height = 24, ;
		Left = 14, ;
		Name = "Agrupar", ;
		SpecialEffect = 0, ;
		TabIndex = 23, ;
		Top = 76, ;
		Value = 1, ;
		Width = 286, ;
		ZOrderSet = 22, ;
		Option1.Alignment = 0, ;
		Option1.AutoSize = .F., ;
		Option1.BackStyle = 0, ;
		Option1.Caption = "Por Categoría", ;
		Option1.FontBold = .F., ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 20, ;
		Option1.Name = "Option1", ;
		Option1.Top = 4, ;
		Option1.Value = 1, ;
		Option1.Width = 112, ;
		Option2.AutoSize = .F., ;
		Option2.BackStyle = 0, ;
		Option2.Caption = "Por Orden Alfabetico", ;
		Option2.FontBold = .F., ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 149, ;
		Option2.Name = "Option2", ;
		Option2.Top = 4, ;
		Option2.Width = 139
		*< END OBJECT: BaseClass="optiongroup" />

	ADD OBJECT 'Command1' AS commandbutton WITH ;
		Caption = "\<Cerrar", ;
		ColorScheme = 1, ;
		ColorSource = 4, ;
		Enabled = .T., ;
		FontSize = 8, ;
		Height = 53, ;
		Left = 452, ;
		MousePointer = 0, ;
		Name = "Command1", ;
		Picture = ..\bitmaps\close.bmp, ;
		Style = 0, ;
		TabIndex = 10, ;
		Top = 388, ;
		Width = 122, ;
		ZOrderSet = 19
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'descrip' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Descripción del informe", ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 41, ;
		Left = 19, ;
		Name = "descrip", ;
		TabIndex = 21, ;
		Top = 398, ;
		Width = 282, ;
		WordWrap = .T., ;
		ZOrderSet = 6
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'ejecutar' AS commandbutton WITH ;
		Caption = "\<Seleccionar", ;
		ColorScheme = 1, ;
		ColorSource = 4, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 52, ;
		Left = 320, ;
		MousePointer = 0, ;
		Name = "ejecutar", ;
		Picture = ..\bitmaps\exportar.bmp, ;
		Style = 0, ;
		TabIndex = 9, ;
		Top = 389, ;
		Width = 133, ;
		ZOrderSet = 8
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Label2' AS label WITH ;
		AutoSize = .T., ;
		Caption = "Descripción", ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 15, ;
		Left = 14, ;
		Name = "Label2", ;
		TabIndex = 20, ;
		Top = 381, ;
		Width = 58, ;
		ZOrderSet = 7
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label4' AS label WITH ;
		BackStyle = 0, ;
		Caption = 'Haga click en uno de los servicios de la lista. Luego haga un click en "Seleccionar"', ;
		FontName = "MS Sans Serif", ;
		FontSize = 7, ;
		Height = 33, ;
		Left = 14, ;
		Name = "Label4", ;
		TabIndex = 13, ;
		Top = 19, ;
		Width = 562, ;
		WordWrap = .T., ;
		ZOrderSet = 3
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label5' AS label WITH ;
		AutoSize = .T., ;
		Caption = "\<Instrucciones ", ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 15, ;
		Left = 18, ;
		Name = "Label5", ;
		TabIndex = 12, ;
		Top = 2, ;
		Width = 68, ;
		ZOrderSet = 4
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label6' AS label WITH ;
		Alignment = 2, ;
		AutoSize = .F., ;
		BackColor = 0,0,128, ;
		BackStyle = 1, ;
		Caption = "\<Servicios", ;
		FontBold = .T., ;
		FontName = "Arial", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Height = 15, ;
		Left = 14, ;
		Name = "Label6", ;
		TabIndex = 15, ;
		Top = 61, ;
		Width = 562, ;
		WordWrap = .T., ;
		ZOrderSet = 21
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'oleImagesList' AS olecontrol WITH ;
		Height = 37, ;
		Left = 540, ;
		Name = "oleImagesList", ;
		Top = 12, ;
		Width = 49, ;
		ZOrderSet = 18
		*< END OBJECT: BaseClass="olecontrol"  Nombre="Imprimir.oleImagesList" Parent="Imprimir" ObjName="oleImagesList" OLEObject="C:\Windows\system32\MSCOMCTL.OCX" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7////+/////v///////////////////wkAAAAKAAAACwAAAAwAAAANAAAADgAAAA8AAAAQAAAAEQAAABIAAAATAAAAFAAAAAQAAAD//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACC6r1pL48wBAwAAAAABAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAAJhoAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAHIAAAAAAAAAAQAAAP7///8DAAAA/v////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9cAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAJAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADkzNjgyNjVFLTg1RkUtMTFkMS04QkUzLTAwMDBGODc1NERBMQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAIAMAAAASW1hZ2VIZWlnaHQACQAAAEkKAAAAEAAAAAsAAABJbWFnZVdpZHRoAAkAAABJCgAAABAAAAANAAAAVXNlTWFza0NvbG9yAAUAAABMAQAAAAoAAABCYWNrQ29sb3IACQAAAEkKAAAADAAAgAAAAAAAAAAAAAAAAAAAI38kLJGF0RGxagDA8Cg2KCFDNBIIAAAA7QMAAO0DAACAfuHmAAAGAAgAAAAQABAAwMDAAP//AAAB782rAAAFAAAAAAAGAAAA/////wwAAIAAAAAABAAAAAAAAAAAAAAAAQAAAGx0AAA4BAAAAAABAAIAICAQAAAAAADoAgAAJgAAABAQEAAAAAAAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAIhIiIiIiIhIiEiIiIiIiIREiIiIiIiIiIiIiIiIiIiIiIiIiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB3d3d3d3d3d3d3d3d3dzAAf7i4uLi4uLi4uLi4uLgwAH+Li4uLi4uLi4uLi4uLMAB/uLi4uLi4uLi4uLi4uDAAf4uLi4uLi4uLi4uLi4swAH+4uLi4uLi4uLi4uLi4MAB/i4uLi4uLi4uLi4uLizAAf7i4uLi4uLi4uLi4uLgwAH+Li4uLi4uLi4uLi4uLMAB/uLi4uLi4uLi4uLi4uDAAf4uLi4uLi4uLi4uLi4swAH+4uLi4uLi4uLi4uLi4MAB/i4uLi4uLi4uLi4uLizAAf7i4uLi4uLi4uLi4uLgwAH+Li4uLi4uLi4uLi4uLMAB/uLi4uLi4uLi4uLi4uDAAf4uLi4uLi4uLi4uLi4swAH+4uLi4uLi4uLi4uLi4MAB//////////////////wAAeIiIiIiIiIh3d3d3d3cAAAf7i4uLi4uHAAAAAAAAAAAAf7i4uLi4cAAAAAAAAAAAAAf/////9wAAAAAAAAAAAAAAd3d3d3AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////8AAAAOAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAADgAAAB8AAf//gAP//8AH///gD//////////////////8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHd3d3d3d3cAf7i4uLi4twB/i4uLi4uHAH+4uLi4uLcAf4uLi4uLhwB/uLi4uLi3AH+Li4uLi4cAf7i4uLi4twB////////3AHi4uLh3d3cAB4uLhwAAAAAAd3dwAAAAAAAAAAAAAAAA//8AAP//AACAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAMAAID/AADB/wAA//8AAABxAgAAAGx0AAA4BAAAAAABAAIAICAQAAAAAADoAgAAJgAAABAQEAAAAAAAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOzs7Ozs7Ozs7Ozs7OwAAA7Ozs7Ozs7Ozs7Ozs7AAAAs7Ozs7Ozs7Ozs7OzswAACzs7Ozs7Ozs7Ozs7OzCwAAOzs7Ozs7Ozs7Ozs7Ow8AA7Ozs7Ozs7Ozs7Ozs7ALAAs7Ozs7Ozs7Ozs7OzswDwCzs7Ozs7Ozs7Ozs7OzDwsAAAAAAAAAAAAAAAAAAA8PAAAAsP//AP//////////CwAAAPD//wD//////////w8AAACw//8A//////////8LAAAA8P//AP8AAAAAAAD/DwAAALD//wD//////////wsAAADw//8A//////////8PAAAAsP//8P//////////CwAAAPD///D/AAAAAAAA/w8AAACwAAAA//////////8LAAAA/7//sP//////////DwAAAA//v/D//////////wAAAAAAv/+w/wAAAAAAAP8AAAAAAAAAAP//////////AAAAAAAAAAD//////////wAAAAAAAAAA//////////8AAAAAAAAAAP//////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////////8AAAAPAAAADgAAAA4AAAAMAAAADAAAAAgAAAAIAAAAAAAAAAAAAAAPAAAADwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA/AAAA/4AAAP/8AAD//AAA//wAAP/8AAD//////////8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAs7Ozs7OzsAA7Ozs7OzsAA7Ozs7OzswALOzs7OzswAAAAAAAAAADwALDw////8LAA8PDwAADw8ACw8P////CwAPAA8AAA8PAAv7D////wsAAAAPAAAPAAAAAA////8AAAAAAAAAAAAAAAAAAAAAAA//8AAMAAAACAAAAAgAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAgAAAAIAAAACAAAAAwAAAAPgDAAD4AwAA//8AAGwgAwAAAGx0AAA2EAAAAAAAAAAAAAAAAAAAI38kLJGF0RGxagDA8Cg2KCFDNBIIAAAA7QMAAO0DAACAfuHmAAAGACQAAAAQABAAwMDAAP//AAAB782rAAAFAAAAAAAGAAAA/////wwAAIAAAAAABAAAAAAAAAAEAAAAAQAAAGx0AAA4BAAAAAABAAIAICAQAAAAAADoAgAAJgAAABAQEAAAAAAAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB3d3d3d3d3d3d3d3d3dzAAf7i4uLi4uLi4uLi4uLgwAH+Li4uLi4uLi4uLi4uLMAB/uLi4uLi4uLi4uLi4uDAAf4uLi4uLi4uLi4uLi4swAH+4uLi4uLi4uLi4uLi4MAB/i4uLi4uLi4uLi4uLizAAf7i4uLi4uLi4uLi4uLgwAH+Li4uLi4uLi4uLi4uLMAB/uLi4uLi4uLi4uLi4uDAAf4uLi4uLi4uLi4uLi4swAH+4uLi4uLi4uLi4uLi4MAB/i4uLi4uLi4uLi4uLizAAf7i4uLi4uLi4uLi4uLgwAH+Li4uLi4uLi4uLi4uLMAB/uLi4uLi4uLi4uLi4uDAAf4uLi4uLi4uLi4uLi4swAH+4uLi4uLi4uLi4uLi4MAB//////////////////wAAeIiIiIiIiIh3d3d3d3cAAAf7i4uLi4uHAAAAAAAAAAAAf7i4uLi4cAAAAAAAAAAAAAf/////9wAAAAAAAAAAAAAAd3d3d3AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////////////////////8AAAAOAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAABgAAAAYAAAAGAAAADgAAAB8AAf//gAP//8AH///gD//////////////////8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAHd3d3d3d3cAf7i4uLi4twB/i4uLi4uHAH+4uLi4uLcAf4uLi4uLhwB/uLi4uLi3AH+Li4uLi4cAf7i4uLi4twB////////3AHi4uLh3d3cAB4uLhwAAAAAAd3dwAAAAAAAAAAAAAAAA//8AAP//AACAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAEAAAABAAAAAQAAAAMAAID/AADB/wAA//8AAABxAgAAAGx0AAA4BAAAAAABAAIAICAQAAAAAADoAgAAJgAAABAQEAAAAAAAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAOzs7Ozs7Ozs7Ozs7OwAAA7Ozs7Ozs7Ozs7Ozs7AAAAs7Ozs7Ozs7Ozs7OzswAACzs7Ozs7Ozs7Ozs7OzCwAAOzs7Ozs7Ozs7Ozs7Ow8AA7Ozs7Ozs7Ozs7Ozs7ALAAs7Ozs7Ozs7Ozs7OzswDwCzs7Ozs7Ozs7Ozs7OzDwsAAAAAAAAAAAAAAAAAAA8PAAAAsP//AP//////////CwAAAPD//wD//////////w8AAACw//8A//////////8LAAAA8P//AP8AAAAAAAD/DwAAALD//wD//////////wsAAADw//8A//////////8PAAAAsP//8P//////////CwAAAPD///D/AAAAAAAA/w8AAACwAAAA//////////8LAAAA/7//sP//////////DwAAAA//v/D//////////wAAAAAAv/+w/wAAAAAAAP8AAAAAAAAAAP//////////AAAAAAAAAAD//////////wAAAAAAAAAA//////////8AAAAAAAAAAP//////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA////////////////8AAAAPAAAADgAAAA4AAAAMAAAADAAAAAgAAAAIAAAAAAAAAAAAAAAPAAAADwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA8AAAAPAAAADwAAAA/AAAA/4AAAP/8AAD//AAA//wAAP/8AAD//////////8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAs7Ozs7OzsAA7Ozs7OzsAA7Ozs7OzswALOzs7OzswAAAAAAAAAADwALDw////8LAA8PDwAADw8ACw8P////CwAPAA8AAA8PAAv7D////wsAAAAPAAAPAAAAAA////8AAAAAAAAAAAAAAAAAAAAAAA//8AAMAAAACAAAAAgAAAAAAAAAAAAAAAAAAAAIAAAACAAAAAgAAAAIAAAACAAAAAwAAAAPgDAAD4AwAA//8AAGwgAwAAAGx0AAA2EAAAAAABAAIAEBAAAAAAAABoAwAAJgAAACAgAAAAAAAAqAwAAI4DAAAoAAAAEAAAACAAAAABABgAAAAAAEADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAAAAAAAAAAAAAAP//AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwMDAAAAAAAAAAAAAAAAAAAAAgICAwMDAgIAAwMDA//8AwMDAgIAAwMDA//8AAAAAwMDAAAAAAAAAAAAAAP//AAAAgICA//8AwMDA//8AgICA//8AwMDAgIAAwMDAAAAAwMDAAAAAAAAAAAAAAAAAAAAAgICAwMDAgIAAwMDAgIAAwMDA//8AwMDA//8AAAAAwMDAAAAAAAAAAAAAAP//AAAAgICAgIAAwMDA//8AwMDAgIAAwMDAgIAAwMDAAAAAwMDAAAAAAAAAAAAAAAAAAAAAgICAwMDA//8AwMDAgIAA//////8AwMDAgIAAAAAAwMDAAAAAAAAAAAAAAP//AAAAgICA//8AgICA//8AwMDAgIAAwMDA//8AwMDAAAAAwMDAAAAAAAAAAAAAAAAAAAAAgICAwMDAAAAAAAAAAAAAAAAAAAAAAAAAgIAAAAAAwMDAAAAAAAAAAAAAAP//AAAAgICAgIAAAAAA////////////////AAAAwMDAAAAAwMDAAAAAAAAAAAAAAAAAAAAAgICAwMDAAAAAAAAAAAAAAAAAAAAAAAAA//8AAAAAwMDAAAAAAAAAAAAAAP//AAAAgICA//8AwMDAgIAAwMDA//8AwMDAgIAAwMDAAAAAwMDAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////+AB//+AAf//wAH//4AB///AAf//gAH//8AB//+AAf//wAH//4AB///AAf//gAH//8AD/////////////ygAAAAgAAAAQAAAAAEAGAAAAAAAgAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMDAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAgIDAwMCAgADAwMD//wDAwMCAgADAwMD//wAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAACAgID//wDAwMD//wCAgID//wDAwMCAgADAwMAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAgIDAwMCAgADAwMCAgADAwMD//wDAwMD//wAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAACAgICAgADAwMD//wDAwMCAgADAwMCAgADAwMAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAgIDAwMD//wDAwMCAgAD//////wDAwMCAgAAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAACAgID//wCAgID//wDAwMCAgADAwMD//wDAwMAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAgIDAwMAAAAAAAAAAAAAAAAAAAAAAAACAgAAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAACAgICAgAAAAAD///////////////8AAADAwMAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAgIDAwMAAAAAAAAAAAAAAAAAAAAAAAAD//wAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//8AAACAgID//wDAwMCAgADAwMD//wDAwMCAgADAwMAAAADAwMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD////////////////////////////////////////////////////////////gAf//gAH//8AB//+AAf//wAH//4AB///AAf//gAH//8AB//+AAf//wAH//4AB///AA////////////////////////////////////////////wQAAABsdAAA8AAAAEJN7gAAAAAAAAB2AAAAKAAAABAAAAAPAAAAAQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIAAAACAgACAAAAAgACAAICAAACAgIAAwMDAAAAA/wAA/wAAAP//AP8AAAD/AP8A//8AAP///wCIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIRERESIiIiIhERERIiIiIiEREREiIiIiIRE9ESIiIiIhET0RIiIiIiEREREiIiIiIhIiEiIiIiIiEg=" />

	ADD OBJECT 'OleTreeView' AS olecontrol WITH ;
		Enabled = .T., ;
		Height = 265, ;
		Left = 14, ;
		Name = "OleTreeView", ;
		TabIndex = 17, ;
		Top = 107, ;
		Width = 550, ;
		ZOrderSet = 26
		*< END OBJECT: BaseClass="olecontrol"  Nombre="Imprimir.OleTreeView" Parent="Imprimir" ObjName="OleTreeView" OLEObject="C:\Windows\system32\MSCOMCTL.OCX" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACC6r1pL48wBAwAAAAADAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAigAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAJsBAAAAAAAACAAAAAIAAAD+////BAAAAAUAAAAGAAAABwAAAAkAAAAKAAAACwAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+2kEHHiYXREbFqAMDwKDYoIUM0EggAAADYOAAAYxsAALE8wWoBAAYAIgAAAB0BAADtAwAACgAAAAEAAAAB782rXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACADgAAAEhpZGVTZWxlY3Rpb24ABQAAAEwAAAAADAAAAEluZGVudGF0aW9uABEAAABODQAAAAcAAAAAAAAAAABDQAoAAABMaW5lU3R5bGUACQAAAEkKAAAAAQAAAA0AAABNb3VzZVBvaW50ZXIACQAAAEkKAAAAAAAAAA4AAABQYXRoU2VwYXJhdG9yAAoAAABIAAAAAAEAAABcBwAAAFNvcnRlZAAFAAAATAEAAAAMAAAAT0xFRHJhZ01vZGUACQAAAEkKAAAAAAAAAAwAAABPTEVEcm9wTW9kZQAJAAAASQoAAAAAAAAACwAAAEFwcGVhcmFuY2UACQAAAEkKAAAAAQAAAAwAAABCb3JkZXJTdHlsZQAJAAAASQoAAAABAAAACwAAAENoZWNrYm94ZXMABQAAAEwAAAAADgAAAAAABQBYfSkABwAAAAAAAAAFAACAxL8SAAEAAABcAB/e7L0BAAUADcASAANS4wuRj84RneMAqgBLuFEBAAAAkAFGdWxsUm93U2VsZWN0AAUAAABMAQAAAAwAAABIb3RUcmFja2luZwAFAAAATAAAAAAHAAAAU2Nyb2xsAAUAAABMkF8BAAVBcmlhbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAKAAAAU2luZ2xlU2VsAAUAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAoAQAADgMAACgAAAAgAAAAQAAAAAEABAAAAAAAgAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAgICAAMDAwAAAAP8AAP8AAAD//wD/AAAA/wD/AP//AAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADu7u7oiIAAAAAAAAAAAAAA7u7u6IiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////iAAAAAAAAAAAAAAA//////iAAAAAAAAAAAAAAP/////4gAAAAAAA" />

	ADD OBJECT 'Shape1' AS shape WITH ;
		BackStyle = 0, ;
		Height = 59, ;
		Left = 12, ;
		Name = "Shape1", ;
		SpecialEffect = 0, ;
		Top = 387, ;
		Width = 294, ;
		ZOrderSet = 5
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Shape2' AS shape WITH ;
		BackStyle = 0, ;
		Height = 47, ;
		Left = 7, ;
		Name = "Shape2", ;
		SpecialEffect = 0, ;
		Top = 9, ;
		Width = 569, ;
		ZOrderSet = 2
		*< END OBJECT: BaseClass="shape" />
	
	PROCEDURE exportarpivot
		PARAMETER LCSQL
		LCCONEXION = "ODBC;"+LEERINI("DEFAULT", "ODBC")
		AA = CREATEOBJECT("excel.application")
		AA.WORKBOOKS.ADD()
		PT = AA.ACTIVEWORKBOOK.PIVOTCACHES.ADD(2)
		PT.CONNECTION = LCCONEXION
		PT.COMMANDTYPE = 2
		PT.COMMANDTEXT = LCSQL
		PT.CREATEPIVOTTABLE(AA.ACTIVECELL, "Tabla Dinamica1",  , 1)
		AA.VISIBLE = .T.
	ENDPROC

	PROCEDURE exportarxls
		PARAMETER LCSQL
		LCCONEXION = "ODBC;"+LEERINI("DEFAULT", "ODBC")
		AA = CREATEOBJECT("excel.application")
		AA.WORKBOOKS.ADD()
		QT = AA.ACTIVESHEET.QUERYTABLES.ADD(LCCONEXION, AA.ACTIVECELL)
		QT.COMMANDTEXT = LCSQL
		QT.NAME = "Consulta desde Futura Software"
		QT.FIELDNAMES = .T.
		QT.REFRESH()
		AA.VISIBLE = .T.
	ENDPROC

	PROCEDURE filtrar
		SELECT CONTROL
		SET FILTER TO UPPER(ALLTRIM(exportar.PARAM1))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(exportar.PARAM2))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(exportar.PARAM3))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(exportar.PARAM4))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(exportar.PARAM5))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(exportar.PARAM6))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(exportar.PARAM7))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(exportar.PARAM8))==UPPER(ALLTRIM(CONTROL.VARIABLE)) 
		SELECT exportar
		GOTO TOP IN CONTROL
		*SET STEP ON
		FOR X = 1 TO 6
			OBJETO = 'caja'+ALLTRIM(STR(X))
			IF  .NOT. EOF('control')
		
				THIS.&OBJETO..VISIBLE=.T.
				THIS.&OBJETO..ETIQ.CAPTION=ALLTRIM(CONTROL.ETIQUETA)
				VALOR = CONTROL.VALUE
				VARIABLE = CONTROL.VARIABLE
				THIS.&OBJETO..REQUERY=CONTROL.REQUERY
		
				IF CONTROL.TIPO="L"
		
					VRSOURCE = CONTROL.RSOURCE
					IF CONTROL.ORIGEN='R'
						THIS.&OBJETO..LISTA.CMDSQL=VRSOURCE
						THIS.&OBJETO..LISTA.CURSOR=THIS.&OBJETO..NAME
						THIS.&OBJETO..LISTA.INIT()
					ELSE
						THIS.&OBJETO..LISTA.ROWSOURCE=""
						THIS.&OBJETO..LISTA.ROWSOURCETYPE=CONTROL.RSOURCETYP
						THIS.&OBJETO..LISTA.ROWSOURCE=VRSOURCE
						IF  .NOT. EMPTY(CONTROL.BOUNDCOL)
							THIS.&OBJETO..LISTA.BOUNDCOLUMN=CONTROL.BOUNDCOL
						ELSE
							THIS.&OBJETO..LISTA.BOUNDCOLUMN=1
						ENDIF
					ENDIF
					THIS.&OBJETO..LISTA.STYLE=CONTROL.STYLE
					THIS.&OBJETO..LISTA.VISIBLE=.T.
					THIS.&OBJETO..TEXTO.VISIBLE=.F.
					IF TYPE(VARIABLE)<>"U"
						THIS.&OBJETO..LISTA.VALUE = &VARIABLE
					ELSE
						THIS.&OBJETO..LISTA.VALUE=&VALOR
					ENDIF
				ELSE
					THIS.&OBJETO..TEXTO.INPUTMASK=ALLTRIM(CONTROL.INPUTMASK)
					THIS.&OBJETO..TEXTO.MAXLENGTH=CONTROL.MAXLENGTH
					IF TYPE(VARIABLE)<>"U"
						THIS.&OBJETO..TEXTO.VALUE = &VARIABLE
					ELSE
						THIS.&OBJETO..TEXTO.VALUE=&VALOR
					ENDIF
					THIS.&OBJETO..LISTA.VISIBLE=.F.
					THIS.&OBJETO..TEXTO.VISIBLE=.T.
				ENDIF
				THIS.&OBJETO..TEXTO.STATUSBARTEXT = ''
				IF  .NOT. EMPTY(CONTROL.DATOAYUDA)
					THIS.&OBJETO..TEXTO.DATOAYUDA = CONTROL.DATOAYUDA
					THIS.&OBJETO..TEXTO.INIT()
				ELSE
					THIS.&OBJETO..TEXTO.DATOAYUDA = ''
					THIS.&OBJETO..TEXTO.STATUSBARTEXT = THIS.&OBJETO..ETIQ.CAPTION
					THIS.&OBJETO..TEXTO.INIT()
				ENDIF
				THIS.&OBJETO..NOMBVAR=VARIABLE
				IF TYPE(VARIABLE)="U"
					PUBLIC &VARIABLE
					&VARIABLE = &VALOR
				ENDIF
				SKIP IN CONTROL
			ELSE
				THIS.&OBJETO..VISIBLE=.F.
			ENDIF
		ENDFOR
		
	ENDPROC

	PROCEDURE generardbf
		Local DESTINO, PROCEDIMIENTO, EXP_DEST
		PROCEDIMIENTO = EXPORTAR.ORIGEN
		CMDSQL = Execscript(PROCEDIMIENTO)
		EXP_DEST = EXPORTAR.DESTINO
		If  .Not. Empty(used(EXP_DEST))
			Select (EXP_DEST)
		ENDIF
	ENDPROC

	PROCEDURE Init
		Parameter LNPOSICION, LCPARAMETRO
		
		If Type("THIS.oleTreeview")<>"O" .Or. Isnull(This.OLETREEVIEW)
			Return .F.
		Endif
		If Type("THIS.oleImagesList")<>"O" .Or. Isnull(This.OLEIMAGESLIST)
			Return .F.
		ENDIF
		
		
		TEXT TO _cmdSQL
			SELECT     f.IdFamilia, f.Descripcion AS Familia, l.IdLinea, l.Descripcion AS Linea, p.IdProducto, p.Descripcion AS Producto
			FROM         st_Producto AS p LEFT OUTER JOIN
			                      st_Linea AS l ON p.IdEmpresa = l.IdEmpresa AND p.Linea = l.IdLinea LEFT OUTER JOIN
			                      st_Familia AS f ON p.IdEmpresa = f.IdEmpresa AND p.Familia = f.IdFamilia
			                      inner join vt_Precios pr on p.Idempresa=pr.IdEmpresa and p.IdPRoducto = pr.IDProducto and pr.IdLista=?LCPARAMETRO
			                      where p.idempresa=?oapp.empresa and IdTipo in ('S') and pr.Moneda='GS' 
			                      and Activo=1 and (isnull(FiltraSucursal,0)=0 or exists(Select idproducto from st_ProductoSucursal s where p.IdEmpresa=s.IdEmpresa and p.IdProducto=s.IdProducto and s.Sucursal=?oApp.Sucursal))
			                      order by Familia,Linea,Producto
		ENDTEXT
		
		sql(_cmdSQL,'cProductos')
		                 
		                   
		
		
		Thisform.OLETREEVIEW.DoVerb(-1)
		This.OLETREEVIEW.IMAGELIST = This.OLEIMAGESLIST
		O = Thisform.OLETREEVIEW.NODES
		O.Clear
		*SET STEP ON
		*Cargamos las familias
		SELECT Distinct IdFamilia,Familia FROM cProductos INTO CURSOR cFam
		SELECT cFam
		SCAN
			IF NOT ISNULL(Familia)
				O.Add( , 1, Alltrim("F"+IdFamilia+"_"), Alltrim(Familia), 1, 2)
			ENDIF
		ENDSCAN
		
		*Cargamos las Lineas
		SELECT Distinct IdFamilia,IdLinea,Linea FROM cProductos INTO CURSOR cLinea
		SELECT cLinea
		SCAN
			Padre=NVL("F"+IdFamilia+"_",'')
			IF NOT ISNULL(Linea)
				IF EMPTY(padre)
					O.Add( , 1, Alltrim("L"+IdLinea+"_"), Alltrim(Linea), 1, 2)
				ELSE
					O.Add( Padre, 4, Alltrim("L"+IdLinea+"_"), Alltrim(Linea), 1, 2)		
				ENDIF
					
				Padre="F"+IdFamilia+"_"
			ENDIF
		ENDSCAN
		
		
		SELECT cProductos
		
		*SET STEP ON
		Scan 
			Padre=''
			IF NOT ISNULL(Familia)
			*	O.Add( , 1, Alltrim(IdFamilia+"_"), Alltrim(Familia), 1, 2)
				Padre="F"+IdFamilia+"_"
			ENDIF
			IF NOT ISNULL(Linea)
				IF EMPTY(padre)
			*		O.Add( , 1, Alltrim(IdLinea+"_"), Alltrim(Linea), 1, 2)
				ELSE
			*		O.Add( Padre, 4, Alltrim(IdLinea+"_"), Alltrim(Linea), 1, 2)		
				ENDIF
					
				Padre="L"+IdLinea+"_"
			ENDIF
			
			IF EMPTY(padre)
				O.Add( , 1, Alltrim("P"+IdProducto), Alltrim(Producto), 3, 3)
			ELSE
				O.Add( Padre, 4, Alltrim("P"+IdProducto), Alltrim(Producto), 3, 3)
			ENDIF
			
			
			
		*!*			
		*!*		
		*!*		If IDOBJETO<>0
		*!*			Replace DISPONIBLE With OAPP.PERMISOS(IDOBJETO)
		*!*		Endif
		*!*		If LCAGRUPACION='C'
		*!*			If Alltrim(Parent)='0_'
		*!*				O.Add( , 1, Alltrim(Key), Alltrim(Text), 1, 2)
		*!*			Else
		*!*				If DISPONIBLE
		*!*					If Empty(ORIGEN)
		*!*						O.Add(Alltrim(Parent), 4, Alltrim(Key), Alltrim(Text), 1, 2)
		*!*					Else
		*!*						O.Add(Alltrim(Parent), 4, Alltrim(Key), Alltrim(Text), 3, 3)
		*!*					Endif
		*!*				Else
		*!*					O.Add(Alltrim(Parent), 4, Alltrim(Key), Alltrim(Text), 4, 4)
		*!*				Endif
		*!*			Endif
		*!*		Else
		*!*			If DISPONIBLE
		*!*				O.Add( , 1, Alltrim(Key), Alltrim(Text), 3, 3)
		*!*			Else
		*!*				O.Add( , 1, Alltrim(Key), Alltrim(Text), 4, 4)
		*!*			Endif
		*!*		Endif
		Endscan
		Thisform.OLETREEVIEW.Font.Size = 8
		Thisform.OLETREEVIEW.LABELEDIT = 1
		Thisform.OLETREEVIEW.LINESTYLE = 1
		Thisform.OLETREEVIEW.Sorted = .T.
		
		Thisform.Refresh()
		
	ENDPROC

	PROCEDURE Load
		DO SETEO
		USE SHARED datos!exportar ORDER key IN 0
		USE SHARED datos!control IN 0
		SELECT EXPORTAR
		CURSORSETPROP("Buffering", 5)
		   
	ENDPROC

	PROCEDURE Unload
		RETURN SUBSTR(this.Tag,2)
	ENDPROC

	PROCEDURE Agrupar.Init
		PUBLIC LCAGRUPACION
		LCAGRUPACION = 'C'
	ENDPROC

	PROCEDURE Agrupar.InteractiveChange
		SELECT EXPORTAR
		DO CASE
		CASE THIS.VALUE=1
		LCAGRUPACION = 'C'
		SET FILTER TO
		CASE THIS.VALUE=2
		LCAGRUPACION = 'A'
		SET FILTER TO PARENT<>'0_'
		ENDCASE
		*THISFORM.INIT()
	ENDPROC

	PROCEDURE Command1.Click
		THISFORM.RELEASE()
	ENDPROC

	PROCEDURE Command1.DragDrop
		LPARAMETERS OSOURCE, NXCOORD, NYCOORD
		THIS.SHOWWHATSTHIS
	ENDPROC

	PROCEDURE descrip.Init
		THIS.CAPTION = ''
	ENDPROC

	PROCEDURE ejecutar.Click
		thisform.release()
		
	ENDPROC

	PROCEDURE OleTreeView.DblClick
		*** ActiveX Control Event ***
		
	ENDPROC

	PROCEDURE OleTreeView.NodeClick
		Lparameters Node
		thisform.Tag=Node.Key
		thisform.ejecutar.Enabled=LEFT(thisform.Tag,1)='P'
		IF LEFT(thisform.Tag,1)='P'
		
		ENDIF
		
		
		
	ENDPROC

ENDDEFINE
