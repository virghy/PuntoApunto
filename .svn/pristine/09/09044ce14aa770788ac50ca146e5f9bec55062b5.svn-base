*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="lmcal.vcx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
DEFINE CLASS cmdcal AS tscommandbutton OF "tsbase.vcx" 		&& Boton que llama al calendario
 	*< CLASSDATA: Baseclass="commandbutton" Timestamp="" Scale="Pixels" Uniqueid="" />

	*<DefinedPropArrayMethod>
		*p: txtnombre		&& Nombre del objeto Text que recibirá el valor Date o DateTime retornado
	*</DefinedPropArrayMethod>

	Caption = ""
	editable = .T.
	Height = 24
	Name = "cmdcal"
	Picture = lmcal.bmp
	TabIndex = 27
	Width = 24
	
	PROCEDURE Click
		IF NOT EMPTY(THIS.txtNombre)
		  lcTxtValor = "This.Parent." + THIS.txtNombre + ".Value"
		ELSE
		  lcTxtValor = "DATE()"
		ENDIF
		loLMCal = NEWOBJECT("frmCal",THIS.CLASSLIBRARY,NULL,EVALUATE(lcTxtValor))
		loLMCal.SHOW(1)
		IF NOT EMPTY(THIS.txtNombre)
		  lcTxtValor = "This.Parent." + THIS.txtNombre
		  &lcTxtValor..VALUE = loLMCal.VALUE
		  &lcTxtValor..SETFOCUS
		ENDIF
		RELEASE loLMCal
		
	ENDPROC

	PROCEDURE Refresh
		If This.EDITABLE
			this.Enabled=thisform.editmode
		ENDIF
			
		
	ENDPROC

ENDDEFINE

DEFINE CLASS diacal AS container 		&& Objeto Día
 	*< CLASSDATA: Baseclass="container" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="lbl" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*p: value		&& Especifica el estado actual de un control.
	*</DefinedPropArrayMethod>

	BackColor = 255,255,255
	BorderWidth = 0
	Height = 16
	MousePointer = 14
	Name = "diacal"
	SpecialEffect = 0
	value = {}		&& Especifica el estado actual de un control.
	Width = 32

	ADD OBJECT 'lbl' AS label WITH ;
		Alignment = 2, ;
		BackStyle = 0, ;
		Caption = "31", ;
		Height = 14, ;
		Left = 2, ;
		MousePointer = 14, ;
		Name = "lbl", ;
		Top = 0, ;
		Width = 30
		*< END OBJECT: BaseClass="label" />
	
	PROCEDURE Click
		THIS.PARENT.VALUE = THIS.VALUE
		THIS.PARENT._Refresh()
		
	ENDPROC

	PROCEDURE DblClick
		THIS.PARENT.VALUE = THIS.VALUE
		THIS.PARENT._Release()
		
	ENDPROC

	PROCEDURE lbl.Click
		THIS.PARENT.CLICK
		
	ENDPROC

	PROCEDURE lbl.DblClick
		THIS.PARENT.DBLCLICK
		
	ENDPROC

ENDDEFINE

DEFINE CLASS frmcal AS form 		&& Formulario Calendario
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="Pixels" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="cmdSig" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdAnt" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblD1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblD2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblD3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblD4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblD5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblD6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="lblD7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdCancelar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="spnAnio" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmbMes" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdOk" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdHoy" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt12" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt13" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt14" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt15" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt16" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt17" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt21" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt22" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt23" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt24" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt25" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt26" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt27" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt31" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt32" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt33" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt34" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt35" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt36" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt37" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt41" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt42" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt43" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt44" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt45" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt46" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt47" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt51" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt52" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt53" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt54" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt55" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt56" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt57" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt61" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt62" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt63" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt64" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt65" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt66" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cnt67" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: *_refresh
		*m: *_release
		*p: editmode
		*p: fechahora		&& .T. si recibe y retorna DateTime
		*p: oldvalue
		*p: value		&& Valor que retorna el calendario (Date ó DateTime)
	*</DefinedPropArrayMethod>

	AutoCenter = .T.
	BorderStyle = 2
	Caption = "Seleccione una fecha"
	ControlBox = .F.
	DoCreate = .T.
	editmode = .T.
	Height = 176
	MaxButton = .F.
	MinButton = .F.
	Name = "frmcal"
	value = (date())		&& Valor que retorna el calendario (Date ó DateTime)
	Width = 234
	WindowType = 1

	ADD OBJECT 'cmbMes' AS combobox WITH ;
		ColumnCount = 0, ;
		ColumnWidths = "", ;
		FirstElement = 1, ;
		FontBold = .T., ;
		FontSize = 9, ;
		Height = 22, ;
		Left = 31, ;
		Name = "cmbMes", ;
		NumberOfElements = 0, ;
		RowSource = "Enero,Febrero,Marzo,Abril,Mayo,Junio,Julio,Agosto,Setiembre,Octubre,Noviembre,Diciembre", ;
		RowSourceType = 1, ;
		Style = 2, ;
		TabIndex = 57, ;
		Top = 3, ;
		Width = 110
		*< END OBJECT: BaseClass="combobox" />

	ADD OBJECT 'cmdAnt' AS commandbutton WITH ;
		Caption = "", ;
		Height = 22, ;
		Left = 7, ;
		Name = "cmdAnt", ;
		Picture = lmizq.bmp, ;
		TabIndex = 4, ;
		Top = 3, ;
		Width = 22
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdCancelar' AS commandbutton WITH ;
		Cancel = .T., ;
		Caption = "\<Cancelar", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 170, ;
		Name = "cmdCancelar", ;
		TabIndex = 2, ;
		Top = 148, ;
		Width = 60
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdHoy' AS commandbutton WITH ;
		Caption = ("\<Hoy: " + dtoc(date())), ;
		FontBold = .T., ;
		FontSize = 8, ;
		ForeColor = 255,0,0, ;
		Height = 24, ;
		Left = 4, ;
		Name = "cmdHoy", ;
		TabIndex = 3, ;
		Top = 148, ;
		Width = 96
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdOk' AS commandbutton WITH ;
		Caption = "\<Aceptar", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 104, ;
		Name = "cmdOk", ;
		TabIndex = 1, ;
		Top = 148, ;
		Width = 60
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdSig' AS commandbutton WITH ;
		Caption = "", ;
		Height = 22, ;
		Left = 206, ;
		Name = "cmdSig", ;
		Picture = lmder.bmp, ;
		TabIndex = 5, ;
		Top = 3, ;
		Width = 22
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cnt11' AS diacal WITH ;
		Left = 5, ;
		Name = "cnt11", ;
		Top = 47, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt12' AS diacal WITH ;
		Left = 37, ;
		Name = "cnt12", ;
		Top = 47, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt13' AS diacal WITH ;
		Left = 69, ;
		Name = "cnt13", ;
		Top = 47, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt14' AS diacal WITH ;
		Left = 101, ;
		Name = "cnt14", ;
		Top = 47, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt15' AS diacal WITH ;
		Left = 133, ;
		Name = "cnt15", ;
		Top = 47, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt16' AS diacal WITH ;
		Left = 165, ;
		Name = "cnt16", ;
		Top = 47, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt17' AS diacal WITH ;
		Left = 197, ;
		Name = "cnt17", ;
		Top = 47, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt21' AS diacal WITH ;
		Left = 5, ;
		Name = "cnt21", ;
		Top = 63, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt22' AS diacal WITH ;
		Left = 37, ;
		Name = "cnt22", ;
		Top = 63, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt23' AS diacal WITH ;
		Left = 69, ;
		Name = "cnt23", ;
		Top = 63, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt24' AS diacal WITH ;
		Left = 101, ;
		Name = "cnt24", ;
		Top = 63, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt25' AS diacal WITH ;
		Left = 133, ;
		Name = "cnt25", ;
		Top = 63, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt26' AS diacal WITH ;
		Left = 165, ;
		Name = "cnt26", ;
		Top = 63, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt27' AS diacal WITH ;
		Left = 197, ;
		Name = "cnt27", ;
		Top = 63, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt31' AS diacal WITH ;
		Left = 5, ;
		Name = "cnt31", ;
		Top = 79, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt32' AS diacal WITH ;
		Left = 37, ;
		Name = "cnt32", ;
		Top = 79, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt33' AS diacal WITH ;
		Left = 69, ;
		Name = "cnt33", ;
		Top = 79, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt34' AS diacal WITH ;
		Left = 101, ;
		Name = "cnt34", ;
		Top = 79, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt35' AS diacal WITH ;
		Left = 133, ;
		Name = "cnt35", ;
		Top = 79, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt36' AS diacal WITH ;
		Left = 165, ;
		Name = "cnt36", ;
		Top = 79, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt37' AS diacal WITH ;
		Left = 197, ;
		Name = "cnt37", ;
		Top = 79, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt41' AS diacal WITH ;
		Left = 5, ;
		Name = "cnt41", ;
		Top = 95, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt42' AS diacal WITH ;
		Left = 37, ;
		Name = "cnt42", ;
		Top = 95, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt43' AS diacal WITH ;
		Left = 69, ;
		Name = "cnt43", ;
		Top = 95, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt44' AS diacal WITH ;
		Left = 101, ;
		Name = "cnt44", ;
		Top = 95, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt45' AS diacal WITH ;
		Left = 133, ;
		Name = "cnt45", ;
		Top = 95, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt46' AS diacal WITH ;
		Left = 165, ;
		Name = "cnt46", ;
		Top = 95, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt47' AS diacal WITH ;
		Left = 197, ;
		Name = "cnt47", ;
		Top = 95, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt51' AS diacal WITH ;
		Left = 5, ;
		Name = "cnt51", ;
		Top = 111, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt52' AS diacal WITH ;
		Left = 37, ;
		Name = "cnt52", ;
		Top = 111, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt53' AS diacal WITH ;
		Left = 69, ;
		Name = "cnt53", ;
		Top = 111, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt54' AS diacal WITH ;
		Left = 101, ;
		Name = "cnt54", ;
		Top = 111, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt55' AS diacal WITH ;
		Left = 133, ;
		Name = "cnt55", ;
		Top = 111, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt56' AS diacal WITH ;
		Left = 165, ;
		Name = "cnt56", ;
		Top = 111, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt57' AS diacal WITH ;
		Left = 197, ;
		Name = "cnt57", ;
		Top = 111, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt61' AS diacal WITH ;
		Left = 5, ;
		Name = "cnt61", ;
		Top = 127, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt62' AS diacal WITH ;
		Left = 37, ;
		Name = "cnt62", ;
		Top = 127, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt63' AS diacal WITH ;
		Left = 69, ;
		Name = "cnt63", ;
		Top = 127, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt64' AS diacal WITH ;
		Left = 101, ;
		Name = "cnt64", ;
		Top = 127, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt65' AS diacal WITH ;
		Left = 133, ;
		Name = "cnt65", ;
		Top = 127, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt66' AS diacal WITH ;
		Left = 165, ;
		Name = "cnt66", ;
		Top = 127, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'cnt67' AS diacal WITH ;
		Left = 197, ;
		Name = "cnt67", ;
		Top = 127, ;
		lbl.Name = "lbl"
		*< END OBJECT: ClassLib="lmcal.vcx" BaseClass="container" />

	ADD OBJECT 'lblD1' AS label WITH ;
		Alignment = 2, ;
		AutoSize = .F., ;
		BackStyle = 0, ;
		Caption = "Dom", ;
		Height = 16, ;
		Left = 5, ;
		Name = "lblD1", ;
		TabIndex = 6, ;
		Top = 31, ;
		Width = 32
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lblD2' AS label WITH ;
		Alignment = 2, ;
		AutoSize = .F., ;
		BackStyle = 0, ;
		Caption = "Lun", ;
		Height = 16, ;
		Left = 37, ;
		Name = "lblD2", ;
		TabIndex = 7, ;
		Top = 31, ;
		Width = 32
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lblD3' AS label WITH ;
		Alignment = 2, ;
		AutoSize = .F., ;
		BackStyle = 0, ;
		Caption = "Mar", ;
		Height = 16, ;
		Left = 69, ;
		Name = "lblD3", ;
		TabIndex = 8, ;
		Top = 31, ;
		Width = 32
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lblD4' AS label WITH ;
		Alignment = 2, ;
		AutoSize = .F., ;
		BackStyle = 0, ;
		Caption = "Mié", ;
		Height = 16, ;
		Left = 101, ;
		Name = "lblD4", ;
		TabIndex = 9, ;
		Top = 31, ;
		Width = 32
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lblD5' AS label WITH ;
		Alignment = 2, ;
		AutoSize = .F., ;
		BackStyle = 0, ;
		Caption = "Jue", ;
		Height = 16, ;
		Left = 133, ;
		Name = "lblD5", ;
		TabIndex = 10, ;
		Top = 31, ;
		Width = 32
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lblD6' AS label WITH ;
		Alignment = 2, ;
		AutoSize = .F., ;
		BackStyle = 0, ;
		Caption = "Vie", ;
		Height = 16, ;
		Left = 165, ;
		Name = "lblD6", ;
		TabIndex = 11, ;
		Top = 31, ;
		Width = 32
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'lblD7' AS label WITH ;
		Alignment = 2, ;
		AutoSize = .F., ;
		BackStyle = 0, ;
		Caption = "Sáb", ;
		Height = 16, ;
		Left = 197, ;
		Name = "lblD7", ;
		TabIndex = 12, ;
		Top = 31, ;
		Width = 32
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'spnAnio' AS spinner WITH ;
		FontBold = .T., ;
		FontSize = 9, ;
		Height = 22, ;
		InputMask = "9999", ;
		KeyboardHighValue = 9999, ;
		KeyboardLowValue = 100, ;
		Left = 141, ;
		Name = "spnAnio", ;
		SpinnerHighValue = 9999.00, ;
		SpinnerLowValue = 100.00, ;
		TabIndex = 56, ;
		Top = 3, ;
		Value = 2005, ;
		Width = 62
		*< END OBJECT: BaseClass="spinner" />
	
	PROCEDURE Init
		LPARAMETERS td
		IF NOT EMPTY(td) AND VARTYPE(td) $ "DT"
		  THIS.OldValue = td
		  IF VARTYPE(td)="D"
		    THIS.VALUE = td
		  ELSE
		    THIS.VALUE = TTOD(td)
		    THIS.FechaHora = .T.
		  ENDIF
		ELSE
		  THIS.VALUE = DATE()
		ENDIF
		THIS._Refresh()
		
	ENDPROC

	PROCEDURE _refresh
		LOCAL ldIni, lnI, lnJ, lc, lo
		THIS.cmbMes.VALUE = MONTH(THIS.VALUE)
		THIS.spnAnio.VALUE = YEAR(THIS.VALUE)
		ldIni = DATE(YEAR(THIS.VALUE),MONTH(THIS.VALUE),1) - DOW(DATE(YEAR(THIS.VALUE),MONTH(THIS.VALUE),1),1) + 1
		FOR lnI = 1 TO 6
		  FOR lnJ = 1 TO 7
		    lc = "This.cnt" + STR(lnI,1) + STR(lnj,1)
		    lo = &lc
		    lo.VALUE = ldIni
		    lo.lbl.CAPTION = ALLTRIM(STR(DAY(ldIni)))
		    lo.BACKCOLOR = IIF(ldIni = THIS.VALUE, 13948116, 16777215)
		    IF ldIni = DATE()
		      lo.lbl.FORECOLOR = 255 && rojo
		      lo.lbl.FONTBOLD = .T.
		    ELSE
		      lo.lbl.FORECOLOR = IIF(MONTH(ldIni) = MONTH(THIS.VALUE), 0, 12632256)
		      lo.lbl.FONTBOLD = .F.
		    ENDIF
		    ldIni = ldIni + 1
		  ENDFOR
		ENDFOR
		
	ENDPROC

	PROCEDURE _release
		IF THIS.FechaHora
		  THIS.VALUE = DTOT(THIS.VALUE)
		ENDIF
		THIS.HIDE()
		
	ENDPROC

	PROCEDURE cmbMes.Init
		THIS.VALUE = MONTH(THIS.PARENT.VALUE)
		
	ENDPROC

	PROCEDURE cmbMes.InteractiveChange
		LOCAL ld, ln
		WITH THIS.PARENT
		  ld = DATE(YEAR(.VALUE),THIS.VALUE,DAY(.VALUE))
		  ln = 1
		  DO WHILE EMPTY(ld)
		    ld = DATE(YEAR(.VALUE),THIS.VALUE,DAY(.VALUE)-ln)
		    ln = ln + 1
		  ENDDO
		  .VALUE = ld
		ENDWITH
		THIS.PARENT._Refresh()
		
	ENDPROC

	PROCEDURE cmdAnt.Click
		THIS.PARENT.VALUE = GOMONTH(THIS.PARENT.VALUE, -1)
		THIS.PARENT._Refresh()
		
	ENDPROC

	PROCEDURE cmdCancelar.Click
		THIS.PARENT.VALUE = THIS.PARENT.OldValue
		THIS.PARENT.HIDE()
		
	ENDPROC

	PROCEDURE cmdHoy.Click
		THIS.PARENT.VALUE = DATE()
		THIS.PARENT._Refresh()
		
	ENDPROC

	PROCEDURE cmdOk.Click
		THIS.PARENT._Release()
		
	ENDPROC

	PROCEDURE cmdSig.Click
		THIS.PARENT.VALUE = GOMONTH(THIS.PARENT.VALUE, 1)
		THIS.PARENT._Refresh()
		
	ENDPROC

	PROCEDURE spnAnio.DownClick
		LOCAL ld
		WITH THIS.PARENT
		  ld = DATE(This.VALUE,MONTH(.VALUE),DAY(.VALUE))
		  IF EMPTY(ld)
		    ld = DATE(This.VALUE,MONTH(.VALUE),DAY(.VALUE)-1)
		  ENDIF
		  .VALUE = ld
		ENDWITH
		THIS.PARENT._Refresh()
	ENDPROC

	PROCEDURE spnAnio.Init
		THIS.VALUE = YEAR(THIS.PARENT.VALUE)
		
	ENDPROC

	PROCEDURE spnAnio.UpClick
		LOCAL ld
		WITH THIS.PARENT
		  ld = DATE(This.VALUE,MONTH(.VALUE),DAY(.VALUE))
		  IF EMPTY(ld)
		    ld = DATE(This.VALUE,MONTH(.VALUE),DAY(.VALUE)-1)
		  ENDIF
		  .VALUE = ld
		ENDWITH
		THIS.PARENT._Refresh()
	ENDPROC

	PROCEDURE spnAnio.Valid
		LOCAL ld
		WITH THIS.PARENT
		  ld = DATE(This.VALUE,MONTH(.VALUE),DAY(.VALUE))
		  IF EMPTY(ld)
		    ld = DATE(This.VALUE,MONTH(.VALUE),DAY(.VALUE)-1)
		  ENDIF
		  .VALUE = ld
		ENDWITH
		THIS.PARENT._Refresh()
	ENDPROC

ENDDEFINE
