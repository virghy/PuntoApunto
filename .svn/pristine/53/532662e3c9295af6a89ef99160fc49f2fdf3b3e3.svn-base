*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="cn_cuentas.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*


*
#INCLUDE "..\include\tastrade.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Cursor2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cursor3" UniqueID="" Timestamp="" />

	DataSource = .NULL.
	Height = 437
	InitialSelectedAlias = "cuentas"
	Left = 80
	Name = "Dataenvironment"
	Top = 61
	Width = 520

	ADD OBJECT 'Cursor1' AS cursor WITH ;
		Alias = "cn_presupuesto", ;
		BufferModeOverride = 5, ;
		CursorSource = "cn_presupuesto", ;
		Database = ..\data\datos.dbc, ;
		Height = 90, ;
		Left = 255, ;
		Name = "Cursor1", ;
		NoDataOnLoad = .T., ;
		Top = 45, ;
		Width = 91
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor2' AS cursor WITH ;
		Alias = "cdetalle_cuenta", ;
		BufferModeOverride = 5, ;
		CursorSource = "cnt_cDetalleCuenta", ;
		Database = ..\data\datos.dbc, ;
		Height = 130, ;
		Left = 13, ;
		Name = "Cursor2", ;
		NoDataOnLoad = .T., ;
		Top = 41, ;
		Width = 140
		*< END OBJECT: BaseClass="cursor" />

	ADD OBJECT 'Cursor3' AS cursor WITH ;
		Alias = "cCuentas", ;
		CursorSource = "cnt_cuentas", ;
		Database = ..\data\datos.dbc, ;
		Height = 160, ;
		Left = 250, ;
		Name = "Cursor3", ;
		NoDataOnLoad = .F., ;
		Top = 199, ;
		Width = 181
		*< END OBJECT: BaseClass="cursor" />
	
	PROCEDURE BeforeOpenTables
		DO SETEO
	ENDPROC

ENDDEFINE

DEFINE CLASS tsmaintform1 AS tsmaintform OF "..\libs\tsbase.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Ts3dshape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tscommandbutton2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tscommandbutton3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Label_boton1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Label_boton2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Label_boton3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.oleImagesList" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.ArbolCuenta" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tslabel1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Container1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Container1.txtCuenta" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Container1.lblCuenta" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Container1.txtDescripcion" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Container1.lblDescripción" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Container1.txtAbreviatura" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Container1.Tstextbox4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Container1.Tstextbox1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Container1.Tslabel1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Container1.chkAsentable" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Container1.chkVigente" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Container1.Tstextbox2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Container1.Tslabel2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Container1.Tstextbox3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Container1.Tslabel3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Container1.lblAbreviatura" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Container1.Tslabel4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.grdMovimiento" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.grdMovimiento.Asiento.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.grdMovimiento.Asiento.Campo_clave1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.grdMovimiento.Fecha.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.grdMovimiento.Fecha.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.grdMovimiento.Debe.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.grdMovimiento.Debe.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.grdMovimiento.Haber.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.grdMovimiento.Haber.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.grdMovimiento.Centro.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.grdMovimiento.Centro.Cbocentro1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.grdMovimiento.Concepto.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.grdMovimiento.Concepto.Cboconcepto1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.grdMovimiento.Documento.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.grdMovimiento.Documento.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.totales" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.totales.TotalDebe" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.totales.TotalHaber" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.totales.Saldo" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page4.totales.Tslabel7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page3.lblCuenta" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page3.grdVdetalle" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page3.grdVdetalle.Debe.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page3.grdVdetalle.Debe.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page3.grdVdetalle.Centro.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page3.grdVdetalle.Centro.Centro" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page3.grdVdetalle.Documento.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page3.grdVdetalle.Documento.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page3.totales" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: *cargararbol
		*m: *newkey
		*p: key
	*</DefinedPropArrayMethod>

	campos = idEmpresa
	Caption = "Plan de Cuentas"
	detalle = .F.
	DoCreate = .T.
	grupoimpresion = Cuentas
	Height = 439
	Name = "Tsmaintform1"
	navegador = .F.
	tabla1 = cCuentas
	tabla2 = cn_presupuesto
	valores = oApp.Empresa
	Width = 940
	WindowState = 0
	lblRequerido.Name = "lblRequerido"
	Pageframe1.ActivePage = 1
	Pageframe1.ErasePage = .T.
	Pageframe1.Height = 444
	Pageframe1.Left = -2
	Pageframe1.Name = "Pageframe1"
	Pageframe1.Page1.Name = "Page1"
	Pageframe1.Page1.PageOrder = 1
	Pageframe1.Page2.grdList.Name = "grdList"
	Pageframe1.Page2.Name = "Page2"
	Pageframe1.Page2.PageOrder = 4
	Pageframe1.Page3.Caption = "\<Movimientos"
	Pageframe1.Page3.FontSize = 8
	Pageframe1.Page3.Name = "Page4"
	Pageframe1.Page3.PageOrder = 2
	Pageframe1.Page4.Caption = "Presupuesto"
	Pageframe1.Page4.FontSize = 8
	Pageframe1.Page4.Name = "Page3"
	Pageframe1.Page4.PageOrder = 3
	Pageframe1.PageCount = 4
	Pageframe1.TabStretch = 1
	Pageframe1.TabStyle = 0
	Pageframe1.Top = 0
	Pageframe1.Width = 938

	ADD OBJECT 'Pageframe1.Page1.ArbolCuenta' AS olecontrol WITH ;
		Enabled = .T., ;
		Height = 348, ;
		Left = 22, ;
		Name = "ArbolCuenta", ;
		TabIndex = 17, ;
		Top = 10, ;
		Width = 543, ;
		ZOrderSet = 15
		*< END OBJECT: BaseClass="olecontrol"  Nombre="Tsmaintform1.Pageframe1.Page1.ArbolCuenta" Parent="Tsmaintform1.Pageframe1.Page1" ObjName="ArbolCuenta" OLEObject="C:\Windows\system32\MSCOMCTL.OCX" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANA30ySQqc4BAwAAAAADAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAigAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAJsBAAAAAAAACAAAAAIAAAD+////BAAAAAUAAAAGAAAABwAAAAkAAAAKAAAACwAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+2kEHHiYXREbFqAMDwKDYoIUM0EggAAAAfOAAA+CMAALE8wWoBAAYAIgAAAB0BAAARAgAACgAAAAEAAAAB782rXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACADgAAAEhpZGVTZWxlY3Rpb24ABQAAAEwAAAAADAAAAEluZGVudGF0aW9uABEAAABODQAAAAcAAAAAAAAAAAA0QAoAAABMaW5lU3R5bGUACQAAAEkKAAAAAQAAAA0AAABNb3VzZVBvaW50ZXIACQAAAEkKAAAAAAAAAA4AAABQYXRoU2VwYXJhdG9yAAoAAABIAAAAAAEAAABcBwAAAFNvcnRlZAAFAAAATAEAAAAMAAAAT0xFRHJhZ01vZGUACQAAAEkKAAAAAAAAAAwAAABPTEVEcm9wTW9kZQAJAAAASQoAAAAAAAAACwAAAEFwcGVhcmFuY2UACQAAAEkKAAAAAQAAAAwAAABCb3JkZXJTdHlsZQAJAAAASQoAAAABAAAACwAAAENoZWNrYm94ZXMABQAAAEwAAAAADgAAAAAABQAolzEABwAAAAAAAAAFAACAROkSAAEAAABcAB/e7L0BAAUAjekSAANS4wuRj84RneMAqgBLuFEBAAAAkAFGdWxsUm93U2VsZWN0AAUAAABMAQAAAAwAAABIb3RUcmFja2luZwAFAAAATAAAAAAHAAAAU2Nyb2xsAAUAAABMREIBAAVBcmlhbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAKAAAAU2luZ2xlU2VsAAUAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAoAQAADgMAACgAAAAgAAAAQAAAAAEABAAAAAAAgAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAgICAAMDAwAAAAP8AAP8AAAD//wD/AAAA/wD/AP//AAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADu7u7oiIAAAAAAAAAAAAAA7u7u6IiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////iAAAAAAAAAAAAAAA//////iAAAAAAAAAAAAAAP/////4gAAAAAAA" />

	ADD OBJECT 'Pageframe1.Page1.Container1' AS container WITH ;
		BackStyle = 0, ;
		BorderWidth = 0, ;
		Height = 348, ;
		Left = 596, ;
		Name = "Container1", ;
		SpecialEffect = 2, ;
		Style = 0, ;
		Top = 68, ;
		Width = 336
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'Pageframe1.Page1.Container1.chkAsentable' AS tscheckbox WITH ;
		Alignment = 1, ;
		Caption = "Asentable ", ;
		Comment = "", ;
		ControlSource = "cCuentas.asentable", ;
		editable = .T., ;
		FontBold = .T., ;
		Height = 16, ;
		Left = 8, ;
		Name = "chkAsentable", ;
		TabIndex = 4, ;
		Top = 80, ;
		Width = 90, ;
		ZOrderSet = 8
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Pageframe1.Page1.Container1.chkVigente' AS tscheckbox WITH ;
		Alignment = 1, ;
		Caption = "Vigente", ;
		Comment = "", ;
		ControlSource = "cCuentas.vigente", ;
		editable = .T., ;
		FontBold = .T., ;
		Height = 16, ;
		Left = 8, ;
		Name = "chkVigente", ;
		TabIndex = 5, ;
		Top = 104, ;
		Width = 90, ;
		ZOrderSet = 9
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Pageframe1.Page1.Container1.lblAbreviatura' AS tslabel WITH ;
		Caption = "Abreviatura", ;
		Height = 16, ;
		Left = 14, ;
		Name = "lblAbreviatura", ;
		TabIndex = 12, ;
		Top = 56, ;
		Width = 66, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Container1.lblCuenta' AS tslabel WITH ;
		Caption = "Cuenta", ;
		Height = 16, ;
		Left = 39, ;
		Name = "lblCuenta", ;
		TabIndex = 10, ;
		Top = 8, ;
		Width = 41, ;
		ZOrderSet = 3
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Container1.lblDescripción' AS tslabel WITH ;
		Caption = "Descripción", ;
		Height = 16, ;
		Left = 13, ;
		Name = "lblDescripción", ;
		TabIndex = 11, ;
		Top = 32, ;
		Width = 67, ;
		ZOrderSet = 5
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Container1.Tslabel1' AS tslabel WITH ;
		Caption = "Desc. Corta", ;
		Height = 16, ;
		Left = 18, ;
		Name = "Tslabel1", ;
		TabIndex = 13, ;
		Top = 134, ;
		Width = 66, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Container1.Tslabel2' AS tslabel WITH ;
		Caption = "Campo Usr1", ;
		Height = 16, ;
		Left = 18, ;
		Name = "Tslabel2", ;
		TabIndex = 16, ;
		Top = 230, ;
		Width = 66, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Container1.Tslabel3' AS tslabel WITH ;
		Caption = "Campo Usr2", ;
		Height = 16, ;
		Left = 18, ;
		Name = "Tslabel3", ;
		TabIndex = 15, ;
		Top = 254, ;
		Width = 66, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Container1.Tslabel4' AS tslabel WITH ;
		Caption = "Campo Usr3", ;
		Height = 16, ;
		Left = 18, ;
		Name = "Tslabel4", ;
		TabIndex = 14, ;
		Top = 278, ;
		Width = 66, ;
		ZOrderSet = 7
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Container1.Tstextbox1' AS tstextbox WITH ;
		Comment = "", ;
		ControlSource = "cCuentas.descripcioncorta", ;
		editable = .T., ;
		Height = 22, ;
		Left = 89, ;
		Name = "Tstextbox1", ;
		TabIndex = 6, ;
		Top = 134, ;
		Width = 228, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.Container1.Tstextbox2' AS tstextbox WITH ;
		Comment = "", ;
		ControlSource = "cCuentas.userfield1", ;
		editable = .T., ;
		Height = 22, ;
		Left = 89, ;
		Name = "Tstextbox2", ;
		TabIndex = 7, ;
		Top = 230, ;
		Width = 228, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.Container1.Tstextbox3' AS tstextbox WITH ;
		Comment = "", ;
		ControlSource = "cCuentas.userfield2", ;
		editable = .T., ;
		Height = 22, ;
		Left = 89, ;
		Name = "Tstextbox3", ;
		TabIndex = 8, ;
		Top = 254, ;
		Width = 228, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.Container1.Tstextbox4' AS tstextbox WITH ;
		Comment = "", ;
		ControlSource = "cCuentas.userfield3", ;
		editable = .T., ;
		Height = 22, ;
		Left = 89, ;
		Name = "Tstextbox4", ;
		TabIndex = 9, ;
		Top = 278, ;
		Width = 228, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.Container1.txtAbreviatura' AS tstextbox WITH ;
		Comment = "", ;
		ControlSource = "cCuentas.abreviatura", ;
		editable = .T., ;
		Height = 22, ;
		Left = 85, ;
		Name = "txtAbreviatura", ;
		TabIndex = 3, ;
		Top = 56, ;
		Width = 104, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.Container1.txtCuenta' AS tstextbox WITH ;
		Comment = "", ;
		ControlSource = "cCuentas.cuenta", ;
		editable = .T., ;
		Enabled = .F., ;
		Height = 22, ;
		Left = 85, ;
		Name = "txtCuenta", ;
		TabIndex = 1, ;
		Top = 8, ;
		Width = 104, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.Container1.txtDescripcion' AS tstextbox WITH ;
		Comment = "", ;
		ControlSource = "cCuentas.descripción", ;
		editable = .T., ;
		Height = 22, ;
		Left = 85, ;
		Name = "txtDescripcion", ;
		TabIndex = 2, ;
		Top = 32, ;
		Width = 232, ;
		ZOrderSet = 4
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page1.Label_boton1' AS label_boton WITH ;
		Caption = "\<Expandir", ;
		Height = 18, ;
		Left = 337, ;
		Name = "Label_boton1", ;
		Top = 370, ;
		Width = 49, ;
		ZOrderSet = 11
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Label_boton2' AS label_boton WITH ;
		Caption = "\<Contraer", ;
		Height = 18, ;
		Left = 397, ;
		Name = "Label_boton2", ;
		Top = 370, ;
		Width = 50, ;
		ZOrderSet = 12
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Label_boton3' AS label_boton WITH ;
		Caption = "E\<stablecer como Plan de Cuenta Modelo", ;
		Height = 18, ;
		Left = 8, ;
		Name = "Label_boton3", ;
		Top = 371, ;
		Width = 212, ;
		ZOrderSet = 13
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.oleImagesList' AS olecontrol WITH ;
		Height = 37, ;
		Left = 284, ;
		Name = "oleImagesList", ;
		Top = 8, ;
		Width = 49, ;
		ZOrderSet = 14
		*< END OBJECT: BaseClass="olecontrol"  Nombre="Tsmaintform1.Pageframe1.Page1.oleImagesList" Parent="Tsmaintform1.Pageframe1.Page1" ObjName="oleImagesList" OLEObject="C:\Windows\system32\MSCOMCTL.OCX" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAABQAAAAYAAAAHAAAACAAAAAkAAAD+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAANA30ySQqc4BAwAAAEAMAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAALAsAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAHIAAAAAAAAAAQAAAP7///8DAAAA/v///wUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAACAAAAAhAAAAIgAAACMAAAAkAAAAJQAAACYAAAAnAAAAKAAAACkAAAAqAAAAKwAAACwAAAAtAAAALgAAAC8AAAAwAAAA/v////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9cAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAJAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADkzNjgyNjVFLTg1RkUtMTFkMS04QkUzLTAwMDBGODc1NERBMQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAIAMAAAASW1hZ2VIZWlnaHQACQAAAEkKAAAAEAAAAAsAAABJbWFnZVdpZHRoAAkAAABJCgAAABAAAAANAAAAVXNlTWFza0NvbG9yAAUAAABMAQAAAAoAAABCYWNrQ29sb3IACQAAAEkKAAAADAAAgAAAAAAAAAAAAAAAAAAAI38kLJGF0RGxagDA8Cg2KCFDNBIIAAAA7QMAAO0DAACAfuHmAAAGACQAAAAQABAAwMDAAP//AAAB782rAAAFAAAAAAAGAAAA/////wwAAIAAAAAABAAAAAAAAAAEAAAAAQAAAGx0AAA2BAAAAAABAAIAICAQAAAAAADoAgAAJgAAABAQEAAAAAAAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAIiAAACQAAzMwAAAAA3Q0ACIgHAAkJAMzMDAAAAA0H0AiIB3AJB5AAAAzAAAAN0H0IiAd3CQlwzMwMzAAAANDXCIgHdwkHkMzMDMzAAADdDQiIB3cJCXDMzAzMwAAADQcIiAd3CQeQzMwMzMAAAA3QCIgHdwkJcMzMDMzAAAAA0AiIB3cJB5DMzAzMwAAAAN0IeAd3CQlwzMwMzMAAAAANCHgHdwkHkMzMDMzAAAAADQh4B3cJCXDMzAzMwAAAAAAIeAd3CQeQzMwMzMAAAAAACIgHdwkJcMzMDMzAAAAAAAh4B3cJB5DMzAzMwAAAAAAIeAd3CQlwzMwMzMAAAAAACHgHdwkHkMzMDMzAAAAAAAiIB3cACXDMzAzMwAAAAAAIiAd3cICQzMwMzMAAAAAAAAAHd3cIAMzMDMzAAAAAAACIgHd3AIAAAAzMwAAAAAAACIgHdwAAzMwMzMAAAAAAAACIgHcAAMzMDMzAAAAAAAAACIgHAAAAAAzMwAAAAAAAAACIgAAACIiAzMAAAAAAAAAAAAAAAACIiAzAAAAAAAAAAAAAAAAACIiAwAAAAAAAAAAAAAAAAACIiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////44OMD8GBhAfAgIAD4AAAAeAAAADwAAAAcAAAAHgAAAB4AAAAfAAAAHwAAAB+AAAAfgAAAH8AAAB/AAAAf4AAAH+AAAB/gAAAf4AAAH+AAAB/gAAAf8AAAH/gCAB/8AwAf/gMAH/8DgB//g8Af///gH///8B////gf////8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AA0AAAAAAAAADQCAAJAMAAANAIBwlwAMAADQgHCXDAzAANCAcJcMDMAAAIBwlwwMwAAAgHCXDAzAAACAcJcMDMAAAIBwlwwMwAAAgHCXDAzAAAAAdwAMDMAAAAgHAAwMwAAAAIAAAAzAAAAAAAAIgMAAAAAAAACIAAAAAAAAAAAAIkcAAAADAAAAAQAAgAAAAIAAAADAAAAAwAAAAOAAAADgAAAA4AAAAOAAAADwAAAA+EAAAPxAAAD/4AAA//AAAAIAAABsdAAANgQAAAAAAQACACAgEAAAAAAA6AIAACYAAAAQEBAAAAAAACgBAAAOAwAAKAAAACAAAABAAAAAAQAEAAAAAACAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIAAAACAgACAAAAAgACAAICAAACAgIAAwMDAAAAA/wAA/wAAAP//AP8AAAD/AP8A//8AAP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJmZmQAAAAAAAAAAAAAAAACZmZkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAD//wAAAAAAAAAAAAAAAAAP//8AAAAAAAAAAAAAAAAAD///AAAAAAAAAICAAAAAAA///wAAAAAACIgAB3d3d3D///8AAAAACIgA8PAAAAAP8A//AAAIiIAA//D/////Dw8A/wAACAAP///w/////wD/APAAAAgP////cP/39/f3/wDwAAAID///f/D///////kAAAAACQ//f//w//f39/f/AAAAAAgJf///cP///////wAAAAAID///f/D/9/f39/8AAAAACA//f//w////////AAAAAAgPf///cP/39/f3/wAAAAAID///f/D///////8AAAAACA//f//w//f39/f/AAAAAA8Pf///cP///////wAAAAAPD///f/AP//////8AAAAADw//f//wAAAAAAAAAAAAAA8Pf///AAAAAAAAAAAAAAAPD///AAAAAAAAAAAAAAAAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//////////////AP///wD///8A////AP///4P///8D///+A//j/gP/AAAD+AAAAwAAAAMAAAADAAAABwAAAAcAAAAPAAAADwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAA/AAQAPwAP//8AH///gH///+P/////////KAAAABAAAAAgAAAAAQAEAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIAAAACAgACAAAAAgACAAICAAACAgIAAwMDAAAAA/wAA/wAAAP//AP8AAAD/AP8A//8AAP///wAAAAAAAAAJkAAAAAAAAAmQAAAAAAAAAAAAAAAAAAAPAAAAAAAAAP8AAAAHAAAA/wAAh3cHdw8PAAgP/w//gA8ACA//D///AAAID/8Pf38AAAgP/w///wAADw//D39/AAAPD/8P//8AAA8P8AAAAAAAAAAAAAAAAAAAAAAAAAAAAP/wAAD/8AAA//AAAP/xAAD54QAAwAEAAAABAAAAAQAAAAMAAAADAAAAAwAAAAMAAAADAAAABwAAA/8AAN//AAADAAAAbHQAAEABAAAAAAEAAQAQEBAAAAAAACgBAAAWAAAAKAAAABAAAAAgAAAAAQAEAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAIAAAIAAAACAgACAAAAAgACAAICAAADAwMAAgICAAAAA/wAA/wAAAP//AP8AAAD/AP8A//8AAP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsGdnZ2dgAAAAdnZ2dnAAALBnZ2dnYAAAAHZ2dnZwAACwZ2dnZ2AAAAB2dnZ2cAAAsGdnZ2dgAAAAcAAAAHAAALBg///wYAAAAHAAAABwAACwZ2dnZ2AAAAAAAAAAAAAAAAAAAAAAAP//AAD//wAAwAMAAIADAADAAwAAgAMAAMADAACAAwAAwAMAAIADAADAAwAAgAMAAMADAACAAwAAwAMAAP//AAAAAAQAAABsdAAA8AAAAEJN7gAAAAAAAAB2AAAAKAAAABAAAAAPAAAAAQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIAAAACAgACAAAAAgACAAICAAACAgIAAwMDAAAAA/wAA/wAAAP//AP8AAAD/AP8A//8AAP///wCIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIRERESIiIiIhERERIiIiIiEREREiIiIiIRE9ESIiIiIhET0RIiIiIiEREREiIiIiIhIiEiIiIiIiEiISIiIiIiISIhIiIiIiIiERIiIiIiIiIiIiIiIiIiIiIiIiIgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" />

	ADD OBJECT 'Pageframe1.Page1.Ts3dshape1' AS ts3dshape WITH ;
		Height = 360, ;
		Left = 589, ;
		Name = "Ts3dshape1", ;
		Top = 22, ;
		Width = 336, ;
		ZOrderSet = 0
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="shape" />

	ADD OBJECT 'Pageframe1.Page1.Tscommandbutton2' AS tscommandbutton WITH ;
		Caption = "\<Expandir", ;
		Enabled = .F., ;
		FontBold = .F., ;
		Height = 22, ;
		Left = 143, ;
		Name = "Tscommandbutton2", ;
		Top = 382, ;
		Visible = .F., ;
		Width = 76, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Pageframe1.Page1.Tscommandbutton3' AS tscommandbutton WITH ;
		Caption = "\<Contraer", ;
		Enabled = .F., ;
		FontBold = .F., ;
		Height = 22, ;
		Left = 251, ;
		Name = "Tscommandbutton3", ;
		Top = 383, ;
		Visible = .F., ;
		Width = 76, ;
		ZOrderSet = 10
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Pageframe1.Page1.Tslabel1' AS tslabel WITH ;
		BackStyle = 1, ;
		Caption = "Detalle de la Cuenta", ;
		Height = 22, ;
		Left = 607, ;
		Name = "Tslabel1", ;
		Top = 16, ;
		Width = 108, ;
		ZOrderSet = 16
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page3.grdVdetalle' AS tsgrid WITH ;
		campo = idempresa,ejercicio,Cuenta, ;
		cfieldtosum = Importe, ;
		ColumnCount = 3, ;
		editable = .T., ;
		FontName = "Arial", ;
		FontSize = 8, ;
		GridLines = 0, ;
		HeaderHeight = 17, ;
		Height = 221, ;
		Left = 13, ;
		Name = "grdVdetalle", ;
		Panel = 1, ;
		RecordMark = .T., ;
		RecordSource = "cn_presupuesto", ;
		RecordSourceType = 1, ;
		RowHeight = 17, ;
		ScrollBars = 3, ;
		TabIndex = 6, ;
		Top = 82, ;
		valor = oApp.Empresa,oApp.Ejercicio,thisform.key, ;
		valorvariable = thisform.key, ;
		variablevista = m.cuenta, ;
		Width = 635, ;
		Column1.ColumnOrder = 3, ;
		Column1.ControlSource = "cn_presupuesto.importe", ;
		Column1.FontName = "Arial", ;
		Column1.FontSize = 8, ;
		Column1.InputMask = "999,999,999,999", ;
		Column1.Name = "Debe", ;
		Column1.Width = 91, ;
		Column2.Bound = .T., ;
		Column2.ColumnOrder = 1, ;
		Column2.ControlSource = "cn_presupuesto.centro", ;
		Column2.CurrentControl = "Centro", ;
		Column2.FontName = "Arial", ;
		Column2.FontSize = 8, ;
		Column2.Name = "Centro", ;
		Column2.ReadOnly = .F., ;
		Column2.Sparse = .T., ;
		Column2.Width = 99, ;
		Column3.ColumnOrder = 2, ;
		Column3.ControlSource = "cn_presupuesto.mes", ;
		Column3.FontName = "Arial", ;
		Column3.FontSize = 8, ;
		Column3.Name = "Documento", ;
		Column3.Width = 57
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="grid" />

	ADD OBJECT 'Pageframe1.Page3.grdVdetalle.Centro.Centro' AS tscombobox WITH ;
		BorderStyle = 0, ;
		BoundColumn = 1, ;
		BoundTo = .T., ;
		cmdsql = select centro, descripción from centros where idempresa= ?oApp.Empresa order by centro, ;
		ColumnCount = 2, ;
		ColumnLines = .F., ;
		ColumnWidths = "20,140", ;
		cursor = Centros, ;
		editable = .T., ;
		FirstElement = 1, ;
		FontName = "Arial", ;
		FontSize = 8, ;
		ItemTips = .T., ;
		Left = 251, ;
		Name = "Centro", ;
		NumberOfElements = 0, ;
		ReadOnly = .F., ;
		RowSource = "centros.centro, descripción", ;
		RowSourceType = 6, ;
		SpecialEffect = 1, ;
		Style = 0, ;
		Top = 34
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'Pageframe1.Page3.grdVdetalle.Centro.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,0,128, ;
		Caption = "Centro Costo", ;
		FontBold = .T., ;
		FontName = "Arial", ;
		FontSize = 8, ;
		ForeColor = 244,244,244, ;
		Name = "Header1", ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page3.grdVdetalle.Debe.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,0,128, ;
		Caption = "Importe", ;
		FontBold = .T., ;
		FontName = "Arial", ;
		FontSize = 8, ;
		ForeColor = 244,244,244, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page3.grdVdetalle.Debe.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontName = "Arial", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		InputMask = "999,999,999,999", ;
		Margin = 0, ;
		Name = "Text1", ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page3.grdVdetalle.Documento.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,0,128, ;
		Caption = "Mes", ;
		FontBold = .T., ;
		FontName = "Arial", ;
		FontSize = 8, ;
		ForeColor = 244,244,244, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page3.grdVdetalle.Documento.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		ControlSource = "vdetalle.detalle", ;
		FontName = "Arial", ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page3.lblCuenta' AS tslabel WITH ;
		Alignment = 0, ;
		Caption = "", ;
		Height = 36, ;
		Left = 13, ;
		Name = "lblCuenta", ;
		Top = 10, ;
		Width = 624, ;
		WordWrap = .T.
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page3.totales' AS tstextbox WITH ;
		Height = 21, ;
		InputMask = "999,999,999,999", ;
		Left = 181, ;
		Name = "totales", ;
		ReadOnly = .T., ;
		Top = 310, ;
		Width = 88
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page4.grdMovimiento' AS tsgrid WITH ;
		BackColor = 238,234,219, ;
		campo = , ;
		cfieldtosum = debe,haber, ;
		ColumnCount = 7, ;
		editable = .F., ;
		Enabled = .T., ;
		FontSize = 8, ;
		Height = 312, ;
		Left = 11, ;
		Name = "grdMovimiento", ;
		Panel = 1, ;
		ReadOnly = .T., ;
		RecordMark = .T., ;
		RecordSource = "cdetalle_cuenta", ;
		RecordSourceType = 1, ;
		RowHeight = 22, ;
		ScrollBars = 3, ;
		TabIndex = 10, ;
		Top = 22, ;
		valor = , ;
		valorvariable = cCuentas.cuenta, ;
		variablevista = m.cuenta, ;
		Width = 650, ;
		Column1.BackColor = 238,234,219, ;
		Column1.ColumnOrder = 2, ;
		Column1.ControlSource = "cdetalle_cuenta.número", ;
		Column1.Enabled = .T., ;
		Column1.FontSize = 8, ;
		Column1.InputMask = "99999", ;
		Column1.Name = "Asiento", ;
		Column1.ReadOnly = .T., ;
		Column1.Visible = .T., ;
		Column1.Width = 58, ;
		Column2.BackColor = 238,234,219, ;
		Column2.ColumnOrder = 1, ;
		Column2.ControlSource = "cdetalle_cuenta.fecha", ;
		Column2.Enabled = .T., ;
		Column2.FontSize = 8, ;
		Column2.Name = "Fecha", ;
		Column2.ReadOnly = .T., ;
		Column2.Visible = .T., ;
		Column2.Width = 64, ;
		Column3.BackColor = 238,234,219, ;
		Column3.ControlSource = "cdetalle_cuenta.debe", ;
		Column3.Enabled = .T., ;
		Column3.FontSize = 8, ;
		Column3.InputMask = "999,999,999,999", ;
		Column3.Name = "Debe", ;
		Column3.ReadOnly = .T., ;
		Column3.Visible = .T., ;
		Column3.Width = 92, ;
		Column4.BackColor = 238,234,219, ;
		Column4.ControlSource = "cdetalle_cuenta.haber", ;
		Column4.Enabled = .T., ;
		Column4.FontSize = 8, ;
		Column4.InputMask = "999,999,999,999", ;
		Column4.Name = "Haber", ;
		Column4.ReadOnly = .T., ;
		Column4.Visible = .T., ;
		Column4.Width = 90, ;
		Column5.BackColor = 238,234,219, ;
		Column5.Bound = .T., ;
		Column5.ControlSource = "cdetalle_cuenta.centro", ;
		Column5.CurrentControl = "Cbocentro1", ;
		Column5.Enabled = .T., ;
		Column5.FontSize = 8, ;
		Column5.Name = "Centro", ;
		Column5.ReadOnly = .T., ;
		Column5.Sparse = .T., ;
		Column5.Visible = .T., ;
		Column5.Width = 78, ;
		Column6.BackColor = 238,234,219, ;
		Column6.ControlSource = "cdetalle_cuenta.idconcepto", ;
		Column6.CurrentControl = "Cboconcepto1", ;
		Column6.Enabled = .T., ;
		Column6.FontSize = 8, ;
		Column6.Name = "Concepto", ;
		Column6.ReadOnly = .T., ;
		Column6.Visible = .T., ;
		Column6.Width = 58, ;
		Column7.BackColor = 238,234,219, ;
		Column7.ControlSource = "cdetalle_cuenta.documento", ;
		Column7.Enabled = .T., ;
		Column7.FontSize = 8, ;
		Column7.Name = "Documento", ;
		Column7.ReadOnly = .T., ;
		Column7.Visible = .T., ;
		Column7.Width = 196
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="grid" />

	ADD OBJECT 'Pageframe1.Page4.grdMovimiento.Asiento.Campo_clave1' AS campo_clave WITH ;
		actualizar = .F., ;
		BackColor = 238,234,219, ;
		BackStyle = 0, ;
		BorderStyle = 0, ;
		condicionextra = asentable, ;
		datoayuda = Cuentas, ;
		Enabled = .T., ;
		indice = , ;
		InputMask = "99999", ;
		Left = 359, ;
		mensajeerror = , ;
		Name = "Campo_clave1", ;
		objeto = , ;
		objeto2 = , ;
		ReadOnly = .T., ;
		retorna = , ;
		retorna2 = , ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128, ;
		SpecialEffect = 1, ;
		tabla = , ;
		Top = 46, ;
		Visible = .T.
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page4.grdMovimiento.Asiento.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,0,128, ;
		Caption = "Asiento", ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page4.grdMovimiento.Centro.Cbocentro1' AS cbocentro WITH ;
		BackColor = 238,234,219, ;
		BorderStyle = 0, ;
		ControlSource = "cdetalle_cuenta.centro", ;
		editable = .F., ;
		Enabled = .F., ;
		Left = 19, ;
		Name = "Cbocentro1", ;
		ReadOnly = .F., ;
		SpecialEffect = 1, ;
		Top = 31
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="combobox" />

	ADD OBJECT 'Pageframe1.Page4.grdMovimiento.Centro.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,0,128, ;
		Caption = "Centro Costo", ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page4.grdMovimiento.Concepto.Cboconcepto1' AS cboconcepto WITH ;
		BackColor = 238,234,219, ;
		BorderStyle = 0, ;
		ControlSource = "cdetalle_cuenta.idconcepto", ;
		editable = .F., ;
		Enabled = .F., ;
		Left = 24, ;
		Name = "Cboconcepto1", ;
		ReadOnly = .F., ;
		SpecialEffect = 1, ;
		Top = 31
		*< END OBJECT: ClassLib="..\libs\futura.vcx" BaseClass="combobox" />

	ADD OBJECT 'Pageframe1.Page4.grdMovimiento.Concepto.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,0,128, ;
		Caption = "Concepto", ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page4.grdMovimiento.Debe.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,0,128, ;
		Caption = "Debe", ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page4.grdMovimiento.Debe.Text1' AS textbox WITH ;
		BackColor = 238,234,219, ;
		BorderStyle = 0, ;
		Enabled = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		InputMask = "999,999,999,999", ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128, ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page4.grdMovimiento.Documento.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,0,128, ;
		Caption = "Documento", ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page4.grdMovimiento.Documento.Text1' AS textbox WITH ;
		BackColor = 238,234,219, ;
		BorderStyle = 0, ;
		ControlSource = "vdetalle.detalle", ;
		Enabled = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128, ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page4.grdMovimiento.Fecha.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,0,128, ;
		Caption = "Fecha", ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page4.grdMovimiento.Fecha.Text1' AS textbox WITH ;
		BackColor = 238,234,219, ;
		BorderStyle = 0, ;
		DisabledBackColor = 228,228,228, ;
		Enabled = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128, ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page4.grdMovimiento.Haber.Header1' AS header WITH ;
		Alignment = 2, ;
		BackColor = 0,0,128, ;
		Caption = "Haber", ;
		FontBold = .T., ;
		FontSize = 9, ;
		ForeColor = 255,255,255, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Pageframe1.Page4.grdMovimiento.Haber.Text1' AS textbox WITH ;
		BackColor = 238,234,219, ;
		BorderStyle = 0, ;
		Enabled = .T., ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		InputMask = "999,999,999,999", ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T., ;
		SelectedBackColor = 247,223,187, ;
		SelectedForeColor = 0,64,128, ;
		Visible = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page4.totales' AS container WITH ;
		Height = 34, ;
		Left = 11, ;
		Name = "totales", ;
		SpecialEffect = 1, ;
		TabIndex = 12, ;
		Top = 350, ;
		Width = 650, ;
		ZOrderSet = 22
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'Pageframe1.Page4.totales.Saldo' AS tstextbox WITH ;
		Alignment = 3, ;
		BackColor = 0,128,255, ;
		Comment = "", ;
		ControlSource = "", ;
		DisabledForeColor = 0,128,0, ;
		Enabled = .F., ;
		FontBold = .T., ;
		Height = 24, ;
		InputMask = "999,999,999,999", ;
		Left = 318, ;
		Name = "Saldo", ;
		TabIndex = 4, ;
		Top = 5, ;
		Value = 0, ;
		Width = 89
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page4.totales.TotalDebe' AS tstextbox WITH ;
		BackColor = 192,192,192, ;
		ControlSource = "", ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontBold = .T., ;
		Height = 24, ;
		InputMask = "999,999,999,999", ;
		Left = 133, ;
		Name = "TotalDebe", ;
		TabIndex = 1, ;
		Top = 5, ;
		Width = 94
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page4.totales.TotalHaber' AS tstextbox WITH ;
		BackColor = 192,192,192, ;
		ControlSource = "", ;
		DisabledForeColor = 0,0,0, ;
		Enabled = .F., ;
		FontBold = .T., ;
		Height = 24, ;
		InputMask = "999,999,999,999", ;
		Left = 228, ;
		Name = "TotalHaber", ;
		TabIndex = 2, ;
		Top = 5, ;
		Width = 89
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Pageframe1.Page4.totales.Tslabel7' AS tslabel WITH ;
		BackColor = 0,0,0, ;
		Caption = "Totales", ;
		Height = 12, ;
		Left = 18, ;
		Name = "Tslabel7", ;
		TabIndex = 8, ;
		Top = 8, ;
		Width = 96
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />
	
	PROCEDURE addnew
		O = THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA
		IF ISNULL(O.SELECTEDITEM)
		MESSAGEBOX('Seleccione una Cuenta al cual quiere agregar la sub-cuenta.', 48, "Futura Software")
		RETURN
		ENDIF
		IF AT('A=S', O.SELECTEDITEM.TAG)>0
			MESSAGEBOX('No puede agregar sub-cuentas a cuentas asentables.', 48, "Futura Software")
			RETURN
		ENDIF
		cCuenta = THISFORM.NEWKEY()
		INSERT INTO cCuentas (IDEMPRESA, EJERCICIO, CUENTA, INTEGRADORA, NIVEL) VALUES (OAPP.EMPRESA, OAPP.EJERCICIO, STRTRAN(cCuenta , '_', ''), STRTRAN(O.SELECTEDITEM.KEY, '_', ''), VAL(SUBSTR(O.SELECTEDITEM.TAG, AT('|N=', O.SELECTEDITEM.TAG)+3, 1))+1)
		O.SELECTEDITEM = O.NODES.ADD(O.SELECTEDITEM.KEY, 4, cCuenta , "Nueva Cuenta", 0)
		THISFORM.EDITAR('N')
	ENDPROC

	PROCEDURE afterupdatetabla1
			THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.SELECTEDITEM.TEXT = ALLTRIM(cCuentas.CUENTA)+' - '+ALLTRIM(cCuentas.descripción)
			THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.SELECTEDITEM.KEY = ALLTRIM(cCuentas.CUENTA)+'_'
		*	THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.SELECTEDITEM.TAG = '|A='+IIF(ASENTABLE, 'S', 'N')
		*	THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.SELECTEDITEM.TAG = THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.SELECTEDITEM.TAG+'|N='+ALLTRIM(STR(NIVEL))
		*	THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.SELECTEDITEM.TAG = THISFORM.NODOACTIVO.SELECTEDITEM.TAG+'|B='+ALLTRIM(IIF(ISNULL(ABREVIATURA), '', ABREVIATURA))
			IF CCUENTAS.ASENTABLE
				THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.SELECTEDITEM.SELECTEDIMAGE = 3
				THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.SELECTEDITEM.IMAGE = 3
			ELSE
				THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.SELECTEDITEM.SELECTEDIMAGE = 2
				THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.SELECTEDITEM.IMAGE = 1
			ENDIF
	ENDPROC

	PROCEDURE cargararbol
		LOCAL O, ONODO
		IF TYPE("ThisForm.Pageframe1.page1.ArbolCuenta")<>"O" .OR. ISNULL(THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA)
		RETURN .F.
		ENDIF
		IF TYPE("ThisForm.Pageframe1.page1.oleImagesList")<>"O" .OR. ISNULL(THISFORM.PAGEFRAME1.PAGE1.OLEIMAGESLIST)
		RETURN .F.
		ENDIF
		THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.DOVERB(-1)
		THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.IMAGELIST = THISFORM.PAGEFRAME1.PAGE1.OLEIMAGESLIST
		O = THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.NODES
		O.CLEAR
		LCALIAS = ALIAS()
		
		*= SQL('select * from cn_cuentas where idempresa = ?oApp.Empresa and Ejercicio = ?oApp.Ejercicio order by nivel,cuenta', 'cCuentas')
		
		
		WAIT WINDOW AT 15, 35 NOCLEAR NOWAIT "::                 Un momento por favor           ::"+CHR(13)+":: Cargando la estructura de las Cuentas Contable ::"
		IF RECCOUNT('cCuentas')>0
		SELECT CCUENTAS
		SCAN
		IF EMPTY(ALLTRIM(INTEGRADORA))
		ONODO = O.ADD( , 1, ALLTRIM(CUENTA)+"_", ALLTRIM(CUENTA)+' - '+ALLTRIM(DESCRIPCIÓN), 1, 2)
		ELSE
		IF ASENTABLE
			ONODO = O.ADD(ALLTRIM(INTEGRADORA)+"_", 4, ALLTRIM(CUENTA)+"_", ALLTRIM(CUENTA)+' - '+ALLTRIM(DESCRIPCIÓN), 3, 3)
		ELSE
			ONODO = O.ADD(ALLTRIM(INTEGRADORA)+"_", 4, ALLTRIM(CUENTA)+"_", ALLTRIM(CUENTA)+' - '+ALLTRIM(DESCRIPCIÓN), 1, 2)
		ENDIF
		*!*	IF ASENTABLE
		*!*		ONODO = O.ADD(ALLTRIM(INTEGRADORA)+"_", 4, ALLTRIM(CUENTA)+"_", ALLTRIM(CUENTA)+' - '+SUBSTR(DESCRIPCIÓN, 1, 40), 3, 3)
		*!*	ELSE
		*!*		ONODO = O.ADD(ALLTRIM(INTEGRADORA)+"_", 4, ALLTRIM(CUENTA)+"_", ALLTRIM(CUENTA)+' - '+SUBSTR(DESCRIPCIÓN, 1, 40), 1, 2)
		*!*	ENDIF
		
		
		ENDIF
		ONODO.TAG = 'E='+IDEMPRESA
		ONODO.TAG = ONODO.TAG+'|EJ='+ALLTRIM(STR(EJERCICIO))
		ONODO.TAG = ONODO.TAG+'|A='+IIF(ASENTABLE, 'S', 'N')
		ONODO.TAG = ONODO.TAG+'|N='+ALLTRIM(STR(NIVEL))
		ONODO.TAG = ONODO.TAG+'|B='+ALLTRIM(IIF(ISNULL(ABREVIATURA), '', ABREVIATURA))
		ENDSCAN
		ELSE
		LN_OPC = MESSAGEBOX("No existe ningun plan de cuenta definido para el periodo actual"+CHR(13)+"Desea agregar un Plan de Cuenta Base?", 068, "Atención")
		IF LN_OPC=6
		OAPP.DOFORM("cn_cuentasModelo")
		THISFORM.CARGARARBOL()
		ENDIF
		ENDIF
		WAIT CLEAR
		THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.FONT.SIZE = 8
		THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.LABELEDIT = 1
		THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.LINESTYLE = 1
		THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.SORTED = .F.
		O = .NULL.
	ENDPROC

	PROCEDURE delete
		LOCAL O
		O = THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA
		IF  .NOT. ISNULL(O.SELECTEDITEM)
		IF AT('N=1', O.SELECTEDITEM.TAG)>0
		MESSAGEBOX('No puede eliminar las cuentas de este nivel.', 48, "Futura Software")
		RETURN
		ENDIF
		IF O.SELECTEDITEM.CHILDREN>0
		MESSAGEBOX('No puede eliminar Cuentas que contengan sub-cuentas.', 48, "Futura Software")
		RETURN
		ENDIF
		IF MESSAGEBOX("¿Realmente desea eliminar este registro?", 036, "Eliminar advertencia")=7
		RETURN .F.
		ENDIF
		SELECT CCUENTAS
		GOTO TOP
		LOCATE FOR CUENTA=STRTRAN(O.SELECTEDITEM.KEY, '_', '')
		IF FOUND()
		IF SQL('EXEC app_cn_Cuentas_Delete ?cCuentas.IdCuenta')>0
		O.NODES.REMOVE(O.SELECTEDITEM.KEY)
		ENDIF
		ENDIF
		ENDIF
	ENDPROC

	PROCEDURE editar
		PARAMETER LCACCION
		IF PCOUNT()=0
			LCACCION = 'E'
		ENDIF
		
		IF ThisForm.Pageframe1.ActivePage=3
			DODEFAULT()
			ThisForm.Pageframe1.ActivePage=3
			RETURN
		ELSE
			DODEFAULT()
		ENDIF
		
		*DODEFAULT()
			
		IF THISFORM.EDITMODE
		*!*		LOCAL FRM, LONODO
		*!*		LONODO = THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA
		*!*		FRM = CREATEOBJECT('cn_cuentas', @LONODO, THISFORM.DATASESSIONID, LCACCION)
		*!*		FRM.SHOW()
		*!*		RELEASE FRM
		*	DODEFAULT()
		ENDIF
	ENDPROC

	PROCEDURE Init
		THIS.CARGARARBOL()
		DODEFAULT()
		SET CLASSLIB TO futura ADDITIVE
	ENDPROC

	PROCEDURE newkey
		LOCAL O AS
		O = THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA.SELECTEDITEM
		IF ISNULL(O.CHILD)
			IF RIGHT(ALLTRIM(O.KEY),3)='00_'
				LNLONGITUD = LEN(ALLTRIM(O.KEY))-1
				LCULTIMACUENTA = SUBSTR(O.KEY, 1, AT('00', O.KEY)-1)+'00'
				LCNUEVACUENTA = ALLTRIM(STR(VAL(LCULTIMACUENTA)+1))
				LCNUEVACUENTA = LCNUEVACUENTA+REPLICATE('0', LNLONGITUD-LEN(LCNUEVACUENTA))+'_'
			ELSE
				LCNUEVACUENTA =STRTRAN(O.KEY, '_', '')+'01_'
			ENDIF
				
		ELSE
			LCULTIMACUENTA = O.CHILD.LASTSIBLING.KEY
			LCULTIMACUENTA = STRTRAN(LCULTIMACUENTA, '_', '')
			LNLONGITUD = LEN(ALLTRIM(O.CHILD.LASTSIBLING.KEY))-1
			LCNUEVACUENTA = ALLTRIM(STR(VAL(LCULTIMACUENTA)+1))+'_'
			FOR I = LNLONGITUD TO 1 STEP -2
				A = SUBSTR(LCULTIMACUENTA, I-1, 2)
				IF VAL(A)=0
					LCNUEVACUENTA = ALLTRIM(STR(VAL(SUBSTR(LCULTIMACUENTA, 1, I-2))+1))
				ELSE
					EXIT
				ENDIF
			ENDFOR
			IF LNLONGITUD-LEN(LCNUEVACUENTA)>0
				LCNUEVACUENTA = LCNUEVACUENTA+REPLICATE('0', LNLONGITUD-LEN(LCNUEVACUENTA))+'_'
			ENDIF
		ENDIF
		
		RETURN LCNUEVACUENTA
		
		
	ENDPROC

	PROCEDURE Pageframe1.Page2.Activate
		***
	ENDPROC

	PROCEDURE Pageframe1.Page3.Activate
		M.CUENTA = THISFORM.KEY
		REQUERY("cn_Presupuesto")
		THIS.REFRESH()
	ENDPROC

	PROCEDURE Pageframe1.Page3.Deactivate
		IF thisform.datachanged("cn_presupuesto") AND THISFORM.ASKTOSAVE()=2
			NODEFAULT
			RETURN .F.
		ENDIF
		RETURN .t.
		
	ENDPROC

	PROCEDURE Pageframe1.Page4.Activate
		M.CUENTA = THISFORM.KEY
		REQUERY("cdetalle_cuenta")
		THIS.REFRESH()
	ENDPROC

	PROCEDURE Release
		O = THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA
		O = .NULL.
	ENDPROC

	PROCEDURE Pageframe1.Page1.ArbolCuenta.NodeClick
		LPARAMETERS NODE
		THISFORM.KEY = NODE.KEY
		LOCATE FOR CUENTA=STRTRAN(NODE.KEY, '_', '')
		
		
		This.parent.Container1.Refresh()
	ENDPROC

	PROCEDURE Pageframe1.Page1.Label_boton1.Click
		THISFORM.LOCKSCREEN = .T.
		WAIT WINDOW NOWAIT 'Expandiendo...'
		WITH THIS.PARENT.ARBOLCUENTA
		FOR I = 1 TO .NODES.COUNT
		.NODES(I).EXPANDED = .T.
		ENDFOR
		ENDWITH
		WAIT CLEAR
		THISFORM.LOCKSCREEN = .F.
	ENDPROC

	PROCEDURE Pageframe1.Page1.Label_boton2.Click
		THISFORM.LOCKSCREEN = .T.
		WITH THIS.PARENT.ARBOLCUENTA
		FOR I = 1 TO .NODES.COUNT
		.NODES(I).EXPANDED = .F.
		ENDFOR
		ENDWITH
		THISFORM.LOCKSCREEN = .F.
	ENDPROC

	PROCEDURE Pageframe1.Page1.Label_boton3.Click
		THISFORM.LOCKSCREEN = .T.
		OAPP.DOFORM("cn_ModelCuenAuto")
		THISFORM.LOCKSCREEN = .F.
	ENDPROC

	PROCEDURE Pageframe1.Page1.Tscommandbutton2.Click
		THISFORM.LOCKSCREEN = .T.
		WAIT WINDOW NOWAIT 'Expandiendo...'
		WITH THIS.PARENT.ARBOLCUENTA
		FOR I = 1 TO .NODES.COUNT
		.NODES(I).EXPANDED = .T.
		ENDFOR
		ENDWITH
		WAIT CLEAR
		THISFORM.LOCKSCREEN = .F.
	ENDPROC

	PROCEDURE Pageframe1.Page1.Tscommandbutton3.Click
		THISFORM.LOCKSCREEN = .T.
		WITH THIS.PARENT.ARBOLCUENTA
		FOR I = 1 TO .NODES.COUNT
		.NODES(I).EXPANDED = .F.
		ENDFOR
		ENDWITH
		THISFORM.LOCKSCREEN = .F.
	ENDPROC

	PROCEDURE Pageframe1.Page3.grdVdetalle.Debe.Text1.GotFocus
		THIS.TAG = STR(THIS.VALUE)
	ENDPROC

	PROCEDURE Pageframe1.Page3.grdVdetalle.Debe.Text1.LostFocus
		
		IF THIS.TAG<>STR(THIS.VALUE)
			THIS.PARENT.PARENT.PARENT.TOTALES.REFRESH()
		ENDIF
	ENDPROC

	PROCEDURE Pageframe1.Page3.grdVdetalle.Refresh
		DODEFAULT()
		THIS.PARENT.TOTALES.REFRESH()
	ENDPROC

	PROCEDURE Pageframe1.Page3.lblCuenta.Refresh
		O = THISFORM.PAGEFRAME1.PAGE1.ARBOLCUENTA
		IF ISNULL(O.SELECTEDITEM)
			MESSAGEBOX('Seleccione una Cuenta para ver su Presupuesto.', 48, "Futura Software")
		RETURN
		ENDIF
		this.Caption="Cuenta: " +o.SELECTEDITEM.FullPath
			
	ENDPROC

	PROCEDURE Pageframe1.Page3.totales.Refresh
		This.parent.grdVdetalle.sumcolumn()
		this.Value=This.parent.grdVdetalle.totales(1)
		
	ENDPROC

	PROCEDURE Pageframe1.Page4.grdMovimiento.Refresh
		DODEFAULT()
		THIS.PARENT.TOTALES.REFRESH()
	ENDPROC

	PROCEDURE Pageframe1.Page4.totales.Refresh
		THIS.PARENT.GRDMOVIMIENTO.SUMCOLUMN()
		THIS.TOTALDEBE.VALUE = THIS.PARENT.GRDMOVIMIENTO.TOTALES(1)
		THIS.TOTALHABER.VALUE = THIS.PARENT.GRDMOVIMIENTO.TOTALES(2)
		THIS.SALDO.VALUE = THIS.TOTALDEBE.VALUE-THIS.TOTALHABER.VALUE
		DODEFAULT()
	ENDPROC

	PROCEDURE Pageframe1.Page4.totales.Saldo.Refresh
		DO CASE
		CASE THIS.VALUE>0
		THIS.DISABLEDFORECOLOR = RGB(0, 128, 0)
		CASE THIS.VALUE<0
		THIS.DISABLEDFORECOLOR = RGB(255, 0, 0)
		CASE THIS.VALUE=0
		THIS.DISABLEDFORECOLOR = RGB(0, 0, 0)
		ENDCASE
	ENDPROC

ENDDEFINE
