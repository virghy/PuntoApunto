*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="cn_cuentasmodelo.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*


*
#INCLUDE "..\include\tastrade.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	DataSource = .NULL.
	Height = 276
	InitialSelectedAlias = ""
	Left = 76
	Name = "Dataenvironment"
	Top = 196
	Width = 520
	
	PROCEDURE BeforeOpenTables
		DO SETEO
		oApp.SetDatabase(this)
		
	ENDPROC

ENDDEFINE

DEFINE CLASS tsmaintform1 AS tsmaintform OF "..\libs\tsbase.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Tscombobox1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.OleTreeView" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.oleImagesList" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tscommandbutton2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Tscommandbutton3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Label_boton1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Label_boton2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Pageframe1.Page1.Label_boton3" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: *cargararbol
		*m: *newkey
		*p: key
	*</DefinedPropArrayMethod>

	BorderStyle = 1
	campos = idEmpresa
	Caption = "Plan de Cuentas Modelos"
	detalle = .F.
	DoCreate = .T.
	grupoimpresion = Cuentas
	Height = 412
	idobjeto = 418
	Name = "Tsmaintform1"
	navegador = .F.
	tabla1 = cCuentasModelo
	valores = oApp.Empresa
	Width = 669
	WindowState = 0
	WindowType = 1
	lblRequerido.Name = "lblRequerido"
	Pageframe1.ActivePage = 1
	Pageframe1.ErasePage = .T.
	Pageframe1.Height = 416
	Pageframe1.Left = -2
	Pageframe1.Name = "Pageframe1"
	Pageframe1.Page1.BackColor = 255,255,255
	Pageframe1.Page1.Name = "Page1"
	Pageframe1.Page1.PageOrder = 1
	Pageframe1.Page2.BackColor = 243,239,218
	Pageframe1.Page2.Caption = ""
	Pageframe1.Page2.grdList.Name = "grdList"
	Pageframe1.Page2.Name = "Page2"
	Pageframe1.Page2.PageOrder = 2
	Pageframe1.PageCount = 2
	Pageframe1.TabStretch = 1
	Pageframe1.TabStyle = 0
	Pageframe1.Top = 0
	Pageframe1.Width = 674

	ADD OBJECT 'Pageframe1.Page1.Label_boton1' AS label_boton WITH ;
		Caption = "\<Expandir", ;
		Height = 18, ;
		Left = 551, ;
		Name = "Label_boton1", ;
		Top = 370, ;
		Width = 49
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Label_boton2' AS label_boton WITH ;
		Caption = "\<Contraer", ;
		Height = 18, ;
		Left = 611, ;
		Name = "Label_boton2", ;
		Top = 370, ;
		Width = 50
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.Label_boton3' AS label_boton WITH ;
		Caption = "Utilizar esté modelo de Plan de Cuenta", ;
		Height = 18, ;
		Left = 8, ;
		Name = "Label_boton3", ;
		Top = 371, ;
		Width = 207
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Pageframe1.Page1.oleImagesList' AS olecontrol WITH ;
		Height = 39, ;
		Left = 409, ;
		Name = "oleImagesList", ;
		Top = 24, ;
		Width = 38
		*< END OBJECT: BaseClass="olecontrol"  Nombre="Tsmaintform1.Pageframe1.Page1.oleImagesList" Parent="Tsmaintform1.Pageframe1.Page1" ObjName="oleImagesList" OLEObject="C:\WINDOWS\system32\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAABQAAAAYAAAAHAAAACAAAAAkAAAAKAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFCvJRzHRckBAwAAAEAOAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAJw0AAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAHIAAAAAAAAAAQAAAP7///8DAAAA/v///wUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAACAAAAAhAAAAIgAAACMAAAAkAAAAJQAAACYAAAAnAAAAKAAAACkAAAAqAAAAKwAAACwAAAAtAAAALgAAAC8AAAAwAAAAMQAAADIAAAAzAAAANAAAADUAAAA2AAAANwAAADgAAAD+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9cAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAJAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADkzNjgyNjVFLTg1RkUtMTFkMS04QkUzLTAwMDBGODc1NERBMQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAIAMAAAASW1hZ2VIZWlnaHQACQAAAEkKAAAAEAAAAAsAAABJbWFnZVdpZHRoAAkAAABJCgAAABAAAAANAAAAVXNlTWFza0NvbG9yAAUAAABMAQAAAAoAAABCYWNrQ29sb3IACQAAAEkKAAAADAAAgAAAAAAAAAAAAAAAAAAAI38kLJGF0RGxagDA8Cg2KCFDNBIIAAAA7QMAAO0DAACAfuHmAAAGACMAAAAQABAAwMDAAP//AAAB782rAAAFABD5GgAGAAAA/////wwAAIAAAAAAAwAAAAAAAAMAAAABAAAAbHQAADYEAAAAAAEAAgAgIBAAAAAAAOgCAAAmAAAAEBAQAAAAAAAoAQAADgMAACgAAAAgAAAAQAAAAAEABAAAAAAAgAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAgICAAMDAwAAAAP8AAP8AAAD//wD/AAAA/wD/AP//AAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADQAAiIAAAJAADMzAAAAADdDQAIiAcACQkAzMwMAAAADQfQCIgHcAkHkAAADMAAAA3QfQiIB3cJCXDMzAzMAAAA0NcIiAd3CQeQzMwMzMAAAN0NCIgHdwkJcMzMDMzAAAANBwiIB3cJB5DMzAzMwAAADdAIiAd3CQlwzMwMzMAAAADQCIgHdwkHkMzMDMzAAAAA3Qh4B3cJCXDMzAzMwAAAAA0IeAd3CQeQzMwMzMAAAAANCHgHdwkJcMzMDMzAAAAAAAh4B3cJB5DMzAzMwAAAAAAIiAd3CQlwzMwMzMAAAAAACHgHdwkHkMzMDMzAAAAAAAh4B3cJCXDMzAzMwAAAAAAIeAd3CQeQzMwMzMAAAAAACIgHdwAJcMzMDMzAAAAAAAiIB3dwgJDMzAzMwAAAAAAAAAd3dwgAzMwMzMAAAAAAAIiAd3cAgAAADMzAAAAAAAAIiAd3AADMzAzMwAAAAAAAAIiAdwAAzMwMzMAAAAAAAAAIiAcAAAAADMzAAAAAAAAAAIiAAAAIiIDMwAAAAAAAAAAAAAAAAIiIDMAAAAAAAAAAAAAAAAAIiIDAAAAAAAAAAAAAAAAAAIiIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/////jg4wPwYGEB8CAgAPgAAAB4AAAAPAAAABwAAAAeAAAAHgAAAB8AAAAfAAAAH4AAAB+AAAAfwAAAH8AAAB/gAAAf4AAAH+AAAB/gAAAf4AAAH+AAAB/wAAAf+AIAH/wDAB/+AwAf/wOAH/+DwB///+Af///wH///+B/////ygAAAAQAAAAIAAAAAEABAAAAAAAwAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAgICAAMDAwAAAAP8AAP8AAAD//wD/AAAA/wD/AP//AAD///8ADQAAAAAAAAANAIAAkAwAAA0AgHCXAAwAANCAcJcMDMAA0IBwlwwMwAAAgHCXDAzAAACAcJcMDMAAAIBwlwwMwAAAgHCXDAzAAACAcJcMDMAAAAB3AAwMwAAACAcADAzAAAAAgAAADMAAAAAAAAiAwAAAAAAAAIgAAAAAAAAAAAAiRwAAAAMAAAABAACAAAAAgAAAAMAAAADAAAAA4AAAAOAAAADgAAAA4AAAAPAAAAD4QAAA/EAAAP/gAAD/8AAAAgAAAGx0AAA2BAAAAAABAAIAICAQAAAAAADoAgAAJgAAABAQEAAAAAAAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAmZmZAAAAAAAAAAAAAAAAAJmZmQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAD/8AAAAAAAAAAAAAAAAAAP//AAAAAAAAAAAAAAAAAA///wAAAAAAAAAAAAAAAAAP//8AAAAAAAAAgIAAAAAAD///AAAAAAAIiAAHd3d3cP///wAAAAAIiADw8AAAAA/wD/8AAAiIgAD/8P////8PDwD/AAAIAA////D/////AP8A8AAACA////9w//f39/f/APAAAAgP//9/8P//////+QAAAAAJD/9///D/9/f39/8AAAAACAl///9w////////AAAAAAgP//9/8P/39/f3/wAAAAAID/9///D///////8AAAAACA9///9w//f39/f/AAAAAAgP//9/8P///////wAAAAAID/9///D/9/f39/8AAAAADw9///9w////////AAAAAA8P//9/8A///////wAAAAAPD/9///AAAAAAAAAAAAAADw9///8AAAAAAAAAAAAAAA8P//8AAAAAAAAAAAAAAAAAD/AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//////////////8A////AP///wD///8A////g////wP///4D/+P+A/8AAAP4AAADAAAAAwAAAAMAAAAHAAAABwAAAA8AAAAPAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAD8ABAA/AA///wAf//+Af///4/////////8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAmQAAAAAAAACZAAAAAAAAAAAAAAAAAAAA8AAAAAAAAA/wAAAAcAAAD/AACHdwd3Dw8ACA//D/+ADwAID/8P//8AAAgP/w9/fwAACA//D///AAAPD/8Pf38AAA8P/w///wAADw/wAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAP/wAAD/8AAA//EAAPnhAADAAQAAAAEAAAABAAAAAwAAAAMAAAADAAAAAwAAAAMAAAAHAAAD/wAA3/8AAAMAAABsdAAAOAQAAAAAAQACACAgEAAAAAAA6AIAACYAAAAQEBAAAAAAACgBAAAOAwAAKAAAACAAAABAAAAAAQAEAAAAAACAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIAAAACAgACAAAAAgACAAICAAACAgIAAwMDAAAAA/wAA/wAAAP//AP8AAAD/AP8A//8AAP///wAHd3dwAHd3AAAAAAAAAAAAAAAAd3AAB3cAAAAAAAAAAA///wAP//AHdwAAAAAAAAAP////////AAd3AAAAAAAAD//////////wB3AAAAAAAA///////////wB3AAAAAAAP///////////wBwAAAAAAD////////////wdwAAAAAA///3d3d3d3d3cAd3d3cAAP////////////8AAAAHcAD/////////////////AHcA//////////////////AHAP//////////////////BwD///d3d3d3d3d3d3d3dwdw//////////////////8AcP//////////////////8HD///////////////////Bw///////////////////wcP//93d3d3d3d3d3d3d3cHD///////////////////Bw///5/////////5mZn//wcP///5n///////n/////8HD/////n/+f///5//////Bw//////n5////+f/////wcP////+Zmf//mZmZmZ//8HD///+Z//n////5//////Bw////////n///+f/////wcP///////5////n/////8HD///////+f/5mZmZn///Bw///////////////////wcP//////////////////8HAAAAAAAAAAAAAAAAAAAAD4HD//8AAP//AAA//wAAD/8AAAf/AAAD/wAAA/8AAAH/AAAABwAAAAMAAAABAAAAAQAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAKAAAABAAAAAgAAAAAQAEAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIAAAACAgACAAAAAgACAAICAAACAgIAAwMDAAAAA/wAA/wAAAP//AP8AAAD/AP8A//8AAP///wB3d3d3AAAAAAAAAAB3AAAAD////wBwAAAP93d3dwdwAA//////8Ad3D///////8AcP93d3d3d3Bw////////8HD////////wcP93d3d3d3Bw//////+Z8HD/mfn/+f/wcP//mf+ZmfBw//n/n/n/8HD///+fmZ/wcAAAAAAAAABwD/AAAAPwAAAB8AAAAHAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABzAHkAdABOAFkAMgBnACgAUwB2AHkAPwBWAFgAQgBdADIAZAAuAF8AcwB5AHQATgBZADIAZwAoAFMAdgB5AD8AVgBYAEIAXQAyAGQAKwBfAHMAeQB0AE4AWQAyAGcAKABTAHYAeQA/AFYAWABCAF0AMgBkACgAXwBzAHkAdABOAFkAMgBnACgAUwB2AHkAPwBWAFgAQgBdADIAZAAlAF8AcwB5AHQATgBZADIAZwAoAFMAdgB5AD8AVgBYAEIAXQAyAGQAZAB0AEMALQBFAHkAdAA0AGcAKABYACoAegA/AFYAWABCAF0AMgBkACQAdAA1ADgAeABgAEoAJQBnACgARQBWACYATABbAH4AOAA4AGsAWwB5AHMANQA4AHgAYABKACUAZwAoAEUAVgAmAEwAWwB+ADgAOABrAFsAZQBgAEoAJQAwACYASAAtAGcAKABNAGQAeQA/AFYAWABCAF0AMgBkAGIAYABKACUAMAAmAEgALQBnACgATQBkAHkAPwBWAFgAQgBdADIAZAA4AHQAQwAtAEUAeQB0ADQAZwAoAFgAKgB6AD8AVgBYAEIAXQAyAGQALgB0AEMALQBFAHkAdAA0AGcAKABYACoAegA/AFYAWABCAF0A" />

	ADD OBJECT 'Pageframe1.Page1.OleTreeView' AS olecontrol WITH ;
		Enabled = .T., ;
		Height = 361, ;
		Left = 9, ;
		Name = "OleTreeView", ;
		TabIndex = 7, ;
		Top = 10, ;
		Visible = .T., ;
		Width = 650
		*< END OBJECT: BaseClass="olecontrol"  Nombre="Tsmaintform1.Pageframe1.Page1.OleTreeView" Parent="Tsmaintform1.Pageframe1.Page1" ObjName="OleTreeView" OLEObject="C:\WINDOWS\system32\mscomctl.ocx" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAFCvJRzHRckBAwAAAAADAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAiwAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAIcBAAAAAAAACAAAAAIAAAD+////BAAAAAUAAAAGAAAABwAAAAkAAAAKAAAACwAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+2kEHHiYXREbFqAMDwKDYoIUM0EggAAAAuQwAATyUAALE8wWoBAAYAIgAAABwBAAARAgAACgAAAEHU2gIB782rXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACADgAAAEhpZGVTZWxlY3Rpb24ABQAAAEwAAAAADAAAAEluZGVudGF0aW9uABEAAABODQAAAAcAAAAAAAAAAAA0QAoAAABMaW5lU3R5bGUACQAAAEkKAAAAAAAAAA0AAABNb3VzZVBvaW50ZXIACQAAAEkKAAAAAAAAAA4AAABQYXRoU2VwYXJhdG9yAAoAAABIAAAAAAEAAABcBwAAAFNvcnRlZAAFAAAATAEAAAAMAAAAT0xFRHJhZ01vZGUACQAAAEkKAAAAAAAAAAwAAABPTEVEcm9wTW9kZQAJAAAASQoAAAAAAAAACwAAAEFwcGVhcmFuY2UACQAAAEkKAAAAAQAAAAwAAABCb3JkZXJTdHlsZQAJAAAASQoAAAABAAAACwAAAENoZWNrYm94ZXMABQAAAEwAAAAADgAAAAAABQAQ1toCBwAAAAAAAAAFAACA0OkSAAEAAABcAB/e7L0BAAUAFeoSAANS4wuRj84RneMAqgBLuFEBAAAAkAFGdWxsUm93U2VsZWN0AAUAAABMAQAAAAwAAABIb3RUcmFja2luZwAFAAAATAAAAAAKAAAAU2luZ2xlU2VsAAUAkF8BAAZUYWhvbWEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAATAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAoAQAADgMAACgAAAAgAAAAQAAAAAEABAAAAAAAgAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAgICAAMDAwAAAAP8AAP8AAAD//wD/AAAA/wD/AP//AAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADu7u7oiIAAAAAAAAAAAAAA7u7u6IiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////iAAAAAAAAAAAAAAA//////iAAAAAAAAAAAAAAP/////4gAAAAAAA" />

	ADD OBJECT 'Pageframe1.Page1.Tscommandbutton2' AS tscommandbutton WITH ;
		Caption = "\<Expandir", ;
		Enabled = .F., ;
		FontBold = .F., ;
		Height = 22, ;
		Left = 143, ;
		Name = "Tscommandbutton2", ;
		Top = 382, ;
		Visible = .F., ;
		Width = 76
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Pageframe1.Page1.Tscommandbutton3' AS tscommandbutton WITH ;
		Caption = "\<Contraer", ;
		Enabled = .F., ;
		FontBold = .F., ;
		Height = 22, ;
		Left = 251, ;
		Name = "Tscommandbutton3", ;
		Top = 382, ;
		Visible = .F., ;
		Width = 76
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="commandbutton" />

	ADD OBJECT 'Tscombobox1' AS tscombobox WITH ;
		Alignment = 2, ;
		BackColor = 238,234,219, ;
		BorderColor = 236,155,83, ;
		BoundColumn = 3, ;
		cmdsql = SELECT     modelo, obs, idmodelo FROM         cn_ModeloCuentas, ;
		cursor = cu_CuentaModelo, ;
		editable = .F., ;
		FontBold = .T., ;
		FontName = "Times New Roman", ;
		FontSize = 14, ;
		ForeColor = 0,0,128, ;
		Height = 27, ;
		ItemBackColor = 238,234,219, ;
		ItemForeColor = 0,0,128, ;
		Left = 0, ;
		Name = "Tscombobox1", ;
		SelectedBackColor = 244,238,217, ;
		SelectedForeColor = 0,0,128, ;
		SelectedItemBackColor = 214,203,180, ;
		SelectedItemForeColor = 22,0,223, ;
		SpecialEffect = 1, ;
		Top = 0, ;
		Width = 669
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />
	
	PROCEDURE addnew
		O = THISFORM.PAGEFRAME1.PAGE1.OLETREEVIEW
		IF ISNULL(O.SELECTEDITEM)
		MESSAGEBOX('Seleccione una Cuenta al cual quiere agregar la sub-cuenta.', 48, "Futura Software")
		RETURN
		ENDIF
		IF AT('A=S', O.SELECTEDITEM.TAG)>0
		MESSAGEBOX('No puede agregar sub-cuentas a cuentas asentables.', 48, "Futura Software")
		RETURN
		ENDIF
		INSERT INTO cCuentasModelo (CUENTA, INTEGRADORA, NIVEL, IDMODELO) VALUES (STRTRAN(THISFORM.NEWKEY(), '_', ''), STRTRAN(O.SELECTEDITEM.KEY, '_', ''), VAL(SUBSTR(O.SELECTEDITEM.TAG, AT('|N=', O.SELECTEDITEM.TAG)+3, 1))+1, VAL(THISFORM.TSCOMBOBOX1.VALUE))
		O.SELECTEDITEM = O.NODES.ADD(O.SELECTEDITEM.KEY, 4, THISFORM.NEWKEY(), "Nueva Cuenta", 0)
		THISFORM.EDITAR('N')
	ENDPROC

	PROCEDURE cargararbol
		IF TYPE("ThisForm.Pageframe1.page1.oleTreeview")<>"O" .OR. ISNULL(THISFORM.PAGEFRAME1.PAGE1.OLETREEVIEW)
		RETURN .F.
		ENDIF
		IF TYPE("ThisForm.Pageframe1.page1.oleImagesList")<>"O" .OR. ISNULL(THISFORM.PAGEFRAME1.PAGE1.OLEIMAGESLIST)
		RETURN .F.
		ENDIF
		THISFORM.PAGEFRAME1.PAGE1.OLETREEVIEW.DOVERB(-1)
		THISFORM.PAGEFRAME1.PAGE1.OLETREEVIEW.IMAGELIST = THISFORM.PAGEFRAME1.PAGE1.OLEIMAGESLIST
		O = THISFORM.PAGEFRAME1.PAGE1.OLETREEVIEW.NODES
		O.CLEAR
		LCALIAS = ALIAS()
		M.CUENTAMODELO = ALLTRIM(THISFORM.TSCOMBOBOX1.VALUE)
		= SQL('select * from cn_Modelocuentas_Det where idmodelo = '+M.CUENTAMODELO+' order by nivel,cuenta', 'cCuentasModelo')
		IF RECCOUNT('cCuentasModelo')>0
		SELECT CCUENTASMODELO
		SCAN
		IF EMPTY(ALLTRIM(INTEGRADORA))
		ONODO = O.ADD( , 1, ALLTRIM(CUENTA)+"_", ALLTRIM(CUENTA)+' - '+DESCRIPCIÓN, 1, 2)
		ELSE
		IF ASENTABLE
		ONODO = O.ADD(ALLTRIM(INTEGRADORA)+"_", 4, ALLTRIM(CUENTA)+"_", ALLTRIM(CUENTA)+' - '+SUBSTR(DESCRIPCIÓN, 1, 40), 3, 3)
		ELSE
		ONODO = O.ADD(ALLTRIM(INTEGRADORA)+"_", 4, ALLTRIM(CUENTA)+"_", ALLTRIM(CUENTA)+' - '+SUBSTR(DESCRIPCIÓN, 1, 40), 1, 2)
		ENDIF
		ENDIF
		ONODO.TAG = ''
		ONODO.TAG = ONODO.TAG+'|A='+IIF(ASENTABLE, 'S', 'N')
		ONODO.TAG = ONODO.TAG+'|N='+ALLTRIM(STR(NIVEL))
		ONODO.TAG = ONODO.TAG+'|B='+ALLTRIM(IIF(ISNULL(ABREVIATURA), '', ABREVIATURA))
		ENDSCAN
		ENDIF
		THISFORM.PAGEFRAME1.PAGE1.OLETREEVIEW.FONT.SIZE = 8
		THISFORM.PAGEFRAME1.PAGE1.OLETREEVIEW.LABELEDIT = 1
		THISFORM.PAGEFRAME1.PAGE1.OLETREEVIEW.LINESTYLE = 1
		THISFORM.PAGEFRAME1.PAGE1.OLETREEVIEW.SORTED = .F.
		THISFORM.PAGEFRAME1.PAGE1.OLETREEVIEW.VISIBLE = .T.
	ENDPROC

	PROCEDURE delete
		O = THISFORM.PAGEFRAME1.PAGE1.OLETREEVIEW
		IF  .NOT. ISNULL(O.SELECTEDITEM)
		IF AT('N=1', O.SELECTEDITEM.TAG)>0
		MESSAGEBOX('No puede eliminar las cuentas de este nivel.', 48, "Futura Software")
		RETURN
		ENDIF
		IF O.SELECTEDITEM.CHILDREN>0
		MESSAGEBOX('No puede eliminar Cuentas que contengan sub-cuentas.', 48, "Futura Software")
		RETURN
		ENDIF
		IF MESSAGEBOX("¿Realmente desea eliminar este registro?", 036, "Eliminar advertencia")=7
		RETURN .F.
		ENDIF
		SELECT CCUENTASMODELO
		GOTO TOP
		LOCATE FOR CUENTA=STRTRAN(O.SELECTEDITEM.KEY, '_', '')
		IF FOUND()
		IF SQL('EXEC app_cn_Cuentas_Delete_Modelo ?cCuentasModelo.Cuenta, ?cCuentasModelo.idModelo')>0
		O.NODES.REMOVE(O.SELECTEDITEM.KEY)
		ENDIF
		ENDIF
		ENDIF
	ENDPROC

	PROCEDURE editar
		PARAMETER LCACCION
		IF PCOUNT()=0
		LCACCION = 'E'
		ENDIF
		DODEFAULT()
		IF THISFORM.EDITMODE
		LOCAL FRM, LONODO
		LONODO = THISFORM.PAGEFRAME1.PAGE1.OLETREEVIEW.SELECTEDITEM
		FRM = CREATEOBJECT('cn_cuentasModelo', @LONODO, THISFORM.DATASESSIONID, LCACCION)
		FRM.SHOW()
		RELEASE FRM
		DODEFAULT()
		ENDIF
	ENDPROC

	PROCEDURE newkey
		LOCAL O
		O = THISFORM.PAGEFRAME1.PAGE1.OLETREEVIEW.SELECTEDITEM
		IF ISNULL(O.CHILD)
		LNLONGITUD = LEN(ALLTRIM(O.KEY))-1
		LCULTIMACUENTA = SUBSTR(O.KEY, 1, AT('00', O.KEY)-1)+'00'
		LCNUEVACUENTA = ALLTRIM(STR(VAL(LCULTIMACUENTA)+1))
		LCNUEVACUENTA = LCNUEVACUENTA+REPLICATE('0', LNLONGITUD-LEN(LCNUEVACUENTA))+'_'
		ELSE
		LCULTIMACUENTA = O.CHILD.LASTSIBLING.KEY
		LCULTIMACUENTA = STRTRAN(LCULTIMACUENTA, '_', '')
		LNLONGITUD = LEN(ALLTRIM(O.CHILD.LASTSIBLING.KEY))-1
		LCNUEVACUENTA = ALLTRIM(STR(VAL(LCULTIMACUENTA)+1))+'_'
		FOR I = LNLONGITUD TO 1 STEP -2
		A = SUBSTR(LCULTIMACUENTA, I-1, 2)
		IF VAL(A)=0
		LCNUEVACUENTA = ALLTRIM(STR(VAL(SUBSTR(LCULTIMACUENTA, 1, I-2))+1))
		ELSE
		EXIT
		ENDIF
		ENDFOR
		IF LNLONGITUD-LEN(LCNUEVACUENTA)>0
		LCNUEVACUENTA = LCNUEVACUENTA+REPLICATE('0', LNLONGITUD-LEN(LCNUEVACUENTA))+'_'
		ENDIF
		ENDIF
		RETURN LCNUEVACUENTA
	ENDPROC

	PROCEDURE Pageframe1.Page1.Label_boton1.Click
		THISFORM.LOCKSCREEN = .T.
		WAIT WINDOW NOWAIT 'Expandiendo...'
		WITH THIS.PARENT.OLETREEVIEW
		FOR I = 1 TO .NODES.COUNT
		.NODES(I).EXPANDED = .T.
		ENDFOR
		ENDWITH
		WAIT CLEAR
		THISFORM.LOCKSCREEN = .F.
	ENDPROC

	PROCEDURE Pageframe1.Page1.Label_boton2.Click
		THISFORM.LOCKSCREEN = .T.
		WITH THIS.PARENT.OLETREEVIEW
		FOR I = 1 TO .NODES.COUNT
		.NODES(I).EXPANDED = .F.
		ENDFOR
		ENDWITH
		THISFORM.LOCKSCREEN = .F.
	ENDPROC

	PROCEDURE Pageframe1.Page1.Label_boton3.Click
		THISFORM.LOCKSCREEN = .T.
		SELECT CU_CUENTAMODELO
		IDEMPRESA = OAPP.EMPRESA
		EJERCICIO = OAPP.EJERCICIO
		CSQL = "exec cnt_Cuenta_desde_Modelo ?cu_CuentaModelo.idmodelo, ?idempresa , ?ejercicio"
		IF SQL(CSQL, "cResultado")>0
		WAIT WINDOW "OK"
		ELSE
		WAIT WINDOW "Se produjo un error"
		ENDIF
		THISFORM.LOCKSCREEN = .F.
	ENDPROC

	PROCEDURE Pageframe1.Page1.OleTreeView.NodeClick
		LPARAMETERS NODE
		THISFORM.KEY = NODE.KEY
	ENDPROC

	PROCEDURE Pageframe1.Page1.Tscommandbutton2.Click
		THISFORM.LOCKSCREEN = .T.
		WAIT WINDOW NOWAIT 'Expandiendo...'
		WITH THIS.PARENT.OLETREEVIEW
		FOR I = 1 TO .NODES.COUNT
		.NODES(I).EXPANDED = .T.
		ENDFOR
		ENDWITH
		WAIT CLEAR
		THISFORM.LOCKSCREEN = .F.
	ENDPROC

	PROCEDURE Pageframe1.Page1.Tscommandbutton3.Click
		THISFORM.LOCKSCREEN = .T.
		WITH THIS.PARENT.OLETREEVIEW
		FOR I = 1 TO .NODES.COUNT
		.NODES(I).EXPANDED = .F.
		ENDFOR
		ENDWITH
		THISFORM.LOCKSCREEN = .F.
	ENDPROC

	PROCEDURE Tscombobox1.Init
		WAIT WINDOW NOCLEAR NOWAIT ":: Cargando Plan de Cuenta Modelo... Espere un momento... ::"
		DODEFAULT()
		THIS.LISTINDEX = 1
		THISFORM.CARGARARBOL()
		WAIT CLEAR
	ENDPROC

	PROCEDURE Tscombobox1.InteractiveChange
		WAIT WINDOW NOCLEAR NOWAIT ":: Cargando Plan de Cuenta Modelo... Espere un momento... ::"
		THISFORM.CARGARARBOL()
		WAIT CLEAR
	ENDPROC

ENDDEFINE
