*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="arbol.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*


*
#INCLUDE "..\include\tastrade.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	DataSource = .NULL.
	Height = 200
	InitialSelectedAlias = "informes"
	Left = 54
	Name = "Dataenvironment"
	Top = 67
	Width = 535
	
	PROCEDURE BeforeOpenTables
		SET DATE SHORT
		DO SETEO
	ENDPROC

	PROCEDURE Init
		USE DATOS!INFORMES ORDER "ARBOL" IN 0
		USE DATOS!CONTROL IN 0
	ENDPROC

ENDDEFINE

DEFINE CLASS imprimir AS tsbaseform OF "..\libs\tsbase.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Ts3dshape3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Container1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Shape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="descrip" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="ejecutar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Caja1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Caja2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Caja3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Destino" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Caja4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Caja5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="caja6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="oleImagesList" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Container2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="OleTreeView" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Agrupar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Caja7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Caja8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Label1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Resumen" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Caja9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Caja10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Timer1" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*m: *filtrar
		*m: *html
		*m: *limpiar
		*m: *pdf
		*m: *prepararentorno
		*m: *preview
		*m: *tiff
		*m: *xls
		*m: *xml
	*</DefinedPropArrayMethod>

	AlwaysOnTop = .F.
	AutoCenter = .T.
	BorderStyle = 2
	Caption = "Imprimir"
	ctoolbar = 
	DataSession = 2
	DoCreate = .T.
	editmode = .T.
	FontSize = 8
	Height = 496
	HelpContextID = 106
	Icon = ..\bitmaps\labels.ico
	KeyPreview = .T.
	LockScreen = .F.
	MaxButton = .F.
	MinButton = .F.
	Name = "Imprimir"
	ShowTips = .T.
	ShowWindow = 1
	WhatsThisButton = .T.
	WhatsThisHelp = .T.
	Width = 590
	WindowState = 0
	WindowType = 0
	lblRequerido.Name = "lblRequerido"

	ADD OBJECT 'Agrupar' AS optiongroup WITH ;
		AutoSize = .F., ;
		BackStyle = 0, ;
		ButtonCount = 2, ;
		Height = 24, ;
		Left = 14, ;
		Name = "Agrupar", ;
		SpecialEffect = 0, ;
		TabIndex = 23, ;
		Top = 25, ;
		Value = 1, ;
		Width = 286, ;
		Option1.Alignment = 0, ;
		Option1.AutoSize = .F., ;
		Option1.BackStyle = 0, ;
		Option1.Caption = "Por Categoría", ;
		Option1.FontBold = .F., ;
		Option1.FontSize = 8, ;
		Option1.Height = 16, ;
		Option1.Left = 20, ;
		Option1.Name = "Option1", ;
		Option1.Top = 4, ;
		Option1.Value = 1, ;
		Option1.Width = 112, ;
		Option2.AutoSize = .F., ;
		Option2.BackStyle = 0, ;
		Option2.Caption = "Por Orden Alfabetico", ;
		Option2.FontBold = .F., ;
		Option2.FontSize = 8, ;
		Option2.Height = 16, ;
		Option2.Left = 149, ;
		Option2.Name = "Option2", ;
		Option2.Top = 4, ;
		Option2.Width = 139
		*< END OBJECT: BaseClass="optiongroup" />

	ADD OBJECT 'Caja1' AS caja WITH ;
		Left = 314, ;
		Name = "Caja1", ;
		SpecialEffect = 0, ;
		TabIndex = 1, ;
		Top = 26, ;
		Cmdcal1.Name = "Cmdcal1", ;
		ETIQ.Name = "ETIQ", ;
		LISTA.Name = "LISTA", ;
		TEXTO.Name = "TEXTO", ;
		texto2.Name = "texto2"
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="container" />

	ADD OBJECT 'Caja10' AS caja WITH ;
		Left = 314, ;
		Name = "Caja10", ;
		TabIndex = 8, ;
		Top = 368, ;
		Cmdcal1.Name = "Cmdcal1", ;
		etiq.Name = "etiq", ;
		Lista.Name = "Lista", ;
		texto.Name = "texto", ;
		texto2.Name = "texto2"
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="container" />

	ADD OBJECT 'Caja2' AS caja WITH ;
		Left = 314, ;
		Name = "Caja2", ;
		SpecialEffect = 0, ;
		TabIndex = 2, ;
		Top = 64, ;
		Cmdcal1.Name = "Cmdcal1", ;
		ETIQ.Name = "ETIQ", ;
		LISTA.Name = "LISTA", ;
		TEXTO.Name = "TEXTO", ;
		texto2.Name = "texto2"
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="container" />

	ADD OBJECT 'Caja3' AS caja WITH ;
		Left = 314, ;
		Name = "Caja3", ;
		TabIndex = 3, ;
		Top = 102, ;
		Cmdcal1.Name = "Cmdcal1", ;
		ETIQ.Name = "ETIQ", ;
		LISTA.Name = "LISTA", ;
		TEXTO.Name = "TEXTO", ;
		texto2.Name = "texto2"
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="container" />

	ADD OBJECT 'Caja4' AS caja WITH ;
		Left = 314, ;
		Name = "Caja4", ;
		TabIndex = 4, ;
		Top = 140, ;
		Cmdcal1.Name = "Cmdcal1", ;
		ETIQ.Name = "ETIQ", ;
		LISTA.Name = "LISTA", ;
		TEXTO.Name = "TEXTO", ;
		texto2.Name = "texto2"
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="container" />

	ADD OBJECT 'Caja5' AS caja WITH ;
		Left = 314, ;
		Name = "Caja5", ;
		TabIndex = 5, ;
		Top = 178, ;
		Cmdcal1.Name = "Cmdcal1", ;
		ETIQ.Name = "ETIQ", ;
		LISTA.Name = "LISTA", ;
		TEXTO.Name = "TEXTO", ;
		texto2.Name = "texto2"
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="container" />

	ADD OBJECT 'caja6' AS caja WITH ;
		Left = 314, ;
		Name = "caja6", ;
		TabIndex = 6, ;
		Top = 216, ;
		Cmdcal1.Name = "Cmdcal1", ;
		ETIQ.Name = "ETIQ", ;
		LISTA.Name = "LISTA", ;
		TEXTO.Name = "TEXTO", ;
		texto2.Name = "texto2"
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="container" />

	ADD OBJECT 'Caja7' AS caja WITH ;
		Left = 314, ;
		Name = "Caja7", ;
		TabIndex = 7, ;
		Top = 254, ;
		Cmdcal1.Name = "Cmdcal1", ;
		etiq.Name = "etiq", ;
		Lista.Name = "Lista", ;
		texto.Name = "texto", ;
		texto2.Name = "texto2"
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="container" />

	ADD OBJECT 'Caja8' AS caja WITH ;
		Left = 314, ;
		Name = "Caja8", ;
		TabIndex = 8, ;
		Top = 292, ;
		Cmdcal1.Name = "Cmdcal1", ;
		etiq.Name = "etiq", ;
		Lista.Name = "Lista", ;
		texto.Name = "texto", ;
		texto2.Name = "texto2"
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="container" />

	ADD OBJECT 'Caja9' AS caja WITH ;
		Left = 314, ;
		Name = "Caja9", ;
		TabIndex = 7, ;
		Top = 330, ;
		Cmdcal1.Name = "Cmdcal1", ;
		etiq.Name = "etiq", ;
		Lista.Name = "Lista", ;
		texto.Name = "texto", ;
		texto2.Name = "texto2"
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="container" />

	ADD OBJECT 'Command1' AS commandbutton WITH ;
		Caption = "\<Cerrar", ;
		ColorScheme = 1, ;
		ColorSource = 4, ;
		Enabled = .T., ;
		FontSize = 8, ;
		Height = 44, ;
		Left = 456, ;
		MousePointer = 0, ;
		Name = "Command1", ;
		Picture = ..\bitmaps\close.bmp, ;
		SpecialEffect = 2, ;
		Style = 0, ;
		TabIndex = 10, ;
		Top = 414, ;
		Width = 121
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Command2' AS commandbutton WITH ;
		Caption = "Editar...", ;
		FontSize = 8, ;
		Height = 27, ;
		Left = 12, ;
		Name = "Command2", ;
		Style = 1, ;
		Top = 456, ;
		Width = 84
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Container1' AS container WITH ;
		BackColor = 0,0,128, ;
		BackStyle = 0, ;
		Height = 404, ;
		Left = 308, ;
		Name = "Container1", ;
		SpecialEffect = 1, ;
		TabIndex = 18, ;
		Top = 7, ;
		Width = 280
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'Container2' AS container WITH ;
		BackColor = 0,128,192, ;
		BackStyle = 0, ;
		Height = 314, ;
		Left = 6, ;
		Name = "Container2", ;
		SpecialEffect = 1, ;
		TabIndex = 19, ;
		Top = 7, ;
		Width = 299
		*< END OBJECT: BaseClass="container" />

	ADD OBJECT 'descrip' AS label WITH ;
		BackStyle = 0, ;
		Caption = "Descripción del informe", ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 47, ;
		Left = 12, ;
		Name = "descrip", ;
		TabIndex = 21, ;
		Top = 334, ;
		Width = 282, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Destino' AS tscombobox WITH ;
		BoundColumn = 2, ;
		ColumnCount = 2, ;
		ColumnLines = .F., ;
		ColumnWidths = "136,0", ;
		FirstElement = 1, ;
		Height = 24, ;
		Left = 14, ;
		Name = "Destino", ;
		NumberOfElements = 0, ;
		Picture = ..\, ;
		RowSource = "Vista Preliminar,V,Impresora,I,Archivo TXT,A,Excel,XLS,HTML,HTML,XML,XML,TIFF,TIFF,PDF,PDF", ;
		RowSourceType = 1, ;
		SpecialEffect = 2, ;
		Style = 2, ;
		TabIndex = 14, ;
		Top = 416, ;
		Width = 120, ;
		ZOrderSet = 11
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'ejecutar' AS commandbutton WITH ;
		Caption = "\<Ejecutar", ;
		ColorScheme = 1, ;
		ColorSource = 4, ;
		Enabled = .F., ;
		FontSize = 8, ;
		Height = 44, ;
		Left = 324, ;
		MousePointer = 0, ;
		Name = "ejecutar", ;
		Picture = ..\bitmaps\wzprint.bmp, ;
		SpecialEffect = 2, ;
		Style = 0, ;
		TabIndex = 9, ;
		Top = 414, ;
		Width = 132
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Label1' AS label WITH ;
		Alignment = 2, ;
		AutoSize = .F., ;
		Caption = "\<Destino de la Impresión", ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 18, ;
		Left = 13, ;
		Name = "Label1", ;
		TabIndex = 11, ;
		Top = 391, ;
		Width = 145, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label2' AS label WITH ;
		AutoSize = .T., ;
		Caption = "Descripción", ;
		FontName = "MS Sans Serif", ;
		FontSize = 8, ;
		Height = 15, ;
		Left = 13, ;
		Name = "Label2", ;
		TabIndex = 20, ;
		Top = 321, ;
		Width = 58
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label3' AS label WITH ;
		Alignment = 2, ;
		AutoSize = .F., ;
		BackColor = 0,0,128, ;
		BackStyle = 1, ;
		Caption = "\<Parámetros", ;
		FontBold = .T., ;
		FontName = "Arial", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Height = 15, ;
		Left = 315, ;
		Name = "Label3", ;
		TabIndex = 16, ;
		Top = 11, ;
		Width = 268, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label6' AS label WITH ;
		Alignment = 2, ;
		AutoSize = .F., ;
		BackColor = 0,0,128, ;
		BackStyle = 1, ;
		Caption = "\<Informes", ;
		FontBold = .T., ;
		FontName = "Arial", ;
		FontSize = 8, ;
		ForeColor = 255,255,255, ;
		Height = 15, ;
		Left = 14, ;
		Name = "Label6", ;
		TabIndex = 15, ;
		Top = 10, ;
		Width = 286, ;
		WordWrap = .T.
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'Label7' AS label WITH ;
		Alignment = 2, ;
		AutoSize = .F., ;
		Caption = "Opciones", ;
		FontSize = 8, ;
		FontUnderline = .T., ;
		ForeColor = 0,0,255, ;
		Height = 16, ;
		Left = 156, ;
		MouseIcon = ..\..\archivos de programa\microsoft visual foxpro 7\graphics\cursors\h_point.cur, ;
		MousePointer = 99, ;
		Name = "Label7", ;
		TabIndex = 11, ;
		Top = 432, ;
		Width = 54, ;
		WordWrap = .T., ;
		ZOrderSet = 9
		*< END OBJECT: BaseClass="label" />

	ADD OBJECT 'oleImagesList' AS olecontrol WITH ;
		Height = 37, ;
		Left = 276, ;
		Name = "oleImagesList", ;
		Top = 0, ;
		Width = 49
		*< END OBJECT: BaseClass="olecontrol"  Nombre="Imprimir.oleImagesList" Parent="Imprimir" ObjName="oleImagesList" OLEObject="C:\Windows\system32\MSCOMCTL.OCX" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAABQAAAAYAAAAHAAAACAAAAAkAAAD+/////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMApQn3NVM4BAwAAAEAMAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAALAsAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAHIAAAAAAAAAAQAAAP7///8DAAAA/v///wUAAAAGAAAABwAAAAgAAAAJAAAACgAAAAsAAAAMAAAADQAAAA4AAAAPAAAAEAAAABEAAAASAAAAEwAAABQAAAAVAAAAFgAAABcAAAAYAAAAGQAAABoAAAAbAAAAHAAAAB0AAAAeAAAAHwAAACAAAAAhAAAAIgAAACMAAAAkAAAAJQAAACYAAAAnAAAAKAAAACkAAAAqAAAAKwAAACwAAAAtAAAALgAAAC8AAAAwAAAA/v////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9cAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAAAAAAJAAAADgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADkzNjgyNjVFLTg1RkUtMTFkMS04QkUzLTAwMDBGODc1NERBMQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAIAMAAAASW1hZ2VIZWlnaHQACQAAAEkKAAAAEAAAAAsAAABJbWFnZVdpZHRoAAkAAABJCgAAABAAAAANAAAAVXNlTWFza0NvbG9yAAUAAABMAQAAAAoAAABCYWNrQ29sb3IACQAAAEkKAAAADAAAgAAAAAAAAAAAAAAAAAAAI38kLJGF0RGxagDA8Cg2KCFDNBIIAAAA7QMAAO0DAACAfuHmAAAGACQAAAAQABAAwMDAAP//AAAB782rAAAFAAAAAAAGAAAA/////wwAAIAAAAAABAAAAAAAAAAEAAAAAQAAAGx0AAA2BAAAAAABAAIAICAQAAAAAADoAgAAJgAAABAQEAAAAAAAKAEAAA4DAAAoAAAAIAAAAEAAAAABAAQAAAAAAIACAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA0AAIiAAACQAAzMwAAAAA3Q0ACIgHAAkJAMzMDAAAAA0H0AiIB3AJB5AAAAzAAAAN0H0IiAd3CQlwzMwMzAAAANDXCIgHdwkHkMzMDMzAAADdDQiIB3cJCXDMzAzMwAAADQcIiAd3CQeQzMwMzMAAAA3QCIgHdwkJcMzMDMzAAAAA0AiIB3cJB5DMzAzMwAAAAN0IeAd3CQlwzMwMzMAAAAANCHgHdwkHkMzMDMzAAAAADQh4B3cJCXDMzAzMwAAAAAAIeAd3CQeQzMwMzMAAAAAACIgHdwkJcMzMDMzAAAAAAAh4B3cJB5DMzAzMwAAAAAAIeAd3CQlwzMwMzMAAAAAACHgHdwkHkMzMDMzAAAAAAAiIB3cACXDMzAzMwAAAAAAIiAd3cICQzMwMzMAAAAAAAAAHd3cIAMzMDMzAAAAAAACIgHd3AIAAAAzMwAAAAAAACIgHdwAAzMwMzMAAAAAAAACIgHcAAMzMDMzAAAAAAAAACIgHAAAAAAzMwAAAAAAAAACIgAAACIiAzMAAAAAAAAAAAAAAAACIiAzAAAAAAAAAAAAAAAAACIiAwAAAAAAAAAAAAAAAAACIiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/////44OMD8GBhAfAgIAD4AAAAeAAAADwAAAAcAAAAHgAAAB4AAAAfAAAAHwAAAB+AAAAfgAAAH8AAAB/AAAAf4AAAH+AAAB/gAAAf4AAAH+AAAB/gAAAf8AAAH/gCAB/8AwAf/gMAH/8DgB//g8Af///gH///8B////gf////8oAAAAEAAAACAAAAABAAQAAAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAgAAAgAAAAICAAIAAAACAAIAAgIAAAICAgADAwMAAAAD/AAD/AAAA//8A/wAAAP8A/wD//wAA////AA0AAAAAAAAADQCAAJAMAAANAIBwlwAMAADQgHCXDAzAANCAcJcMDMAAAIBwlwwMwAAAgHCXDAzAAACAcJcMDMAAAIBwlwwMwAAAgHCXDAzAAAAAdwAMDMAAAAgHAAwMwAAAAIAAAAzAAAAAAAAIgMAAAAAAAACIAAAAAAAAAAAAIkcAAAADAAAAAQAAgAAAAIAAAADAAAAAwAAAAOAAAADgAAAA4AAAAOAAAADwAAAA+EAAAPxAAAD/4AAA//AAAAIAAABsdAAANgQAAAAAAQACACAgEAAAAAAA6AIAACYAAAAQEBAAAAAAACgBAAAOAwAAKAAAACAAAABAAAAAAQAEAAAAAACAAgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIAAAACAgACAAAAAgACAAICAAACAgIAAwMDAAAAA/wAA/wAAAP//AP8AAAD/AP8A//8AAP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJmZmQAAAAAAAAAAAAAAAACZmZkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA//AAAAAAAAAAAAAAAAAAD//wAAAAAAAAAAAAAAAAAP//8AAAAAAAAAAAAAAAAAD///AAAAAAAAAICAAAAAAA///wAAAAAACIgAB3d3d3D///8AAAAACIgA8PAAAAAP8A//AAAIiIAA//D/////Dw8A/wAACAAP///w/////wD/APAAAAgP////cP/39/f3/wDwAAAID///f/D///////kAAAAACQ//f//w//f39/f/AAAAAAgJf///cP///////wAAAAAID///f/D/9/f39/8AAAAACA//f//w////////AAAAAAgPf///cP/39/f3/wAAAAAID///f/D///////8AAAAACA//f//w//f39/f/AAAAAA8Pf///cP///////wAAAAAPD///f/AP//////8AAAAADw//f//wAAAAAAAAAAAAAA8Pf///AAAAAAAAAAAAAAAPD///AAAAAAAAAAAAAAAAAA/wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP//////////////AP///wD///8A////AP///4P///8D///+A//j/gP/AAAD+AAAAwAAAAMAAAADAAAABwAAAAcAAAAPAAAADwAAAB8AAAAfAAAAHwAAAB8AAAAfAAAAHwAAAB8AAAA/AAQAPwAP//8AH///gH///+P/////////KAAAABAAAAAgAAAAAQAEAAAAAADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIAAAACAgACAAAAAgACAAICAAACAgIAAwMDAAAAA/wAA/wAAAP//AP8AAAD/AP8A//8AAP///wAAAAAAAAAJkAAAAAAAAAmQAAAAAAAAAAAAAAAAAAAPAAAAAAAAAP8AAAAHAAAA/wAAh3cHdw8PAAgP/w//gA8ACA//D///AAAID/8Pf38AAAgP/w///wAADw//D39/AAAPD/8P//8AAA8P8AAAAAAAAAAAAAAAAAAAAAAAAAAAAP/wAAD/8AAA//AAAP/xAAD54QAAwAEAAAABAAAAAQAAAAMAAAADAAAAAwAAAAMAAAADAAAABwAAA/8AAN//AAADAAAAbHQAAEABAAAAAAEAAQAQEBAAAAAAACgBAAAWAAAAKAAAABAAAAAgAAAAAQAEAAAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAIAAAIAAAACAgACAAAAAgACAAICAAADAwMAAgICAAAAA/wAA/wAAAP//AP8AAAD/AP8A//8AAP///wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAsGdnZ2dgAAAAdnZ2dnAAALBnZ2dnYAAAAHZ2dnZwAACwZ2dnZ2AAAAB2dnZ2cAAAsGdnZ2dgAAAAcAAAAHAAALBg///wYAAAAHAAAABwAACwZ2dnZ2AAAAAAAAAAAAAAAAAAAAAAAP//AAD//wAAwAMAAIADAADAAwAAgAMAAMADAACAAwAAwAMAAIADAADAAwAAgAMAAMADAACAAwAAwAMAAP//AAAAAAQAAABsdAAA8AAAAEJN7gAAAAAAAAB2AAAAKAAAABAAAAAPAAAAAQAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAIAAAACAgACAAAAAgACAAICAAACAgIAAwMDAAAAA/wAA/wAAAP//AP8AAAD/AP8A//8AAP///wCIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIiIRERESIiIiIhERERIiIiIiEREREiIiIiIRE9ESIiIiIhET0RIiIiIiEREREiIiIiIhIiEiIiIiIiEiISIiIiIiISIhIiIiIiIiERIiIiIiIiIiIiIiIiIiIiIiIiIgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA==" />

	ADD OBJECT 'OleTreeView' AS olecontrol WITH ;
		Enabled = .T., ;
		Height = 256, ;
		Left = 14, ;
		Name = "OleTreeView", ;
		TabIndex = 17, ;
		Top = 56, ;
		Width = 286
		*< END OBJECT: BaseClass="olecontrol"  Nombre="Imprimir.OleTreeView" Parent="Imprimir" ObjName="OleTreeView" OLEObject="C:\Windows\system32\MSCOMCTL.OCX" Value="0M8R4KGxGuEAAAAAAAAAAAAAAAAAAAAAPgADAP7/CQAGAAAAAAAAAAAAAAABAAAAAQAAAAAAAAAAEAAAAgAAAAEAAAD+////AAAAAAAAAAD////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////9/////v////7///8EAAAA/v///////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////1IAbwBvAHQAIABFAG4AdAByAHkAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAWAAUA//////////8BAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAMApQn3NVM4BAwAAAAADAAAAAAAAAwBPAGwAZQBPAGIAagBlAGMAdABEAGEAdABhAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAB4AAgEDAAAAAgAAAP////8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAigAAAAAAAAADAEEAYwBjAGUAcwBzAE8AYgBqAFMAaQB0AGUARABhAHQAYQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAJgACAP///////////////wAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAABcAAAAAAAAAAMAQwBoAGEAbgBnAGUAZABQAHIAbwBwAHMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAcAAIA////////////////AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAJsBAAAAAAAACAAAAAIAAAD+////BAAAAAUAAAAGAAAABwAAAAkAAAAKAAAACwAAAP7////+//////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////////+2kEHHiYXREbFqAMDwKDYoIUM0EggAAACPHQAAdRoAALE8wWoBAAYAIgAAAB0BAAARAgAACgAAAAEAAAAB782rXAAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAAAAACQAAAA4AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA5MzY4MjY1RS04NUZFLTExZDEtOEJFMy0wMDAwRjg3NTREQTEAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAACADgAAAEhpZGVTZWxlY3Rpb24ABQAAAEwAAAAADAAAAEluZGVudGF0aW9uABEAAABODQAAAAcAAAAAAAAAAAA0QAoAAABMaW5lU3R5bGUACQAAAEkKAAAAAQAAAA0AAABNb3VzZVBvaW50ZXIACQAAAEkKAAAAAAAAAA4AAABQYXRoU2VwYXJhdG9yAAoAAABIAAAAAAEAAABcBwAAAFNvcnRlZAAFAAAATAEAAAAMAAAAT0xFRHJhZ01vZGUACQAAAEkKAAAAAAAAAAwAAABPTEVEcm9wTW9kZQAJAAAASQoAAAAAAAAACwAAAEFwcGVhcmFuY2UACQAAAEkKAAAAAQAAAAwAAABCb3JkZXJTdHlsZQAJAAAASQoAAAABAAAACwAAAENoZWNrYm94ZXMABQAAAEwAAAAADgAAAAAABQCwcxQIBwAAAAAAAAAFAACAzL8SAAEAAABcAB/e7L0BAAUAFcASAANS4wuRj84RneMAqgBLuFEBAAAAkAFGdWxsUm93U2VsZWN0AAUAAABMAQAAAAwAAABIb3RUcmFja2luZwAFAAAATAAAAAAHAAAAU2Nyb2xsAAUAAABMREIBAAVBcmlhbAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAKAAAAU2luZ2xlU2VsAAUAAABMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAoAQAADgMAACgAAAAgAAAAQAAAAAEABAAAAAAAgAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAACAAACAAAAAgIAAgAAAAIAAgACAgAAAgICAAMDAwAAAAP8AAP8AAAD//wD/AAAA/wD/AP//AAD///8AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADu7u7oiIAAAAAAAAAAAAAA7u7u6IiAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAP////iAAAAAAAAAAAAAAA//////iAAAAAAAAAAAAAAP/////4gAAAAAAA" />

	ADD OBJECT 'Resumen' AS tscheckbox WITH ;
		Alignment = 1, ;
		AutoSize = .F., ;
		Caption = "Solo resumen", ;
		Comment = "", ;
		ControlSource = "", ;
		editable = .F., ;
		Enabled = .F., ;
		Height = 16, ;
		Left = 156, ;
		Name = "Resumen", ;
		TabIndex = 24, ;
		Top = 415, ;
		Width = 84
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="checkbox" />

	ADD OBJECT 'Shape1' AS shape WITH ;
		BackStyle = 0, ;
		Height = 61, ;
		Left = 5, ;
		Name = "Shape1", ;
		SpecialEffect = 0, ;
		Top = 328, ;
		Width = 294
		*< END OBJECT: BaseClass="shape" />

	ADD OBJECT 'Timer1' AS timer WITH ;
		Height = 23, ;
		Interval = 10000, ;
		Left = 168, ;
		Name = "Timer1", ;
		Top = 456, ;
		Width = 23
		*< END OBJECT: BaseClass="timer" />

	ADD OBJECT 'Ts3dshape3' AS ts3dshape WITH ;
		Height = 56, ;
		Left = 6, ;
		Name = "Ts3dshape3", ;
		Top = 396, ;
		Width = 294, ;
		ZOrderSet = 2
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="shape" />
	
	PROCEDURE filtrar
		SELECT CONTROL
		SET FILTER TO UPPER(ALLTRIM(INFORMES.PARAM1))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(INFORMES.PARAM2))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(INFORMES.PARAM3))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(INFORMES.PARAM4))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(INFORMES.PARAM5))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(INFORMES.PARAM6))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(INFORMES.PARAM7))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(INFORMES.PARAM8))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(INFORMES.PARAM9))==UPPER(ALLTRIM(CONTROL.VARIABLE)) .OR. UPPER(ALLTRIM(INFORMES.PARAM10))==UPPER(ALLTRIM(CONTROL.VARIABLE))
		SELECT INFORMES
		GOTO TOP IN CONTROL
		FOR X = 1 TO 10
			OBJETO = 'caja'+ALLTRIM(STR(X))
			IF  .NOT. EOF('control')
		
				THIS.&OBJETO..VISIBLE=.T.
				THIS.&OBJETO..ETIQ.CAPTION=ALLTRIM(CONTROL.ETIQUETA)
				VALOR = CONTROL.VALUE
				VARIABLE = CONTROL.VARIABLE
				THIS.&OBJETO..REQUERY=CONTROL.REQUERY
				IF CONTROL.TIPO="L"
					VRSOURCE = CONTROL.RSOURCE
					IF CONTROL.ORIGEN='R'
						THIS.&OBJETO..LISTA.CMDSQL=VRSOURCE
						THIS.&OBJETO..LISTA.CURSOR=THIS.&OBJETO..NAME
						THIS.&OBJETO..LISTA.INIT()
					ELSE
						THIS.&OBJETO..LISTA.ROWSOURCE=""
						THIS.&OBJETO..LISTA.ROWSOURCETYPE=CONTROL.RSOURCETYP
						THIS.&OBJETO..LISTA.ROWSOURCE=VRSOURCE
						IF  .NOT. EMPTY(CONTROL.BOUNDCOL)
							THIS.&OBJETO..LISTA.BOUNDCOLUMN=CONTROL.BOUNDCOL
						ELSE
							THIS.&OBJETO..LISTA.BOUNDCOLUMN=1
						ENDIF
					ENDIF
					THIS.&OBJETO..LISTA.STYLE=CONTROL.STYLE
					THIS.&OBJETO..LISTA.VISIBLE=.T.
					THIS.&OBJETO..TEXTO.VISIBLE=.F.
					IF TYPE(VARIABLE)<>"U"
						THIS.&OBJETO..LISTA.VALUE = &VARIABLE
					ELSE
						THIS.&OBJETO..LISTA.VALUE=&VALOR
					ENDIF
				ELSE
					THIS.&OBJETO..TEXTO.INPUTMASK=ALLTRIM(CONTROL.INPUTMASK)
					THIS.&OBJETO..TEXTO.MAXLENGTH=CONTROL.MAXLENGTH
					IF TYPE(VARIABLE)<>"U"
						THIS.&OBJETO..TEXTO.VALUE = &VARIABLE
					ELSE
						THIS.&OBJETO..TEXTO.VALUE=&VALOR
					ENDIF
					THIS.&OBJETO..LISTA.VISIBLE=.F.
					THIS.&OBJETO..TEXTO.VISIBLE=.T.
				ENDIF
				THIS.&OBJETO..TEXTO.STATUSBARTEXT = ''
				IF  .NOT. EMPTY(CONTROL.DATOAYUDA)
					THIS.&OBJETO..TEXTO.DATOAYUDA = CONTROL.DATOAYUDA
					THIS.&OBJETO..TEXTO.INIT()
				ELSE
					THIS.&OBJETO..TEXTO.DATOAYUDA = ''
					THIS.&OBJETO..TEXTO.STATUSBARTEXT = THIS.&OBJETO..ETIQ.CAPTION
					THIS.&OBJETO..TEXTO.INIT()
				ENDIF
				THIS.&OBJETO..NOMBVAR=VARIABLE
				IF TYPE(VARIABLE)="U"
					PUBLIC &VARIABLE
					&VARIABLE = &VALOR
				ENDIF
				SKIP IN CONTROL
			ELSE
				THIS.&OBJETO..VISIBLE=.F.
			ENDIF
		ENDFOR
		THISFORM.RESUMEN.ENABLED = INFORMES.RESUMEN
		IF  .NOT. THISFORM.RESUMEN.ENABLED
			THISFORM.RESUMEN.VALUE = .F.
		ENDIF
	ENDPROC

	PROCEDURE html
		LPARAMETERS REPORTNAME
		LOCAL LCDIRECTORY, LOLISTENER, LOSHELL
		LCDIRECTORY = SYS(16)
		LCDIRECTORY = ADDBS(JUSTPATH(SUBSTR(LCDIRECTORY, AT(' ', LCDIRECTORY, 2)+1)))
		LOLISTENER = .NULL.
		DO (_ReportOutput) WITH 5, LOLISTENER
		LOLISTENER.TARGETFILENAME = FORCEPATH('Resultado.html', SYS(2023))
		LOLISTENER.QUIETMODE = .T.
		WAIT WINDOW NOWAIT 'Generando HTML...'
		ERASE (LOLISTENER.TARGETFILENAME)
		REPORT FORM (REPORTNAME) OBJECT LOLISTENER
		LOSHELL = NEWOBJECT('_shellexecute', HOME()+'ffc\_environ.vcx')
		LOSHELL.SHELLEXECUTE(LOLISTENER.TARGETFILENAME)
		WAIT CLEAR
		THISFORM.REFRESH()
	ENDPROC

	PROCEDURE Init
		PARAMETER MGRUPO
		LOCAL FILTRO
		IF PARAMETERS()>0
			FILTRO = "FOR idsistema = oApp.Sistema and UPPER(GRUPO)=UPPER(mGrupo)"
		ELSE
			FILTRO = "FOR (EMPTY(empresas) or OCCURS(oApp.Empresa,empresas)>0) and (idsistema = oApp.Sistema or occurs(oApp.Sistema,sinonimo)>0) "
		ENDIF
		
		*!*	IF THIS.RUNSQL("Select convert(char(10),dbo.LeerConstante(?oApp.Empresa,'SYS_FUTURA')) as Deposito", 'cConfig')>0
		*!*		IF RECCOUNT('cConfig')>0
		*!*			IF EMPTY(NVL(CCONFIG.Deposito, ''))
		*!*				o=CREATEOBJECT("FuturaCOM.LicenciamientoClient")
		*!*				Valido = o.Validar(oApp.Empresa,oApp.NombreEmpresa)
		*!*				IF !valido AND EMPTY(o.MensajeError)
		*!*					MESSAGEBOX("Su licencia ha expirado. Por favor contacte con su proveedor.",16,TASTRADE_LOC)
		*!*					RETURN .f.
		*!*				ELSE
		*!*					IF valido AND !EMPTY(o.MensajeError)
		*!*						MESSAGEBOX(o.MensajeError,64,TASTRADE_LOC)
		*!*					endif		
		*!*				ENDIF
		*!*				o=null
		*!*			ENDIF 
		*!*		ENDIF
		*!*	ENDIF
		
		*DO FOXYPREVIEWER.APP
			
		
		*SET STEP ON
		*SET PROCEDURE TO frxexp_proc ADDITIVE 
		
		DO SETEO
		IF TYPE("THIS.oleTreeview")<>"O" .OR. ISNULL(THIS.OLETREEVIEW)
			RETURN .F.
		ENDIF
		IF TYPE("THIS.oleImagesList")<>"O" .OR. ISNULL(THIS.OLEIMAGESLIST)
			RETURN .F.
		ENDIF
		THISFORM.OLETREEVIEW.DOVERB(-1)
		THIS.OLETREEVIEW.IMAGELIST = THIS.OLEIMAGESLIST
		O = THISFORM.OLETREEVIEW.NODES
		O.CLEAR
		SELECT INFORMES
		SCAN &FILTRO
		
			m.Activo = .t. 
			IF IDOBJETO<>0 AND INFORMES.DISPONIBLE
				m.Activo = OAPP.PERMISOS(IDOBJETO)
			ELSE
				m.Activo = INFORMES.DISPONIBLE
			ENDIF
			IF LCAGRUPACION='C'
				IF ALLTRIM(PARENT)='0_'
					O.ADD( , 1, ALLTRIM(KEY), ALLTRIM(TEXT), 1, 2)
				ELSE
					IF m.Activo
						IF EMPTY(REPOFILE)
							O.ADD(ALLTRIM(PARENT), 4, ALLTRIM(KEY), ALLTRIM(TEXT), 1, 2)
						ELSE
							O.ADD(ALLTRIM(PARENT), 4, ALLTRIM(KEY), ALLTRIM(TEXT), 3, 3)
						ENDIF
					ELSE
						O.ADD(ALLTRIM(PARENT), 4, ALLTRIM(KEY), ALLTRIM(TEXT), 4, 4)
					ENDIF
				ENDIF
			ELSE
				IF m.Activo
					O.ADD( , 1, ALLTRIM(KEY), ALLTRIM(TEXT), 3, 3)
				ELSE
					O.ADD( , 1, ALLTRIM(KEY), ALLTRIM(TEXT), 4, 4)
				ENDIF
			ENDIF
			
			IF GOMONTH(fecha,3)>DATE() THEN 
				O.Item(O.Count).ForeColor = RGB(0,0,255)
				O.Item(O.Count).Text = 	O.Item(O.Count).Text + " (Nuevo) "
			ENDIF
			
		ENDSCAN
		THISFORM.OLETREEVIEW.FONT.SIZE = 8
		THISFORM.OLETREEVIEW.LABELEDIT = 1
		THISFORM.OLETREEVIEW.LINESTYLE = 1
		THISFORM.OLETREEVIEW.SORTED = .T.
		PUBLIC CDOSNAME
		m.CDOSNAME = ' '
		THISFORM.REFRESH()
		THIS.FILTRAR()
		DEFINE WINDOW RESULTADO FROM 2, 1 TO 13, 75 GROW FLOAT CLOSE ZOOM TITLE 'Resultado'
	ENDPROC

	PROCEDURE limpiar
		FOR X = 1 TO 10
		OBJETO = 'caja'+ALLTRIM(STR(X))
		IF THISFORM.&OBJETO..VISIBLE
		VARIABLE=THISFORM.&OBJETO..NOMBVAR
		RELEASE &VARIABLE
		ENDIF
		ENDFOR
	ENDPROC

	PROCEDURE pdf
		LPARAMETERS Reporte,Resumen
		Local LCDIRECTORY, LOSHELL, LOERROR
		Local loListener As ReportListener 
		
		TRY
		
		LCDIRECTORY = SYS(16)
		LCDIRECTORY = Addbs(Justpath(Substr(LCDIRECTORY, At(' ', LCDIRECTORY, 2)+1)))
		
		loListener = NewObject('PdfListener', 'PDFx.vcx') &&Use 'PdfListener2' to create PDF as an Image 
		loListener.cTargetFileName = Forcepath(JUSTSTEM(reporte), SYS(2023)) + ".pdf"
		loListener.QuietMode=.F. 
		loListener.lEncryptDocument=.F. 
		loListener.lCanEdit=.F. &&Only if lEncryptDocument=.T. 
		loListener.lCanCopy=.T. &&Only if lEncryptDocument=.T. 
		loListener.lCanAddNotes=.F. &&Only if lEncryptDocument=.T. 
		loListener.lCanPrint=.T. &&Only if lEncryptDocument=.T. 
		loListener.cMasterPassword="masterpassword" &&Only if lEncryptDocument=.T. 
		loListener.cUserPassword="userpassoword" &&Only if lEncryptDocument=.T. 
		loListener.lOpenViewer=.T. 
		Erase (LOLISTENER.cTARGETFILENAME)
		Report Form (Reporte) Object loListener &Resumen
		LOSHELL = Newobject('_shellexecute', Home()+'ffc\_environ.vcx')
			LOSHELL.SHELLEXECUTE(LOLISTENER.cTARGETFILENAME)
		Catch To LOERROR
			Messagebox(LOERROR.Message)
		Endtry
		Wait Clear
		
		
		*!*	Local LCDIRECTORY, LOLISTENER, LOSHELL, LOERROR
		*!*	Try
		*!*		LCDIRECTORY = SYS(16)
		*!*		LCDIRECTORY = Addbs(Justpath(Substr(LCDIRECTORY, At(' ', LCDIRECTORY, 2)+1)))
		*!*		LOLISTENER = Newobject('MPTiffListener', 'europa.vcx')
		*!*		LOLISTENER.TARGETFILENAME = Forcepath('MyReport.tif', SYS(2023))
		*!*		LOLISTENER.Quietmode = .T.
		*!*		Wait Window Nowait 'Outputting to TIFF...'
		*!*		Erase (LOLISTENER.TARGETFILENAME)
		*!*		Report Form (REPORTNAME) Object LOLISTENER
		*!*		LOSHELL = Newobject('_shellexecute', Home()+'ffc\_environ.vcx')
		*!*		LOSHELL.SHELLEXECUTE(LOLISTENER.TARGETFILENAME)
		*!*	Catch To LOERROR
		*!*		Messagebox(LOERROR.Message)
		*!*	Endtry
		*!*	Wait Clear
		*!*	Thisform.Refresh()
	ENDPROC

	PROCEDURE prepararentorno
		LPARAMETERS lcReporte
		USE (lcReporte) IN 0 ALIAS _cxReporte
		SELECT _cxReporte 
		GO BOTTOM 
		
		EXTERNAL PROCEDURE BEFOREOPENTABLE 
		EXTERNAL PROCEDURE Init
		EXTERNAL PROCEDURE Destroy
		
		COPY MEMO tag  TO _cReporte.prg
		COMPILE _cReporte.prg
		TRY   
			DO BeforeOpenTable IN _cReporte.prg
		CATCH 	
		ENDTRY
		
		TRY   
			DO Init IN _cReporte.prg
		CATCH 	
		ENDTRY
		
		TRY   
			DO Destroy IN _cReporte.prg
		CATCH 	
		ENDTRY
		
		USE IN _cxReporte
		
		 
	ENDPROC

	PROCEDURE preview
	ENDPROC

	PROCEDURE Release
		FOR X = 1 TO 10
		OBJETO = 'caja'+ALLTRIM(STR(X))
		IF THISFORM.&OBJETO..VISIBLE
		VARIABLE=THISFORM.&OBJETO..NOMBVAR
		RELEASE &VARIABLE
		ENDIF
		ENDFOR
		RELEASE CDOSNAME,LCSELEREPO
	ENDPROC

	PROCEDURE tiff
		Lparameters REPORTNAME
		Local LCDIRECTORY, LOLISTENER, LOSHELL, LOERROR
		Try
			LCDIRECTORY = SYS(16)
			LCDIRECTORY = Addbs(Justpath(Substr(LCDIRECTORY, At(' ', LCDIRECTORY, 2)+1)))
			LOLISTENER = Newobject('MPTiffListener', 'europa.vcx')
			LOLISTENER.TARGETFILENAME = Forcepath('MyReport.tif', Sys(2023))
			LOLISTENER.Quietmode = .T.
			Wait Window Nowait 'Outputting to TIFF...'
			Erase (LOLISTENER.TARGETFILENAME)
			Report Form (REPORTNAME) Object LOLISTENER
			LOSHELL = Newobject('_shellexecute', Home()+'ffc\_environ.vcx')
			LOSHELL.SHELLEXECUTE(LOLISTENER.TARGETFILENAME)
		Catch To LOERROR
			Messagebox(LOERROR.Message)
		Endtry
		Wait Clear
		Thisform.Refresh()
	ENDPROC

	PROCEDURE xls
		LPARAMETERS lcFormato,lcNombreReport,Resumen
		*!*	TEXT TO cmdSQL noshow
		*!*		SELECT     d.Nro, d.Fecha, d.Comentario, dd.IdProducto, dd.Producto, dd.Comentario AS ObsDet
		*!*		FROM         vt_Demanda AS d INNER JOIN
		*!*		                      vt_DemandaDet AS dd ON d.IdDemanda = dd.IdDemanda
		*!*		where d.IdEmpresa=?oApp.Empresa
		*!*		and d.Fecha between ?m.dFecha and ?m.hFecha
		*!*		ORDER BY d.Nro
		*!*	ENDTEXT
		
		*!*	sql(cmdSQL,'rpedido')
		*!*	SELECT rpedido
		
		PRIVATE lnRet, llXlsFormat, llModifyFile, lcFilename, lcFrxFileName, lcFileStem, lcToFileType
		llModifyFile = .f.
		llXlsFormat = .t.
		lcFileStem = lcNombreReport
		*	note - specify full path names to be sure
		lcFrxFileName = SYS(5)+CURDIR() + FORCEEXT( m.lcFileStem,"frx")
		lcFilename = SYS(5)+CURDIR() + FORCEEXT( m.lcFileStem, "lcFormato" )
		
			DO CASE
			CASE lcFormato == "XLS"
				lcToFileType = "XL5_97"
				lcFilename =  FORCEEXT( m.lcFilename, "XLS" )
			CASE lcFormato == "DOC"
				lcToFileType = "XL5_doc"
				lcFilename =  FORCEEXT( m.lcFilename, "DOC" )
			CASE lcFormato == "HTML"
				lcToFileType = "XL5_html"
				lcFilename =  FORCEEXT( m.lcFilename, "HTM" )
			CASE lcFormato == "PDF"
				lcToFileType = "XL5_html"
				lcFilename =  FORCEEXT( m.lcFilename, "PDF" )
			CASE lcFormato == "TXT"
				lcToFileType = "XL5_html"
				lcFilename =  FORCEEXT( m.lcFilename, "TXT" )
				
							
			ENDCASE
		*SET STEP ON	
		
		SET PROCEDURE TO LOCFILE("FoxyPreviewer.App") ADDITIVE 
		LOCAL loReport as "PreviewHelper" OF "FoxyPreviewer.App" 
		loReport = CREATEOBJECT("PreviewHelper") 
		WITH loReport as ReportHelper 
		  .AddReport(lcFrxFileName , "NODIALOG "+Resumen) 
		  .cDestFile = lcFilename   && Use para crear una salida din vista previa
		  .RunReport() 
		ENDWITH 
		loReport = NULL 
		=ShellExe( m.lcFilename )
		
		*RUN /N Explorer.Exe (lcFilename)   
		
		RETURN 
		
		this.prepararentorno(lcNombreReport)
		
		
		
		*	type of exported file
		
		
		
		IF m.lcToFileType == "HTML simple"
			lcToFileType = "HTM_simple"
		ENDIF
		
		lnRet = RepExpFl( m.lcFrxFileName, "", ;
			@m.lcFilename, m.lcToFileType, .f., ;
			0, .f., m.llXlsFormat, m.llXlsFormat, m.llXlsFormat, m.llXlsFormat, .f., ;
			"", ThisForm.Caption, 5 )
		*	"Progress_Init,Progress_Update,Progress_Release"
		DO CASE
		CASE m.lnRet=0
			llModifyFile = .t.
		OTHERWISE
			=Info_mesg('Report can not be exported in file of type '+lcFormato+CHR(13)+"Error "+AS(m.lnRet),;
				'Export')
		ENDCASE
		IF m.llModifyFile AND FILE(m.lcFilename)
			*	Open the file
			IF INLIST( YesNo( "File "+LOWER(m.lcFilename)+" is created."+CHR(13)+CHR(13)+"Do you like to open it?", ThisForm.Caption, 0 ), 1, 6 )
				=ShellExe( m.lcFilename )
			ENDIF
		ENDIF
		WAIT CLEAR
		
	ENDPROC

	PROCEDURE xml
		LPARAMETERS REPORTNAME
		LOCAL LCDIRECTORY, LOLISTENER, LOSHELL
		LCDIRECTORY = SYS(16)
		LCDIRECTORY = ADDBS(JUSTPATH(SUBSTR(LCDIRECTORY, AT(' ', LCDIRECTORY, 2)+1)))
		LOLISTENER = .NULL.
		DO (_ReportOutput) WITH 4, LOLISTENER
		LOLISTENER.TARGETFILENAME = FORCEPATH('Resultado.xml', SYS(2023))
		LOLISTENER.XMLMODE = 0
		LOLISTENER.QUIETMODE = .T.
		WAIT WINDOW NOWAIT 'Outputting to XML...'
		ERASE (LOLISTENER.TARGETFILENAME)
		REPORT FORM (REPORTNAME) OBJECT LOLISTENER
		LOSHELL = NEWOBJECT('_shellexecute', HOME()+'ffc\_environ.vcx')
		LOSHELL.SHELLEXECUTE(LOLISTENER.TARGETFILENAME)
		WAIT CLEAR
		THISFORM.REFRESH()
	ENDPROC

	PROCEDURE Agrupar.Init
		PUBLIC LCAGRUPACION
		LCAGRUPACION = 'C'
	ENDPROC

	PROCEDURE Agrupar.InteractiveChange
		SELECT INFORMES
		DO CASE
		CASE THIS.VALUE=1
		LCAGRUPACION = 'C'
		SET FILTER TO
		CASE THIS.VALUE=2
		LCAGRUPACION = 'A'
		SET FILTER TO PARENT<>'0_'
		ENDCASE
		THISFORM.INIT()
	ENDPROC

	PROCEDURE Command1.Click
		THISFORM.RELEASE()
	ENDPROC

	PROCEDURE Command1.DragDrop
		LPARAMETERS OSOURCE, NXCOORD, NYCOORD
		THIS.SHOWWHATSTHIS
	ENDPROC

	PROCEDURE Command2.Click
		LCREPORT = "Reports\"+ALLTRIM(INFORMES.REPOFILE)+".FRX"
		MODIFY REPORT (LCREPORT) PROTECTED NOWAIT   
	ENDPROC

	PROCEDURE descrip.Init
		THIS.CAPTION = ''
	ENDPROC

	PROCEDURE Destino.Init
		THIS.VALUE = THIS.LIST(1, 2)
	ENDPROC

	PROCEDURE ejecutar.Click
		LOCAL PAGINICIO, PAGFINAL
		PUBLIC LCSELEREPO, LCDESTINO
		
		*LCSELEREPO = "REPORTS\"+ALLTRIM(INFORMES.REPOFILE)+".FRX"
		
		lcSeleRepo = ALLTRIM(informes.repofile) + ".FRX"
		
		IF  .NOT. FILE(LCSELEREPO)
			= MESSAGEBOX("El archivo de informe no se ha encontrado.", 48)
			RETURN
		ENDIF
		
		SET REPORTBEHAVIOR 90
		
		THISFORM.CAJA1.LOSTFOCUS()
		THISFORM.CAJA2.LOSTFOCUS()
		THISFORM.CAJA3.LOSTFOCUS()
		THISFORM.CAJA4.LOSTFOCUS()
		THISFORM.CAJA5.LOSTFOCUS()
		THISFORM.CAJA6.LOSTFOCUS()
		THISFORM.CAJA7.LOSTFOCUS()
		THISFORM.CAJA8.LOSTFOCUS()
		
		EMPRESA = OAPP.NOMBREEMPRESA
		
		SOLORESUMEN = THISFORM.RESUMEN.VALUE
		
		IF SOLORESUMEN
			RESUMEN = " SUMMARY"
		ELSE
			RESUMEN = ""
		ENDIF
		
		DO SetInforme WITH lcSeleRepo
		
		
			
		
		LCDESTINO = THISFORM.DESTINO.VALUE
		
		
		
		IF !EMPTY(informes.Script)
			EXECSCRIPT(informes.Script)
		ENDIF
			
		
		oApp.DoReport(LCSELEREPO,lcDestino,Resumen,,informes.Text)
		
		RETURN
		
		
		
		DO CASE
			CASE LCDESTINO='XLS'
				thisform.xls("XLS",LCSELEREPO,Resumen)
			CASE LCDESTINO='DOC'
				thisform.xls("DOC",LCSELEREPO)
			CASE LCDESTINO='PDF'
			thisform.xls("PDF",LCSELEREPO,Resumen)
		*		thisform.PDF(LCSELEREPO,RESUMEN)	
			CASE LCDESTINO='TIFF'
				SET STATUS BAR OFF
				THISFORM.TIFF(LCSELEREPO)
				SET STATUS BAR ON
				
			CASE LCDESTINO='XML'
				SET STATUS BAR OFF
				THISFORM.XML(LCSELEREPO)
				SET STATUS BAR ON
			CASE LCDESTINO='HTML'
				SET STATUS BAR OFF
		*		THISFORM.HTML(LCSELEREPO)
				thisform.xls("HTML",LCSELEREPO,Resumen)
				SET STATUS BAR ON
			CASE LCDESTINO='V'
				SET STATUS BAR OFF
			*	REPORT FORM (LCSELEREPO) PREVIEW &RESUMEN
				LOCAL loReport AS "PreviewHelper" OF "FoxyPreviewer.App" 
				loReport = CREATEOBJECT("PreviewHelper") 
				loReport.AddReport(LCSELEREPO, RESUMEN) && FRX File, Clauses 
				loReport.RunReport() 
				SET STATUS BAR ON
			CASE LCDESTINO='I'
				IF PRINTSTATUS()
					REPORT FORM (LCSELEREPO) TO PRINTER PROMPT NOCONSOLE &RESUMEN
				ELSE
					= MESSAGEBOX("La impresora no está preparada.", 48, "Futura Software")
				ENDIF
			CASE LCDESTINO='A'
				SET STATUS BAR OFF
				*REPORT FORM (LCSELEREPO) PREVIEW &RESUMEN
				thisform.xls("TXT",LCSELEREPO,Resumen)
				SET STATUS BAR ON
		ENDCASE
		
		*!*	IF _TALLY=0
		*!*		MESSAGEBOX('No se ha encontrado ningun resultado a imprimir', 64, "Futura Software")
		*!*	ENDIF
		RELEASE LCDESTINO
	ENDPROC

	PROCEDURE Label7.Click
		obj=CREATEOBJECT('OpcionesImpresion')
		obj.show()
		
	ENDPROC

	PROCEDURE OleTreeView.Click
		**
		** ReFox - este procedimiento es vacío **
		**
	ENDPROC

	PROCEDURE OleTreeView.NodeClick
		LPARAMETERS NODE
		SELECT INFORMES
		= SEEK(NODE.KEY, 'informes', 'key')
		IF INFORMES.DISPONIBLE
		THISFORM.DESCRIP.CAPTION = INFORMES.DESCRIP
		M.CDOSNAME = INFORMES.REPOFILE
		THISFORM.LIMPIAR()
		THISFORM.FILTRAR()
		IF  .NOT. EMPTY(INFORMES.REPOFILE)
		THISFORM.EJECUTAR.ENABLED = .T.
		ELSE
		THISFORM.EJECUTAR.ENABLED = .F.
		ENDIF
		ELSE
		THISFORM.EJECUTAR.ENABLED = .F.
		THISFORM.DESCRIP.CAPTION = 'No está autorizado a acceder a este informe. Consulte con el Administrador de Sistemas'
		ENDIF
	ENDPROC

	PROCEDURE Timer1.Timer
		this.Interval=0
		*WAIT windows "Verificando Licencia" NOWAIT NOCLEAR 
		IF THISform.RUNSQL("Select convert(char(10),dbo.LeerConstante(?oApp.Empresa,'SYS_FUTURA')) as Deposito", 'cConfig')>0
			IF RECCOUNT('cConfig')>0
				IF EMPTY(NVL(CCONFIG.Deposito, ''))
					o=CREATEOBJECT("FuturaCOM.LicenciamientoClient")
					Valido = o.Validar(oApp.Empresa,oApp.NombreEmpresa)
					IF !valido AND EMPTY(o.MensajeError)
						MESSAGEBOX("Su licencia ha expirado. Por favor contacte con su proveedor.",16,TASTRADE_LOC)
						*RETURN .f.
						thisform.Release()
					ELSE
						IF valido AND !EMPTY(o.MensajeError)
							MESSAGEBOX(o.MensajeError,64,TASTRADE_LOC)
						endif		
					ENDIF
					o=null
				ENDIF 
			ENDIF
		ENDIF
		*WAIT CLEAR 
		
	ENDPROC

ENDDEFINE
