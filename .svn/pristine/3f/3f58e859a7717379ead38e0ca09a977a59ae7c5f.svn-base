*       *********************************************************
*       *                                                         
*       * 04/02/2012           PRINCIPAL.MPR            12:01:08  
*       *                                                         
*       *********************************************************
*       *                                                         
*       * Author's Name                                           
*       *                                                         
*       * Copyright (C) 2012 Company Name                         
*       * Address                                                 
*       * City,     Zip                                           
*       *                                                         
*       * Description:                                            
*       * This PROGRAM was automatically generated BY GENMENU.    
*       *                                                         
*       *********************************************************


*       *********************************************************
*       *                                                         
*       *                      Menu Definition                    
*       *                                                         
*       *********************************************************
*

SET SYSMENU TO
SET SYSMENU AUTOMATIC

DEFINE PAD pad OF _MSYSMENU PROMPT "\<Archivo" COLOR SCHEME 3 ;
	KEY ALT+A, "ALT+A" ;
	MESSAGE "Crear, guardar, eliminar y restaurar registros, cerrar formularios, imprimir informes o salir del Sistema"
DEFINE PAD _MSM_EDIT OF _MSYSMENU PROMPT "\<Edición" COLOR SCHEME 3 ;
	KEY ALT+E, "ALT+E" ;
	MESSAGE "Modifica texto o la selección actual."
DEFINE PAD _administracion OF _MSYSMENU PROMPT "A\<dministración" COLOR SCHEME 3 ;
	KEY ALT+D, "ALT+D" ;
	MESSAGE "Registrarse, cambiar la contraseña y acceder a todos los formularios de mantenimiento"
DEFINE PAD _system OF _MSYSMENU PROMPT "Utilidades" COLOR SCHEME 3 ;
	KEY ALT+P, "ALT+P" ;
	MESSAGE "Ventanas Seguimiento, Depuración y Vista, suspender, reanudar y cancelar programas"
DEFINE PAD _3fb0preik OF _MSYSMENU PROMPT "Sistemas" COLOR SCHEME 3 ;
	KEY ALT+S, ""
DEFINE PAD _MSM_SYSTM OF _MSYSMENU PROMPT "Ay\<uda" COLOR SCHEME 3 ;
	KEY ALT+U, "ALT+U" ;
	MESSAGE "Muestra Ayuda sobre Tastrade"
ON PAD pad OF _MSYSMENU ACTIVATE POPUP archivo
ON PAD _MSM_EDIT OF _MSYSMENU ACTIVATE POPUP edición
ON PAD _administracion OF _MSYSMENU ACTIVATE POPUP _qx713dsus
ON PAD _system OF _MSYSMENU ACTIVATE POPUP utilidades
ON PAD _3fb0preik OF _MSYSMENU ACTIVATE POPUP sistemas
ON PAD _MSM_SYSTM OF _MSYSMENU ACTIVATE POPUP help

DEFINE POPUP archivo MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF archivo PROMPT "\<Nuevo" ;
	KEY F9, "F9" ;
	SKIP FOR .NOT. formisobject() .OR.  .NOT. toolbarenabled("cmdNew") ;
	MESSAGE "Crea un nuevo registro en el formulario activo."
DEFINE BAR 2 OF archivo PROMPT "\<Modificar" ;
	KEY CTRL+M, "CTRL+M" ;
	SKIP FOR .NOT. formisobject() .OR.  .NOT. toolbarenabled("cmdEdit") ;
	MESSAGE "Modifica los datos del formulario activo."
DEFINE BAR 3 OF archivo PROMPT "\<Cerrar" ;
	SKIP FOR .NOT. formisobject() .OR.  .NOT. toolbarenabled("cmdClose") ;
	MESSAGE "Cierra el formulario activo."
DEFINE BAR 4 OF archivo PROMPT "\-"
DEFINE BAR 5 OF archivo PROMPT "\<Guardar" ;
	KEY F12, "F12" ;
	SKIP FOR .NOT. formisobject() .OR.  .NOT. toolbarenabled("cmdSave") ;
	MESSAGE "Guarda el registro actual en el formulario activo."
DEFINE BAR 6 OF archivo PROMPT "\<Restaurar" ;
	KEY CTRL+E, "CTRL+E" ;
	SKIP FOR .NOT. formisobject() .OR.  .NOT. toolbarenabled("cmdRestore") ;
	MESSAGE "Restaura los valores originales del registro actual en el formulario activo."
DEFINE BAR 7 OF archivo PROMPT "\<Eliminar" ;
	KEY CTRL+D, "CTRL+D" ;
	SKIP FOR .NOT. formisobject() .OR. TYPE("oApp.oToolBar") <> "O" .OR.  .NOT. _SCREEN.activeform.lallowdelete ;
	MESSAGE "Elimina el registro actual del formulario activo."
DEFINE BAR 8 OF archivo PROMPT "\-"
DEFINE BAR 9 OF archivo PROMPT "\<Imprimir informes ..." ;
	KEY CTRL+P, "CTRL+P" ;
	MESSAGE "Ejecuta el informe y el formulario de selección."
DEFINE BAR 10 OF archivo PROMPT "\<Exportar Datos..." ;
	MESSAGE "Exporta datos del sistema."
DEFINE BAR 11 OF archivo PROMPT "C\<onfigurar impresión" ;
	MESSAGE "Cambia la distribución de página y la configuración de impresora."
DEFINE BAR 12 OF archivo PROMPT "\-"
DEFINE BAR 13 OF archivo PROMPT "Salir de Sistema" ;
	KEY ALT+F4, "ALT+F4" ;
	MESSAGE "Sale del Sistema "
ON SELECTION BAR 1 OF archivo OAPP.OTOOLBAR.CMDNEW.CLICK()
ON SELECTION BAR 2 OF archivo OAPP.OTOOLBAR.CMDEDIT.CLICK()
ON SELECTION BAR 3 OF archivo OAPP.OTOOLBAR.CMDCLOSE.CLICK()
ON SELECTION BAR 5 OF archivo OAPP.OTOOLBAR.CMDSAVE.CLICK()
ON SELECTION BAR 6 OF archivo OAPP.OTOOLBAR.CMDRESTORE.CLICK()
ON SELECTION BAR 7 OF archivo _SCREEN.ACTIVEFORM.DELETE()
ON SELECTION BAR 9 OF archivo 	oApp.DoForm("ARBOL")
ON SELECTION BAR 10 OF archivo OAPP.DOFORM("SYS_EXPORTAR")
ON SELECTION BAR 11 OF archivo ;
	DO _1Y2199LOH ;
	IN LOCFILE("FUTURA9\MENUS\PRINCIPAL" ,"MPX;MPR|FXP;PRG" ,"WHERE is PRINCIPAL?")
ON SELECTION BAR 13 OF archivo CLEAR EVENTS

DEFINE POPUP edición MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR _med_undo OF edición PROMPT "\<Deshacer" ;
	KEY CTRL+Z, "CTRL+Z" ;
	MESSAGE "Deshace el último cambio realizado al control actual del formulario activo"
DEFINE BAR _med_redo OF edición PROMPT "\<Rehacer" ;
	KEY CTRL+R, "CTRL+R" ;
	MESSAGE "Repite el último cambio realizado al control actual del formulario activo."
DEFINE BAR 3 OF edición PROMPT "\-"
DEFINE BAR _med_cut OF edición PROMPT "Cor\<tar" ;
	KEY CTRL+X, "CTRL+X" ;
	MESSAGE "Quita la selección y la coloca en el Portapapeles."
DEFINE BAR _MED_COPY OF edición PROMPT "\<Copiar" ;
	KEY CTRL+C, "CTRL+C" ;
	MESSAGE "Copia la selección al Portapapeles."
DEFINE BAR _MED_PASTE OF edición PROMPT "\<Pegar" ;
	KEY CTRL+V, "CTRL+V" ;
	MESSAGE "Pega el contenido del Portapapeles."
DEFINE BAR 7 OF edición PROMPT "\-"
DEFINE BAR 8 OF edición PROMPT "\<Buscar" ;
	KEY CTRL+B, "CTRL+B" ;
	SKIP FOR .NOT. formisobject() .OR.  .NOT. toolbarenabled("cmdBuscar") ;
	MESSAGE "Busca datos en el formulario activo."
DEFINE BAR _med_slcta OF edición PROMPT "Se\<leccionar todo" ;
	KEY CTRL+A, "CTRL+A" ;
	MESSAGE "Selecciona todo el texto del control actual del formulario activo."
DEFINE BAR 10 OF edición PROMPT "\-"
DEFINE BAR 11 OF edición PROMPT "Mostrar Barra de Sistemas"
DEFINE BAR 12 OF edición PROMPT "Copiar registros en Portapapeles"
ON SELECTION BAR 8 OF edición OAPP.OTOOLBAR.CMDBUSCAR.CLICK()
ON SELECTION BAR 11 OF edición notyet()
ON SELECTION BAR 12 OF edición ;
	DO _3fb0preiu ;
	IN LOCFILE("FUTURA9\MENUS\PRINCIPAL" ,"MPX;MPR|FXP;PRG" ,"WHERE is PRINCIPAL?")

DEFINE POPUP _qx713dsus MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF _qx713dsus PROMPT "\<Registro" ;
	SKIP FOR .NOT. EMPTY(WONTOP()) ;
	MESSAGE "Registrarse como otro usuario."
DEFINE BAR 2 OF _qx713dsus PROMPT "C\<ambiar contraseña" ;
	SKIP FOR .NOT. EMPTY(WONTOP()) .AND. verificar() ;
	MESSAGE "Cambia la contraseña para el usuario actual"
DEFINE BAR 3 OF _qx713dsus PROMPT "\<Usuarios" ;
	SKIP FOR verificar()  or .NOT. oapp.permisos(15)  ;
	MESSAGE "Agrega, modifica o elimina usuarios"
DEFINE BAR 4 OF _qx713dsus PROMPT "\-"
DEFINE BAR 5 OF _qx713dsus PROMPT "\<Sistema"
DEFINE BAR 6 OF _qx713dsus PROMPT "\-"
DEFINE BAR 100 OF _qx713dsus PROMPT "\<Ejercicios"
DEFINE BAR 8 OF _qx713dsus PROMPT "\-"
DEFINE BAR 9 OF _qx713dsus PROMPT "Panel Gerencial"
ON SELECTION BAR 1 OF _qx713dsus ;
	DO _1Y2199LOR ;
	IN LOCFILE("FUTURA9\MENUS\PRINCIPAL" ,"MPX;MPR|FXP;PRG" ,"WHERE is PRINCIPAL?")
ON SELECTION BAR 2 OF _qx713dsus DO FORM CHNGPSWD
ON SELECTION BAR 3 OF _qx713dsus OAPP.DOFORM("EMPLOYEE")
ON BAR 5 OF _qx713dsus ACTIVATE POPUP _09o0v4rap
ON SELECTION BAR 9 OF _qx713dsus oApp.DoForm('sys_panel')

DEFINE POPUP _09o0v4rap MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF _09o0v4rap PROMPT "Seguridad y Grupos de Usuarios" ;
	SKIP FOR .NOT. oapp.permisos(3) .OR. oapp.sistema = 'SYS'
DEFINE BAR 2 OF _09o0v4rap PROMPT "\-"
DEFINE BAR 3 OF _09o0v4rap PROMPT "Configuración"
DEFINE BAR 4 OF _09o0v4rap PROMPT "Empresa" ;
	SKIP FOR .NOT. oapp.permisos(16) 
DEFINE BAR 5 OF _09o0v4rap PROMPT "\-"
DEFINE BAR 6 OF _09o0v4rap PROMPT "SQL" ;
	SKIP FOR .NOT. oapp.permisos(3)
DEFINE BAR 7 OF _09o0v4rap PROMPT "Abrir DBF..."
DEFINE BAR 8 OF _09o0v4rap PROMPT "Panel BI"
ON SELECTION BAR 1 OF _09o0v4rap OAPP.DOFORM('SYS_GRUPOS')
ON SELECTION BAR 3 OF _09o0v4rap OAPP.DOFORM('BS_CONFIG')
ON SELECTION BAR 4 OF _09o0v4rap OAPP.DOFORM('EMPRESA')
ON SELECTION BAR 6 OF _09o0v4rap OAPP.DOFORM('SYS_SQL')
ON SELECTION BAR 7 OF _09o0v4rap ;
	DO _3fb0preiv ;
	IN LOCFILE("FUTURA9\MENUS\PRINCIPAL" ,"MPX;MPR|FXP;PRG" ,"WHERE is PRINCIPAL?")
ON SELECTION BAR 8 OF _09o0v4rap oApp.Doform('sys_panelBI')

DEFINE POPUP utilidades MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR _MTI_WATCH OF utilidades PROMPT "\<Seguimiento" ;
	MESSAGE "Muestra la ventana Seguimiento"
DEFINE BAR _mtl_debugger OF utilidades PROMPT "De\<puración" ;
	MESSAGE "Muestra la ventana Depuración."
DEFINE BAR _mwi_view OF utilidades PROMPT "\<Vista" ;
	MESSAGE "Muestra la ventana Vista"
DEFINE BAR _mwi_cmd OF utilidades PROMPT "\<Comandos" ;
	KEY CTRL+F2, "Ctrl+F2" ;
	MESSAGE "Muestra la ventana Comandos"
DEFINE BAR 5 OF utilidades PROMPT "\-"
DEFINE BAR _mpr_suspend OF utilidades PROMPT "S\<uspender" ;
	MESSAGE "Suspende el programa que está en ejecución"
DEFINE BAR _mpr_resum OF utilidades PROMPT "\<Reanudar" ;
	MESSAGE "Reanuda la ejecución del programa suspendido actualmente"
DEFINE BAR _mpr_cancl OF utilidades PROMPT "Ca\<ncelar" ;
	MESSAGE "Detiene la ejecución del programa actual"

DEFINE POPUP sistemas MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF sistemas PROMPT "Probando"

DEFINE POPUP help MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR _MST_HPSCH OF help PROMPT "\<Contenido" ;
	KEY F1, "F1"
DEFINE BAR _MST_HELP OF help PROMPT "Buscar ayuda Sobre..." ;
	MESSAGE "Busca temas de Ayuda por palabra clave"
DEFINE BAR _MST_TECHS OF help PROMPT "\<Soporte técnico" ;
	MESSAGE "Ofrece información sobre cómo obtener ayuda técnica adicional"
DEFINE BAR 4 OF help PROMPT "\-"
DEFINE BAR 5 OF help PROMPT "\<Acerca de..." ;
	MESSAGE "Muestra información sobre esta aplicación y la configuración del sistema"
ON SELECTION BAR 5 OF help ;
	DO _3fb0preiw ;
	IN LOCFILE("FUTURA9\MENUS\PRINCIPAL" ,"MPX;MPR|FXP;PRG" ,"WHERE is PRINCIPAL?")

ON SELECTION MENU _MSYSMENU *-- (C) MICROSOFT CORPORATION 1995
ON SELECTION POPUP archivo 

*       *********************************************************
*       *                                                         
*       *                 Cleanup Code & Procedures               
*       *                                                         
*       *********************************************************
*


IF _VFP.startmode = 4
     RELEASE PAD _system OF _MSYSMENU
ENDIF
IF sql("Select * from sys_sistemas where Area = 'FTR' or Area = 'SYS' order by sistema ",'cSistemas') > 0
     SELECT csistemas
     i = 1
     SCAN
          DEFINE BAR i OF sistemas PROMPT sistema
          ccomando = "'" + ALLTRIM(csistemas.idsistema) + "'"
          ON SELECTION BAR i OF SISTEMAS oApp.DoSys(&cComando)
          i = i + 1
     ENDSCAN
     USE IN csistemas
ENDIF

ON BAR 100 OF _qx713dsus ACTIVATE POPUP _Ejercicios

DEFINE POPUP _Ejercicios MARGIN RELATIVE SHADOW COLOR SCHEME 4
IF sql("Select * from Ejercicios where IdEmpresa=?oApp.Empresa ",'cSistemas') > 0
     SELECT csistemas
     i = 1
     SCAN
          DEFINE BAR i OF _Ejercicios PROMPT ALLTRIM(STR(Ejercicio)) MESSAGE "Cambia el ejercicio actual a " + ALLTRIM(STR(Ejercicio))
          ccomando = "'" + ALLTRIM(STR(Ejercicio)) + "'"
          ON SELECTION BAR i OF _Ejercicios oApp.DoEjercicio(&cComando)
          i = i + 1
     ENDSCAN
     USE IN csistemas
ENDIF


*       *********************************************************
*       *                                                         
*       * _1Y2199LOH  ON SELECTION BAR 11 OF POPUP archivo        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  PRINCIPAL.MPR,            Record:   15      
*       * Called By:  ON SELECTION BAR 11 OF POPUP archivo        
*       * Prompt:     Configurar impresión                        
*       * Snippet:    1                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _1Y2199LOH
LOCAL lcolderror
lcolderror = ON('ERROR')
ON ERROR *
= SYS(1037)
ON ERROR &lcOldError
*--


*       *********************************************************
*       *                                                         
*       * _3FB0PREIU  ON SELECTION BAR 12 OF POPUP edición        
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  PRINCIPAL.MPR,            Record:   32      
*       * Called By:  ON SELECTION BAR 12 OF POPUP edición        
*       * Prompt:     Copiar registros en Portapapeles            
*       * Snippet:    2                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _3fb0preiu
IF USED()
	_vfp.DataToClip(,,3)
	MESSAGEBOX("Se ha copiado los registros en el Portapapeles." + CHR(13) + "Seleccione la aplicacion destino y pegue en el mismo",64,"Futura Software")
else
	MESSAGEBOX("Seleccione la grilla o el formulario origen para copiar." ,64,"Futura Software")	
ENDIF
	


*       *********************************************************
*       *                                                         
*       * _1Y2199LOR  ON SELECTION BAR 1 OF POPUP _qx713dsus      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  PRINCIPAL.MPR,            Record:   35      
*       * Called By:  ON SELECTION BAR 1 OF POPUP _qx713dsus      
*       * Prompt:     Registro                                    
*       * Snippet:    3                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _1Y2199LOR
LOCAL lcuserlevel
= oapp.login()
oapp.domenu()
oapp.dosys(oapp.sistema)
*--


*       *********************************************************
*       *                                                         
*       * _3FB0PREIV  ON SELECTION BAR 7 OF POPUP _09o0v4rap      
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  PRINCIPAL.MPR,            Record:   47      
*       * Called By:  ON SELECTION BAR 7 OF POPUP _09o0v4rap      
*       * Prompt:     Abrir DBF...                                
*       * Snippet:    4                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _3fb0preiv
Use ? in 0 ALIAS _xTabla
IF USED('_xTabla')
	SELECT _xTabla
	BROWSE
	USE IN _xTabla
ENDIF
	


*       *********************************************************
*       *                                                         
*       * _3FB0PREIW  ON SELECTION BAR 5 OF POPUP help            
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  PRINCIPAL.MPR,            Record:   75      
*       * Called By:  ON SELECTION BAR 5 OF POPUP help            
*       * Prompt:     Acerca de...                                
*       * Snippet:    5                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _3fb0preiw
LOCAL loaboutbox, lcVersion
SET CLASSLIB TO about ADDITIVE
AGETFILEVERSION(LAVERSION, "futura.EXE")
IF TYPE('laVersion(4)')<>'U'
	lcVersion = LAVERSION(4)
ELSE
	lcVersion = "2.0"
ENDIF

loaboutbox = CREATEOBJECT("AboutBox", "Futura Software", lcVersion ,  ;
             "Copyright © 1999-2012 - Virginio González",  ;
             "Reservados todos los derechos" + CHR(13) +  ;
             "Asistencia Técnica : 0981-426145" + CHR(13) +  ;
             "E-Mail : vgonzalez@futura.com.py" + CHR(13) +  ;
             "www.futura.com.py", "BITMAPS\fondo800.jpg")
loaboutbox.show()
RELEASE CLASSLIB about.vcx
