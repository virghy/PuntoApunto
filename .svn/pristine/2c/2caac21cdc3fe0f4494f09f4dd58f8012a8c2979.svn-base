*--------------------------------------------------------------------------------------------------------------------------------------------------------
* (ES) AUTOGENERADO - ¡¡ATENCIÓN!! - ¡¡NO PENSADO PARA EJECUTAR!! USAR SOLAMENTE PARA INTEGRAR CAMBIOS Y ALMACENAR CON HERRAMIENTAS SCM!!
* (EN) AUTOGENERATED - ATTENTION!! - NOT INTENDED FOR EXECUTION!! USE ONLY FOR MERGING CHANGES AND STORING WITH SCM TOOLS!!
*--------------------------------------------------------------------------------------------------------------------------------------------------------
*< FOXBIN2PRG: Version="1.19" SourceFile="st_label.scx" /> (Solo para binarios VFP 9 / Only for VFP 9 binaries)
*
*
#INCLUDE "..\include\tastrade.h"

DEFINE CLASS dataenvironment AS dataenvironment 
 	*< CLASSDATA: Baseclass="dataenvironment" Timestamp="" Scale="" Uniqueid="" ClassIcon="2" />

	DataSource = .NULL.
	Height = 467
	Left = -28
	Name = "Dataenvironment"
	Top = 223
	Width = 792
	
	PROCEDURE BeforeOpenTables
		DO SETEO
	ENDPROC

ENDDEFINE

DEFINE CLASS form1 AS tsbaseform OF "..\libs\tsbase.vcx" 
 	*< CLASSDATA: Baseclass="form" Timestamp="" Scale="" Uniqueid="" />

	*-- OBJECTDATA items order determines ZOrder / El orden de los items OBJECTDATA determina el ZOrder 
	*< OBJECTDATA: ObjPath="Ts3dshape2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Ts3dshape1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdImprimir" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Command2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.IdProducto.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.IdProducto.IdProducto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Producto.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Producto.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Cantidad.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Cantidad.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Stock.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Stock.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Precio.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Precio.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Ref.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Ref.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Moneda.Header1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Grid1.Moneda.Text1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel9" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel2" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cboPuerto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cboFormato" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Detalle1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdEjecutar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cmdBorrar" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Marca" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel11" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cboLista" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtdProducto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txthProducto" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="txtNroMov" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Cantidad" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Deposito" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Familia" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Linea" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="cboComprobante" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel7" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel8" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel6" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel10" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel5" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel4" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel3" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel1" UniqueID="" Timestamp="" />
	*< OBJECTDATA: ObjPath="Tslabel12" UniqueID="" Timestamp="" />

	*<DefinedPropArrayMethod>
		*p: listaprecio
	*</DefinedPropArrayMethod>

	BorderStyle = 3
	Caption = "Impresión de Etiquetas"
	ctoolbar = 
	DoCreate = .T.
	editmode = .T.
	Height = 452
	listaprecio = 
	MaxButton = .F.
	MinButton = .T.
	Name = "form1"
	Width = 668
	lblRequerido.Name = "lblRequerido"

	ADD OBJECT 'Cantidad' AS tsspinner WITH ;
		Height = 22, ;
		KeyboardLowValue = 0, ;
		Left = 111, ;
		Name = "Cantidad", ;
		SpecialEffect = 1, ;
		SpinnerLowValue = 0.00, ;
		TabIndex = 4, ;
		Top = 70, ;
		Value = 10, ;
		Width = 78, ;
		ZOrderSet = 17
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="spinner" />

	ADD OBJECT 'cboComprobante' AS tscombobox WITH ;
		BoundColumn = 2, ;
		cmdsql = Select Descripcion, Cpbt_stk from st_cpbt_stk where IdEmpresa = ?oApp.Empresa, ;
		ControlSource = "this.tag", ;
		cursor = cComprobante, ;
		editable = .F., ;
		Height = 22, ;
		Left = 468, ;
		Name = "cboComprobante", ;
		origen = L, ;
		RowSource = "", ;
		RowSourceType = 3, ;
		Style = 0, ;
		TabIndex = 9, ;
		Top = 96, ;
		Width = 114, ;
		ZOrderSet = 21
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'cboFormato' AS tscombobox WITH ;
		BoundColumn = 2, ;
		ColumnCount = 2, ;
		ColumnLines = .F., ;
		ColumnWidths = "154,0", ;
		ControlSource = "this.tag", ;
		editable = .F., ;
		Height = 22, ;
		Left = 101, ;
		Name = "cboFormato", ;
		RowSource = "Codigo de Barras,YUTY-01,Etiquetas comunes,COMUN", ;
		RowSourceType = 1, ;
		StatusBarText = "Tipo de etiqueta a imprimir.", ;
		TabIndex = 12, ;
		Top = 413, ;
		Value = ("YUTY-01"), ;
		Width = 159, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'cboLista' AS tscombobox WITH ;
		BoundColumn = 2, ;
		cmdsql = SELECT Descripcion, IdLista FROM vt_ListaPrecio where IdEmpresa = ?oApp.Empresa, ;
		ColumnCount = 2, ;
		ColumnWidths = "198,0", ;
		ControlSource = "thisform.listaPrecio", ;
		cursor = cListaPrecio, ;
		editable = .F., ;
		Height = 22, ;
		Left = 111, ;
		Name = "cboLista", ;
		RowSourceType = 3, ;
		Style = 0, ;
		TabIndex = 5, ;
		Top = 94, ;
		Width = 203, ;
		ZOrderSet = 13
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'cboPuerto' AS tscombobox WITH ;
		BoundColumn = 1, ;
		ColumnCount = 1, ;
		ColumnLines = .F., ;
		ColumnWidths = "154", ;
		ControlSource = "this.tag", ;
		editable = .F., ;
		Height = 22, ;
		Left = 511, ;
		Name = "cboPuerto", ;
		RowSource = "LPT1,LPT2,LPT3", ;
		RowSourceType = 1, ;
		StatusBarText = "Tipo de etiqueta a imprimir.", ;
		TabIndex = 12, ;
		Top = 413, ;
		Value = ("LPT2"), ;
		Width = 56, ;
		ZOrderSet = 6
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'cmdBorrar' AS commandbutton WITH ;
		Caption = "", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 311, ;
		Name = "cmdBorrar", ;
		Picture = ..\bitmaps\undo.bmp, ;
		SpecialEffect = 2, ;
		StatusBarText = "Elimina todas las etiquetas agregas a la lista", ;
		TabIndex = 14, ;
		ToolTipText = "Deshacer la lista", ;
		Top = 413, ;
		Width = 41, ;
		ZOrderSet = 9
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdEjecutar' AS commandbutton WITH ;
		Caption = "", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 264, ;
		Name = "cmdEjecutar", ;
		Picture = ..\bitmaps\_save.bmp, ;
		SpecialEffect = 2, ;
		StatusBarText = "Ejecuta el nuevo filtro y agrega a la lista existente", ;
		TabIndex = 13, ;
		ToolTipText = "Ejecutar y agregar a la lista", ;
		Top = 413, ;
		Width = 41, ;
		ZOrderSet = 8
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'cmdImprimir' AS commandbutton WITH ;
		Caption = "", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 359, ;
		Name = "cmdImprimir", ;
		Picture = ..\bitmaps\wzprint.bmp, ;
		SpecialEffect = 2, ;
		StatusBarText = "Imprime las etiquetas según el formato seleccionado.", ;
		TabIndex = 15, ;
		ToolTipText = "Imprmir", ;
		Top = 413, ;
		Width = 41, ;
		ZOrderSet = 2
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Command2' AS commandbutton WITH ;
		Caption = "\<Salir", ;
		FontSize = 8, ;
		Height = 24, ;
		Left = 576, ;
		Name = "Command2", ;
		SpecialEffect = 2, ;
		TabIndex = 16, ;
		Top = 411, ;
		Width = 75, ;
		ZOrderSet = 3
		*< END OBJECT: BaseClass="commandbutton" />

	ADD OBJECT 'Deposito' AS tscombobox WITH ;
		BoundColumn = 2, ;
		cmdsql = SELECT Deposito, IdDeposito FROM st_Depositos WHERE IdEmpresa = ?oApp.Empresa ORDER BY 1, ;
		ColumnCount = 2, ;
		ColumnWidths = "198,0", ;
		ControlSource = "this.tag", ;
		cursor = cDeposito, ;
		editable = .T., ;
		FirstElement = 1, ;
		Height = 22, ;
		Left = 111, ;
		Name = "Deposito", ;
		NumberOfElements = 0, ;
		RowSource = "", ;
		RowSourceType = 3, ;
		Style = 0, ;
		TabIndex = 1, ;
		Top = 22, ;
		Width = 203, ;
		ZOrderSet = 18
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'Detalle1' AS detalle WITH ;
		AutoSize = .T., ;
		campo = Producto, ;
		enlace = grid1, ;
		Height = 75, ;
		Left = 624, ;
		Name = "Detalle1", ;
		TabIndex = 11, ;
		tabla = Etiquetas, ;
		Top = 216, ;
		valor = " ", ;
		Width = 42, ;
		ZOrderSet = 7, ;
		AddItem.Height = 32, ;
		AddItem.Left = 5, ;
		AddItem.Name = "AddItem", ;
		AddItem.SpecialEffect = 0, ;
		AddItem.Top = 5, ;
		AddItem.Width = 32, ;
		RemoveItem.Height = 32, ;
		RemoveItem.Left = 5, ;
		RemoveItem.Name = "RemoveItem", ;
		RemoveItem.SpecialEffect = 0, ;
		RemoveItem.Top = 38, ;
		RemoveItem.Width = 32
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="commandgroup" />

	ADD OBJECT 'Familia' AS tscombobox WITH ;
		BoundColumn = 2, ;
		cmdsql = Select descripcion,idfamilia from st_familia where idempresa = ?oApp.Empresa order by 1, ;
		ColumnCount = 2, ;
		ColumnWidths = "172,0", ;
		ControlSource = "this.tag", ;
		cursor = cFamilia, ;
		editable = .T., ;
		FirstElement = 1, ;
		Height = 22, ;
		Left = 468, ;
		Name = "Familia", ;
		NumberOfElements = 0, ;
		RowSource = "", ;
		RowSourceType = 3, ;
		Style = 0, ;
		TabIndex = 7, ;
		Top = 48, ;
		Width = 177, ;
		ZOrderSet = 19
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'Grid1' AS grid WITH ;
		AllowAddNew = .T., ;
		ColumnCount = 7, ;
		DeleteMark = .F., ;
		FontSize = 8, ;
		Height = 256, ;
		Left = 1, ;
		Name = "Grid1", ;
		Panel = 1, ;
		RowHeight = 17, ;
		ScrollBars = 2, ;
		TabIndex = 17, ;
		Top = 134, ;
		Width = 611, ;
		ZOrderSet = 4, ;
		Column1.ColumnOrder = 2, ;
		Column1.FontSize = 8, ;
		Column1.Name = "IdProducto", ;
		Column1.Width = 80, ;
		Column2.BackColor = 217,217,255, ;
		Column2.ColumnOrder = 3, ;
		Column2.FontSize = 8, ;
		Column2.Name = "Producto", ;
		Column2.Width = 202, ;
		Column3.ColumnOrder = 1, ;
		Column3.FontSize = 8, ;
		Column3.Format = "Z", ;
		Column3.Name = "Cantidad", ;
		Column3.Width = 62, ;
		Column4.BackColor = 217,217,255, ;
		Column4.FontSize = 8, ;
		Column4.Name = "Stock", ;
		Column4.Width = 62, ;
		Column5.BackColor = 217,217,255, ;
		Column5.FontSize = 8, ;
		Column5.Format = "Z", ;
		Column5.InputMask = "999,999,999.99", ;
		Column5.Name = "Precio", ;
		Column5.Width = 65, ;
		Column6.FontSize = 8, ;
		Column6.Name = "Ref", ;
		Column6.Width = 66, ;
		Column7.FontSize = 8, ;
		Column7.Name = "Moneda", ;
		Column7.ReadOnly = .T., ;
		Column7.Width = 43
		*< END OBJECT: BaseClass="grid" />

	ADD OBJECT 'Grid1.Cantidad.Header1' AS header WITH ;
		Caption = "Cantidad", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid1.Cantidad.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid1.IdProducto.Header1' AS header WITH ;
		Caption = "Producto", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid1.IdProducto.IdProducto' AS campo_clave WITH ;
		condicionextra = a.IdEmpresa = ?oApp.Empresa, ;
		datoayuda = Productos, ;
		indice = a.IdProducto, ;
		indice1 = Catalogo, ;
		Left = 25, ;
		Name = "IdProducto", ;
		objeto = this.parent.parent.producto.text1, ;
		objeto2 = this.parent.parent.precio.text1, ;
		objeto3 = this.parent.parent.Moneda.text1, ;
		origen = R, ;
		retorna = Descripcion, ;
		retorna2 = b.precio, ;
		retorna3 = b.Moneda, ;
		tabla = st_Producto a left join vt_precios b on a.idProducto= b.IdProducto and a.IdEmpresa = b.IdEmpresa and b.IdLista=?thisform.ListaPrecio, ;
		Top = 23
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'Grid1.Moneda.Header1' AS header WITH ;
		Caption = "Moneda", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid1.Moneda.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1", ;
		ReadOnly = .T.
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid1.Precio.Header1' AS header WITH ;
		Caption = "Precio", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid1.Precio.Text1' AS textbox WITH ;
		BackColor = 217,217,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid1.Producto.Header1' AS header WITH ;
		Caption = "Descripción", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid1.Producto.Text1' AS textbox WITH ;
		BackColor = 217,217,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid1.Ref.Header1' AS header WITH ;
		Caption = "Referencia", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid1.Ref.Text1' AS textbox WITH ;
		BackColor = 255,255,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Grid1.Stock.Header1' AS header WITH ;
		Caption = "Stock Act.", ;
		FontSize = 8, ;
		Name = "Header1"
		*< END OBJECT: BaseClass="header" />

	ADD OBJECT 'Grid1.Stock.Text1' AS textbox WITH ;
		BackColor = 217,217,255, ;
		BorderStyle = 0, ;
		FontSize = 8, ;
		ForeColor = 0,0,0, ;
		Margin = 0, ;
		Name = "Text1"
		*< END OBJECT: BaseClass="textbox" />

	ADD OBJECT 'Linea' AS tscombobox WITH ;
		BoundColumn = 2, ;
		cmdsql = Select descripcion,idlinea from st_linea where idempresa = ?oApp.Empresa order by 1, ;
		ColumnCount = 2, ;
		ColumnWidths = "172,0", ;
		ControlSource = "this.tag", ;
		cursor = cLinea, ;
		editable = .T., ;
		FirstElement = 1, ;
		Height = 22, ;
		Left = 468, ;
		Name = "Linea", ;
		NumberOfElements = 0, ;
		RowSource = "", ;
		RowSourceType = 3, ;
		Style = 0, ;
		TabIndex = 8, ;
		Top = 72, ;
		Width = 177, ;
		ZOrderSet = 20
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'Marca' AS tscombobox WITH ;
		BoundColumn = 2, ;
		cmdsql = SELECT Descripcion, IdMarca FROM st_Marca WHERE IdEmpresa = ?oApp.Empresa ORDER BY 1, ;
		ColumnCount = 2, ;
		ColumnWidths = "172,0", ;
		ControlSource = "this.tag", ;
		cursor = cMarca, ;
		editable = .T., ;
		FirstElement = 1, ;
		Height = 22, ;
		Left = 468, ;
		Name = "Marca", ;
		NumberOfElements = 0, ;
		RowSource = "", ;
		RowSourceType = 3, ;
		Style = 0, ;
		TabIndex = 6, ;
		Top = 24, ;
		Width = 177, ;
		ZOrderSet = 11
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="combobox" />

	ADD OBJECT 'Ts3dshape1' AS ts3dshape WITH ;
		BackColor = 128,128,128, ;
		BackStyle = 0, ;
		Height = 115, ;
		Left = 1, ;
		Name = "Ts3dshape1", ;
		Top = 9, ;
		Width = 659, ;
		ZOrderSet = 1
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="shape" />

	ADD OBJECT 'Ts3dshape2' AS ts3dshape WITH ;
		BackColor = 128,128,128, ;
		BackStyle = 0, ;
		Height = 47, ;
		Left = 1, ;
		Name = "Ts3dshape2", ;
		Top = 401, ;
		Width = 659, ;
		ZOrderSet = 0
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="shape" />

	ADD OBJECT 'Tslabel1' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Lista de Precios", ;
		FontBold = .F., ;
		Height = 16, ;
		Left = 31, ;
		Name = "Tslabel1", ;
		TabIndex = 28, ;
		Top = 99, ;
		Width = 79, ;
		ZOrderSet = 29
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel10' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Deposito", ;
		FontBold = .F., ;
		Height = 16, ;
		Left = 66, ;
		Name = "Tslabel10", ;
		TabIndex = 20, ;
		Top = 25, ;
		Width = 44, ;
		ZOrderSet = 25
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel11' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Marca", ;
		FontBold = .F., ;
		Height = 16, ;
		Left = 434, ;
		Name = "Tslabel11", ;
		TabIndex = 22, ;
		Top = 27, ;
		Width = 32, ;
		ZOrderSet = 12
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel12' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		BackColor = 212,208,200, ;
		BackStyle = 1, ;
		Caption = "Parámetros ", ;
		FontBold = .T., ;
		Height = 16, ;
		Left = 22, ;
		Name = "Tslabel12", ;
		TabIndex = 25, ;
		Top = 3, ;
		Width = 70, ;
		ZOrderSet = 30
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel2' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Formato Etiqueta", ;
		FontBold = .F., ;
		Height = 16, ;
		Left = 16, ;
		Name = "Tslabel2", ;
		TabIndex = 29, ;
		Top = 416, ;
		Width = 82, ;
		ZOrderSet = 5
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel3' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Producto desde", ;
		FontBold = .F., ;
		Height = 16, ;
		Left = 32, ;
		Name = "Tslabel3", ;
		TabIndex = 18, ;
		Top = 49, ;
		Width = 78, ;
		ZOrderSet = 28
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel4' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Hasta:", ;
		FontBold = .F., ;
		Height = 16, ;
		Left = 200, ;
		Name = "Tslabel4", ;
		TabIndex = 19, ;
		Top = 49, ;
		Width = 33, ;
		ZOrderSet = 27
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel5' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Familia", ;
		FontBold = .F., ;
		Height = 16, ;
		Left = 432, ;
		Name = "Tslabel5", ;
		TabIndex = 21, ;
		Top = 51, ;
		Width = 34, ;
		ZOrderSet = 26
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel6' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Linea", ;
		FontBold = .F., ;
		Height = 16, ;
		Left = 438, ;
		Name = "Tslabel6", ;
		TabIndex = 23, ;
		Top = 76, ;
		Width = 28, ;
		ZOrderSet = 24
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel7' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Máx. de etiquetas", ;
		FontBold = .F., ;
		Height = 16, ;
		Left = 23, ;
		Name = "Tslabel7", ;
		TabIndex = 27, ;
		Top = 74, ;
		Width = 87, ;
		ZOrderSet = 22
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel8' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Movimiento", ;
		FontBold = .F., ;
		Height = 16, ;
		Left = 411, ;
		Name = "Tslabel8", ;
		TabIndex = 24, ;
		Top = 99, ;
		Width = 55, ;
		ZOrderSet = 23
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'Tslabel9' AS tslabel WITH ;
		Alignment = 0, ;
		AutoSize = .T., ;
		Caption = "Puerto Impresion", ;
		FontBold = .F., ;
		Height = 16, ;
		Left = 424, ;
		Name = "Tslabel9", ;
		TabIndex = 29, ;
		Top = 417, ;
		Width = 82, ;
		ZOrderSet = 5
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="label" />

	ADD OBJECT 'txtdProducto' AS tstextbox WITH ;
		datoayuda = Productos, ;
		Height = 22, ;
		Left = 111, ;
		Name = "txtdProducto", ;
		TabIndex = 2, ;
		Top = 46, ;
		Width = 78, ;
		ZOrderSet = 14
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'txthProducto' AS tstextbox WITH ;
		datoayuda = Productos, ;
		Height = 22, ;
		Left = 236, ;
		Name = "txthProducto", ;
		TabIndex = 3, ;
		Top = 46, ;
		Width = 78, ;
		ZOrderSet = 15
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />

	ADD OBJECT 'txtNroMov' AS tstextbox WITH ;
		Height = 22, ;
		Left = 584, ;
		Name = "txtNroMov", ;
		TabIndex = 10, ;
		ToolTipText = "Nro. Comprobante", ;
		Top = 96, ;
		Width = 61, ;
		ZOrderSet = 16
		*< END OBJECT: ClassLib="..\libs\tsbase.vcx" BaseClass="textbox" />
	
	PROCEDURE Init
		DODEFAULT()
		CREATE CURSOR Etiquetas (IDPRODUCTO C (20), PRODUCTO C (50), CANTIDAD I DEFAULT 10, STOCK N (10, 2) NULL, PRECIO Y NULL,Referencia c(10) null,Moneda C(3))
		SELECT Etiquetas 
		=CURSORSETPROP("Buffering",5)
		THISFORM.GRID1.RECORDSOURCETYPE = 1
		THISFORM.GRID1.RECORDSOURCE = "Etiquetas"
		THISFORM.TABLA1 = "Etiquetas"
		THISFORM.GRID1.IDPRODUCTO.CONTROLSOURCE = "Etiquetas.IdProducto"
		THISFORM.GRID1.PRODUCTO.CONTROLSOURCE = "Etiquetas.Producto"
		THISFORM.GRID1.CANTIDAD.CONTROLSOURCE = "Etiquetas.Cantidad"
		THISFORM.GRID1.STOCK.CONTROLSOURCE = "Etiquetas.Stock"
		THISFORM.GRID1.PRECIO.CONTROLSOURCE = "Etiquetas.Precio"
		THISFORM.GRID1.ref.CONTROLSOURCE = "Etiquetas.Referencia"
		THISFORM.GRID1.STOCK.ENABLED = .F.
		THISFORM.GRID1.PRECIO.ENABLED = .F.
		THISFORM.GRID1.PRODUCTO.ENABLED = .F.
		THISFORM.GRID1.ref.ENABLED = .F.
		SELECT ETIQUETAS
		THISFORM.CBOFORMATO.LISTITEMID = 1
		THISFORM.cbopuerto.LISTITEMID = 1
		
		lcPuerto = leerIni("PUERTOETIQUETA","OPCIONES")
		IF !EMPTY(lcPuerto)
			THISFORM.cbopuerto.Value=lcPuerto
		ENDIF
			
		
	ENDPROC

	PROCEDURE cboPuerto.InteractiveChange
		
		EscribirIni(this.Value,"PUERTOETIQUETA","OPCIONES")
		
	ENDPROC

	PROCEDURE cmdBorrar.Click
		DELETE IN ETIQUETAS ALL
		THISFORM.GRID1.REFRESH
	ENDPROC

	PROCEDURE cmdEjecutar.Click
		Local CMDSQL
		m.DEPOSITO = Thisform.DEPOSITO.Value
		m.IDPROI = Thisform.TXTDPRODUCTO.Value
		m.IDPROF = Thisform.TXTHPRODUCTO.Value
		m.MARCA = Thisform.MARCA.Value
		m.LINEA = Thisform.LINEA.Value
		m.FAMILIA = Thisform.FAMILIA.Value
		m.IDLISTA = Thisform.CBOLISTA.Value
		m.CPBT = Thisform.CBOCOMPROBANTE.Value
		m.NUMERO = Thisform.TXTNROMOV.Value
		m.IDEMPRESA = OAPP.EMPRESA
		NCAN = Thisform.CANTIDAD.Value
		m.hfecha=DATE()
		CFILTRO = " prod.IdProducto between "
		If Empty(Thisform.TXTDPRODUCTO.Value)
			CFILTRO = CFILTRO+" '' "
		Else
			CFILTRO = CFILTRO+" '"+Alltrim(Thisform.TXTDPRODUCTO.Value)+"' "
		Endif
		If Empty(Thisform.TXTHPRODUCTO.Value)
			CFILTRO = CFILTRO+"and 'ZZZZZZZZZ' "
		Else
			CFILTRO = CFILTRO+" and '"+Alltrim(Thisform.TXTHPRODUCTO.Value)+"' "
		Endif
		If  .Not. Empty(Thisform.FAMILIA.Value)
			CFILTRO = CFILTRO+" AND Familia = '"+Alltrim(Thisform.FAMILIA.Value)+"' "
		Endif
		If  .Not. Empty(Thisform.LINEA.Value)
			CFILTRO = CFILTRO+" AND Linea = '"+Alltrim(Thisform.LINEA.Value)+"' "
		Endif
		CFILTRO = CFILTRO+" AND prod.IdEmpresa = ?oApp.Empresa "
		If  .Not. Empty(Thisform.TXTNROMOV.Value) .And.  .Not. Empty(Thisform.CBOCOMPROBANTE.Value)
			TEXT TO CMDSQL NOSHOW
						SELECT     prod.Descripcion AS Producto, m.IdProducto, pre.Precio, SUM(m.Cantidad) AS Stock,catalogo=ISNULL(catalogo,''), pre.IdMoneda
					FROM         dbo.st_movimiento_Det m INNER JOIN
					                      dbo.st_Producto prod ON m.IdEmpresa = prod.IdEmpresa AND m.IdProducto = prod.IdProducto LEFT OUTER JOIN
					                      dbo.vt_Precios pre ON prod.IdEmpresa = pre.IdEmpresa AND prod.IdProducto = pre.IdProducto
					where m.IdEmpresa = ?oApp.Empresa  and m.IdComprobante = ?m.Cpbt and m.número = ?m.Numero
					GROUP BY prod.Descripcion, m.IdProducto, pre.Precio,Catalogo,IdMoneda
			ENDTEXT
		Else
			TEXT TO CMDSQL TEXTMERGE NOSHOW
				SELECT     prod.Descripcion AS Producto, pre.Precio, s.Cantidad as Stock, prod.IdProducto,catalogo=ISNULL(catalogo,''),Pre.IdMoneda
				FROM         dbo.st_Producto prod 
								inner join dbo.st_SaldoStock(?oApp.Empresa,null,?m.deposito,?m.hfecha) s
						      ON prod.IdEmpresa = s.IdEmpresa AND prod.IdProducto = s.IdProducto LEFT OUTER JOIN
				                      dbo.vt_Precios pre ON prod.IdEmpresa = pre.IdEmpresa AND prod.IdProducto = pre.IdProducto
				where <<cFiltro>>
				GROUP BY prod.Descripcion, pre.Precio, s.Cantidad, prod.IdProducto,Catalogo,IdMoneda
		
			ENDTEXT
		Endif
		If Thisform.RUNSQL(CMDSQL, 'Stock')>0
			If Eof('Stock')
				Messagebox("No existe ningun producto con su precio asignado.", 48, "Futura")
				Return .F.
			Endif
		Endif
		Select STOCK
		Scan
			If  .Not. PRECIO>0 .Or. Isnull(PRECIO)
				MSG = Messagebox("El producto ("+Alltrim(STOCK.IDPRODUCTO)+") "+Alltrim(STOCK.PRODUCTO)+Chr(13)+"No tiene precio asignado"+Chr(13)+"Desea Agregar de todos modos?", 067, "Futura Software")
				Do Case
				Case MSG=2
					Return
				Case MSG=6
					Insert Into etiquetas (CANTIDAD, IDPRODUCTO, PRODUCTO, STOCK, PRECIO,Referencia,Moneda) Values (Iif(STOCK.STOCK>NCAN .Or. STOCK.STOCK=-1, NCAN, STOCK.STOCK), STOCK.IDPRODUCTO, STOCK.PRODUCTO, Iif(STOCK.STOCK=-1, .Null., STOCK.STOCK), STOCK.PRECIO,stock.catalogo,Stock.IdMoneda)
				Endcase
			Else
				Insert Into etiquetas (CANTIDAD, IDPRODUCTO, PRODUCTO, STOCK, PRECIO,Referencia,Moneda) Values (Iif(STOCK.STOCK>NCAN .Or. STOCK.STOCK=-1, NCAN, STOCK.STOCK), STOCK.IDPRODUCTO, STOCK.PRODUCTO, Iif(STOCK.STOCK=-1, .Null., STOCK.STOCK), STOCK.PRECIO,stock.catalogo,Stock.IdMoneda)
			Endif
		Endscan
		Thisform.GRID1.Refresh()
	ENDPROC

	PROCEDURE cmdImprimir.Click
		Create Cursor Labels (IDPRODUCTO C (20), PRODUCTO C (50), PRECIO Y Null)
		Select ETIQUETAS
		Scan
			For I = 1 To CANTIDAD
				Insert Into Labels (IDPRODUCTO, PRODUCTO, PRECIO) Values (ETIQUETAS.IDPRODUCTO, ETIQUETAS.PRODUCTO, ETIQUETAS.PRECIO)
			Endfor
		Endscan
		Select Labels
		DO CASE 
		CASE ThisForm.cboFormato.Value="COMUN"
		
		*!*		Set REPORTBEHAVIOR 80
		*!*		Set Safety Off
		*!*		Report Form vt_precios.lbx Ascii To File C:\sistemas\ETIQUETAS.txt
		*!*		Run "copy c:\sistemas\etiquetas.txt lpt1"
			DO ('Etiqueta'+oApp.Empresa)
		
		CASE ThisForm.cboFormato.Value="YUTY-01"
		
			Set Safety Off
			Select IIF(Moneda='U$S',Alltrim(Transform(PRECIO, "USD 99,999.99")),Alltrim(Transform(PRECIO, "Gs 99,999,999"))) As PRECIO, Left(PRODUCTO, 15) As D1, ALLTRIM(Substr(PRODUCTO, 16, 15)) +' '+ ALLTRIM(Referencia) As D2 , IDPRODUCTO, "P"+Alltrim(Str(Round(CANTIDAD/2, 0))) As CANTIDAD From ETIQUETAS WITH (BUFFERING=.T.) order BY IdProducto Into Cursor  ss 
			Select ss
			A = Fcreate("C:\sistemas\ETIQUETA.TXT")
			Fputs(A, 'FR"YUTY-01"')
			SCAN
				*VG 10/11/2010
				*rellenamos con espacios, pq no borra el la memoria la impresora de ticket
				desc1=Alltrim(NVL(D1,'')) +SPACE(15)
				desc1=LEFT(desc1,15)
		
				desc2=Alltrim(NVL(D2,'')) +SPACE(15)
				desc2=LEFT(desc2,15)
					
				
				Fputs(A, "?")
				Fputs(A, Alltrim(NVL(PRECIO,'')))
				Fputs(A, Alltrim(NVL(desc1,'')))
				Fputs(A, Alltrim(NVL(desc2,'')))
				Fputs(A, Alltrim(NVL(IDPRODUCTO,'')))
				Fputs(A, Alltrim(NVL(CANTIDAD,'')))
			Endscan
			Fclose(A)
			lcmd = "COPY C:\sistemas\ETIQUETA.TXT " + thisform.cbopuerto.Value + " /B"
		
		*	Run "COPY c:\ETIQUETA.TXT LPT1 /B"
			Run &LCMD
		
		ENDCASE
		
	ENDPROC

	PROCEDURE Command2.Click
		THISFORM.RELEASE
	ENDPROC

	PROCEDURE Grid1.BeforeRowColChange
		LPARAMETERS NCOLINDEX
		IF NCOLINDEX<>THIS.ACTIVECOLUMN
		IF EMPTY(ETIQUETAS.IDPRODUCTO)
		NODEFAULT
		ENDIF
		ENDIF
	ENDPROC

ENDDEFINE
