*       *********************************************************
*       *                                                         
*       * 18/04/11              BASE.MPR                17:02:54  
*       *                                                         
*       *********************************************************
*       *                                                         
*       * Author's Name                                           
*       *                                                         
*       * Copyright (C) 2011 Company Name                         
*       * Address                                                 
*       * City,     Zip                                           
*       *                                                         
*       * Description:                                            
*       * This PROGRAM was automatically generated BY GENMENU.    
*       *                                                         
*       *********************************************************


*       *********************************************************
*       *                                                         
*       *                      Menu Definition                    
*       *                                                         
*       *********************************************************
*


DEFINE PAD _movimientos OF _MSYSMENU PROMPT "\<Movimientos" COLOR SCHEME 3 ;
	AFTER _MEDIT ;
	KEY ALT+M, ""
DEFINE PAD _definiciones OF _MSYSMENU PROMPT "\<Definiciones" COLOR SCHEME 3 ;
	AFTER _movimientos ;
	KEY ALT+D, "ALT+D"
ON PAD _movimientos OF _MSYSMENU ACTIVATE POPUP movimiento
ON PAD _definiciones OF _MSYSMENU ACTIVATE POPUP definicion

DEFINE POPUP movimiento MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF movimiento PROMPT "Cotizacion" ;
	SKIP FOR !oApp.Permisos(7)
DEFINE BAR 2 OF movimiento PROMPT "\-"
DEFINE BAR 3 OF movimiento PROMPT "Guia Telefonica"
DEFINE BAR 4 OF movimiento PROMPT "Mensajes"
DEFINE BAR 5 OF movimiento PROMPT "\-"
DEFINE BAR 6 OF movimiento PROMPT "Importar Archivos"
ON SELECTION BAR 1 OF movimiento OAPP.DOFORM('BS_COTIZACION')
ON SELECTION BAR 3 OF movimiento oApp.DoForm('bs_guia')
ON SELECTION BAR 4 OF movimiento oApp.DoForm('bs_mensajes')
ON SELECTION BAR 6 OF movimiento oApp.Doform('vt_importararchivos')

DEFINE POPUP definicion MARGIN RELATIVE SHADOW COLOR SCHEME 4
DEFINE BAR 1 OF definicion PROMPT "\<Sucursales" ;
	SKIP FOR !oApp.Permisos(35)
DEFINE BAR 2 OF definicion PROMPT "\<Personas" ;
	SKIP FOR !oApp.Permisos(65)
DEFINE BAR 3 OF definicion PROMPT "\<Tipo de Documento" ;
	SKIP FOR !oApp.Permisos(461)
DEFINE BAR 4 OF definicion PROMPT "\-"
DEFINE BAR 5 OF definicion PROMPT "Barrios"
DEFINE BAR 6 OF definicion PROMPT "\<Ciudades"
DEFINE BAR 7 OF definicion PROMPT "Departamentos"
DEFINE BAR 8 OF definicion PROMPT "Paises"
DEFINE BAR 9 OF definicion PROMPT "\-"
DEFINE BAR 10 OF definicion PROMPT "Tipo de Impuestos" ;
	SKIP FOR !oApp.Permisos(462)
DEFINE BAR 11 OF definicion PROMPT "\-"
DEFINE BAR 12 OF definicion PROMPT "Configuraciones Internas"
DEFINE BAR 13 OF definicion PROMPT "Formato Impresion" ;
	SKIP FOR !oApp.Permisos(463)
ON SELECTION BAR 1 OF definicion OAPP.DOFORM('BS_SUCURSALES')
ON SELECTION BAR 2 OF definicion OAPP.DOFORM('BS_PERSONAS')
ON SELECTION BAR 3 OF definicion OAPP.DOFORM('BS_TIPODOC')
ON SELECTION BAR 5 OF definicion oApp.DoForm('bs_barrios')
ON SELECTION BAR 6 OF definicion oApp.DoForm('bs_ciudades')
ON SELECTION BAR 7 OF definicion oApp.DoForm('bs_dpto')
ON SELECTION BAR 8 OF definicion oApp.Doform('bs_paises')
ON SELECTION BAR 10 OF definicion OAPP.DOFORM('BS_IVA')
ON SELECTION BAR 12 OF definicion ;
	DO _37510jglv ;
	IN LOCFILE("FUTURA9\MENUS\BASE" ,"MPX;MPR|FXP;PRG" ,"WHERE is BASE?")
ON SELECTION BAR 13 OF definicion oApp.DoForm('sys_impresion')

ON SELECTION MENU _MSYSMENU *-- (C) MICROSOFT CORPORATION 1995

*       *********************************************************
*       *                                                         
*       * _37510JGLV  ON SELECTION BAR 12 OF POPUP definicion     
*       *                                                         
*       * Procedure Origin:                                       
*       *                                                         
*       * From Menu:  BASE.MPR,            Record:   27           
*       * Called By:  ON SELECTION BAR 12 OF POPUP definicion     
*       * Prompt:     Configuraciones Internas                    
*       * Snippet:    1                                           
*       *                                                         
*       *********************************************************
*
PROCEDURE _37510jglv
DO seteo
WAIT WINDOW NOCLEAR NOWAIT "Actualizando Objetos..."
USE sysobjetos
SCAN
 TEXT TO cmdsql NOSHOW
	
	IF (select COUNT(*) from sys_objetos where IdObjeto= ?sysobjetos.IdObjeto)=0
		INSERT sys_objetos(IdObjeto,IdSistema,Descripcion,Tipo)
				values (?sysobjetos.IdObjeto,?sysobjetos.IdSistema,?sysobjetos.Descripcion,?sysobjetos.Tipo)
	
 ENDTEXT
 = sql(cmdsql,'c')
ENDSCAN
USE IN sysobjetos
WAIT WINDOW NOCLEAR NOWAIT "Actualizando Constantes..."
USE sys_constantes
SCAN
 TEXT TO cmdsql NOSHOW
	
	IF (select COUNT(*) from sys_constantes where Constante= ?sys_Constantes.Constante)=0
		INSERT sys_Constantes(Constante,Descripcion,Tipo,ValorDefault)
				values (?Constante,?Descripcion,?Tipo,?ValorDefault)
	
 ENDTEXT
 = sql(cmdsql,'c')
ENDSCAN
USE IN sys_constantes
WAIT WINDOW NOCLEAR NOWAIT "Actualizando Stock..."
= sql('exec st_ActualizarStk','cStock')

WAIT WINDOW NOCLEAR NOWAIT "Compilando Reportes..."
COMPILE reports/*.prg

WAIT WINDOW NOWAIT "Actualizacion finalizada..."
